external function string 255 GetChangePaswordLink();
remote function UUID GetServerUUIDRemote();
external function string 255 RemainingEinvoicesQuantity;
external function Boolean DisplayAdditionalFields();
remote function Integer MailAcceptanceStatus(LongInt);
external function Boolean IsMoveToCloud(record SetupStatusBlock);
external function Boolean IsMoveToCloudB();
external outer function Boolean IsCloudControllerClient();
external function string 255 GetCurrentStoreName();
external function Boolean CompaniesInClientMode();
external function Boolean ProductInDemoMode();
remote function string 255 GetCompanyShortCode(string);
external function Boolean AnyModuleAvailable();
external function Boolean AcceptanceStatusColumnTest(string);
external function Integer FlipCharCode(Integer,Integer);
external procedure RateField(real,real,real,string,integer,string,boolean,real,real,string,boolean);
external function boolean AddBicToMasterWindow(integer,var real,var real,real,real,real,real);
external function Boolean IsIntEnabActive(var string,var string,var Boolean,var string);
external function Boolean TouchScreenLookVertical();
external procedure SysEClass_Tool(Integer,var real,var real);
external procedure GTransEClass_Tool(Integer,var real,var real);
external procedure GTrans2EClass_Tool(Integer,var real,var real,var real);
external procedure GBaseEClass_Tool(Integer,var real,var real);
external procedure TransGenVClass_Tool(Integer,var real,var real);
external procedure GetCurUser(var record UserVc);
//external procedure JobRClass_ENG();
external function string 60 UserDefined(string,string);
external function string 60 RestPMCashModePayMode();
external outer function string 255 MasterBannerURL();
external procedure ItemStatusUserSettings(string,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean,var Boolean);
external function Boolean AllowedInCountry(integer);
external function Integer ResourceWindowResourceType();
external function Boolean ResPlan_Rental();
external function Boolean ResPlan_ProdOperations();
remote function Boolean ReadPOSButtons(string,string,longint,var string,var string,var string,var record POSButtonsVc);
//remote function Boolean ReadNPTSWindowData(string,string,longint,string,string,Date,Time,var Boolean,var string,var string,var string,var record POSButtonsVc,var Integer);
external function Boolean TouchScreenLook();
external procedure ExtractObj(string,var Integer,var string);
external function Boolean IsSessionOpen(string,string,Date,Time);
external procedure CntNPTSPaymentCurrencies(var Array string,var Array string,var Array Integer,var Array string,var Integer);
remote procedure CntPOSCurrencies(var Array string,var Array Boolean,var Integer);
external function Boolean CheckOffLineRecords(Boolean);
external function string 60 TileUserDefined(string,Integer,var Integer);
external function Boolean CUVATNrColumn;
external function Integer GetInternetEnablerCountry();
external function Integer CntVarietyCode(Integer,var Array string);
external function Integer VarietyMatMax(Integer);
external function Boolean UseTaxTemplatesforTaxCalc();
remote procedure TablesViewWClassDo(record LocalMachineBlock,string,Array string,Array string,Array string,Array string,Array Integer,var Integer,var LongInt);
external function string 20 GetMenuCode(string);
external procedure DrawModifierButtons(var Integer);
remote procedure ForkLiftQueueArray(string,string,var Array string,var Array string,var Array string,var Array string,var Array val,var Array Integer,var Array string,var Integer,Boolean,LongInt,LongInt,string);

external function Boolean DisplayLoginButtons();
external function Integer LoginShortcutsLines(Integer);
external function Integer LoginShortcutsPos(Real,Integer);

external procedure DefineTTRRowTypes(Integer);
external function real ItemButtons(string,Integer);
external procedure HWStoreWClassAddProducts(Integer);
external function Boolean HasCharts();
external function Boolean HasDetailedCharts();
external function Boolean HasNewRegistration();
external function Boolean ActivityIsForAcceptanceOrFYI(record ActVc,Boolean,Boolean);
// TravelLog
external function Integer LoginShortcuts();
external function Boolean TestConfigurationEnabler(string);
remote function Integer CustomerSalesPaymentTermType(string);
// POS Standalone
external function Boolean DefCustCodeSetup();
// in-apps
external function Boolean HasInAppsAvailable();
external function Integer CountCountries();

// Language functions ENG
//external function Boolean DisplayLoginKeyPad_ENG();
//external function string 255 VATZoneEditFieldLabel_ENG(Integer);
//external function real VATZoneButtonsLabelsENG(real,real,real,real);
//external procedure LoginButtons2_ENG(Real,Real);
//external procedure FORMDEF_ENG();
//external function string 255 DemoMsgWClassTitle_ENG(Boolean,Boolean);
//external procedure TBEClassDef_ENG();
//external function string 255 VATZoneNameENG();
external procedure DisplayRecordDetails_ENG(LongInt,LongInt,string,date,time,string,string,string,string,string,string,string,string,string,string,string,Integer,string,string,string,val,string,Boolean,string,string);
external procedure DrawPOSInterface_ENG(string,string,record POSButtonsVc,Integer,string,Integer);

/*external procedure TSERW_ENG();
external procedure TSERWNT_ENG();
external procedure TSERWTouch_ENG();
external procedure TSERWTEST_ENG();
external procedure INVFORM_ENG(Boolean);
external procedure DisplayRecordDetailsCustDisplay_ENG(LongInt,LongInt,string,date,time,string,string,string,string,string,string,Integer,string,string,string,val);
external function string 255 ResDayWClassWindowTitle_ENG();
external function string 255 ResMonWClassWindowTitle_ENG();
external function string 255 RTMonWClassWindowTitle_ENG();
external procedure SetupNightAuditWindowControls_ENG(Boolean);
external procedure CURClassDefinitionENG();
external function real DrawPaymentModesButtons_IV_ENG(real);
external function real FunctionButtons_ENG(string);
external procedure CreditCardWindowHeader_ENG(Boolean,Boolean,Real);
external procedure CreditCardWindowButtons_ENG(string,string,real);
external procedure CreditCardWindowInvoiceDetail_ENG(Real);
external procedure CreditCardWindowDeliveryDetail_ENG(Real);
external function real DrawPaymentModesButtons_ENG();
external procedure DrawBarMenuTiles_ENG(string);
external procedure DrawRestPMOtherPay_ENG();
external procedure DisplayRecordDetailsRA_ENG(LongInt,LongInt,string,date,time,string,string,string,string,string,string,Integer,string,LongInt,Date,string,LongInt,string);
external procedure DrawModifierButtons2_ENG(var integer,var integer);
external procedure OKCancel_ENG();
external procedure DefineElearningURLCacheLClass_ENG();
external procedure DefineElearningURLCacheDClass_ENG();
external function real TravelLogDeductions_ENG(real,real);
external procedure LoginButtons_ENG(Real);
external procedure FORMDEF2_ENG();
external procedure FORMDEF3_ENG();
external procedure ARS2RClass_ENG();
external procedure ALLVATRClass_ENG();*/

external function Boolean IsStandardUnused();
external function Boolean IsEnterprise();
external function Boolean StandardHansa();
external function Boolean HasATOL();

external function Boolean HasAccPeriods();
external function Boolean HasAccessGroups();
external function Boolean HasAddFee();
external function Boolean HasApprovals();
external function Boolean HasCCPayments();
external function Boolean HasAdvancedAccounting();
external function Boolean HasAdvancedCRM();
external function Boolean HasAdvancedPricing();
external function Boolean HasAdvancedProduction();
external function Boolean HasAdvancedStock();
external function Boolean HasAged();
external function Boolean HasBar();
external function Boolean HasBase2();
external function Boolean HasBranch();
external function Boolean HasBuyBack();
external function Boolean HasCategories();
//external function Boolean HasConsigmentStock();
external function Boolean HasCommunicator();
external function Boolean HasConsignmentStock();
external function Boolean HasContactClassification();
external function Boolean HasContactRelations();
external function Boolean HasConsolidation();
external function Boolean HasCountryPerCustomer();
external function Boolean HasCreditLimit();
external function Boolean HasCustItem();
external function Boolean HasCustomerSearchKey();
external function Boolean HasCustomerStatusReport();
external function Boolean HasDownpayments();
external function Boolean HasDefineColumns();
external function Boolean HasDeliveryAddress();
external function Boolean HasDepartments();
external function Boolean HasETaxDocuments();
external function Boolean HasEInvoicing();
external function Boolean HasEndorsedChecks();
external function Boolean HasExtraNLComment();
external function Boolean HasExtTax();
external function Boolean HasFavouriteActTypes();
external function Boolean HasFiscalPrinter();
external function Boolean HasFormEditor();
external function Boolean HasFreightAdvanced();
external function Boolean HasHideCostPrice();
external function Boolean HasHotelInterface();
external function Boolean HasGuestUserDefined();
external function Boolean HasJewelleryInterface();
external function Boolean HasIncomeAndExpenseBook();
external function Boolean HasIOUChecks();
external function Boolean HasItemClassification();
external function Boolean HasItemGroups();
external function Boolean HasKPIs();
external function Boolean HasLanguages();
external function Boolean HasLimitedAccess();
external function Boolean HasLocalMachines();
external function Boolean HasLoyaltyCards();
external function Boolean HasMailTags();
external function Boolean HasMainPartner();
external function Boolean HasMultiCurrency();
external function Boolean HasMultiLocations();
external function Boolean HasNLBudget();
external function Boolean HasNLBudgetClass();
external function Boolean HasObjects();
external function Boolean HasInvoiceOfficialSerNr();
external function Boolean HasOfficialSerNr();
external function Boolean HasOrderClasses();
external function Boolean HasPreferedOfficialSerNr();
external function Boolean HasNumberSeries();
external function Boolean HasPersons();
external function Boolean HasPocketScreen();
external function Boolean HasPositions();
external function Boolean HasPrepayments();
external function Boolean HasProjects();//very strange tag
external function Boolean HasPriceLists();
external function Boolean HasQualityControl();
external function Boolean HasReconLevel2();
external function Boolean HasReminderLevel();
external function Boolean HasRemoteBackup();
external function Boolean HasResourceDisplayGroups();
external function Boolean HasRussianPrepayment();
external function Boolean HasRetGoodsToSupp();
external function Boolean HasReturnedGoods();
external function Boolean HasRoomPackages();
external function Boolean HasRoomTypes();
external function Boolean HasRoute();
external function Boolean HasSalesman();
external function Boolean HasSalesmanBonus();
external function Boolean HasSalesGroup();
external function Boolean HasSecondQuantity();
external function Boolean HasSerialNumbers();
external function Boolean HasServerInCloud();
external function Boolean HasSettlementDiscount();
external function Boolean HasSimulations();
external function Boolean hasSimAccruals();
external function Boolean HasSkypeConnection();
external function Boolean HasSIPServerConnection();
external function Boolean HasStrAsSignFType();
external function Boolean HasTouchScreenDevice();
external function Boolean HasTaxMatrix();
external function Boolean HasTestFeatures();
external function Boolean HasMetroTestFeatures();
external function Boolean HasWorkOrders();
external function Boolean HasThrouLocation();
external function Boolean HasTouchScreenLook();
external function Boolean HasTREO();
external function Boolean HasVarieties();
external function Boolean HasVATZone();
external function Boolean HasWithholdingTax();
external function Boolean HasWithholdingTaxAdvanced();
external function Boolean HasWorkOrders();
external function Boolean HasWorkflowOverview();

external function Boolean HasStandardCRM();
external function Boolean HasStandardOrganizer();
external function Boolean HasStandardCommunicator();

external function Boolean HasEMail();
external function Boolean HasExternalEMail();

external function Boolean HasModAT2();
external function Boolean HasModBA();
external function Boolean HasModCheck();
external function Boolean HasModCL();
external function Boolean HasModCO();
external function Boolean HasModCons();
external function Boolean HasModCourses();
external function Boolean HasModCredMan();
external function Boolean HasModCRM();
external function Boolean HasModEDI();
external function Boolean HasModExp();
external function Boolean HasModHotel();
external function Boolean HasModHRM();
external function Boolean HasModIN();
external function Boolean HasModIntStock();
external function Boolean HasModNL();
external function Boolean HasPaymentGateway();
external function Boolean HasModPO();
external function Boolean HasModPOS();
external function Boolean HasModPL();
external function Boolean HasModPOProg();
external function Boolean HasModPP();
external function Boolean HasModProd();
external function Boolean HasModQT();
external function Boolean HasModRent();
external function Boolean HasModRest();
external function Boolean HasModRsrt();
external function Boolean HasModSO();
external function Boolean HasModSL();
external function Boolean HasModSVO();
external function Boolean HasModTS();
external function Boolean HasModWHM();
external function Boolean HasModDI();
external function Boolean UsePostOKButton();
external function Boolean HasBankImport();
external function Boolean HasPLIntegratedWithNL();
external function Boolean HasSLIntegratedWithNL();
external function Boolean HasIntegratedNL();
external function Boolean HasConsStockMoveInvoices();

external function string 255 GetTextForPrint(integer,string); //Edit***************************Sasha2,10:51 20.03.2015
remote function Boolean Getformcode(Integer,Integer,string,string,string,LongInt,LongInt,string,string,Integer,string,var string); //Edit***************************Sasha2,10:51 20.03.2015
remote procedure CheckFormsForPrint(string,string,integer,var array Boolean,var array LongInt,var array string); //Edit***************************Sasha2,11:38 25.11.2015

window IV1DClass:2 //Edit***************************Sasha2,11:13 20.03.2015 {
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,hm,hs,t,v,v2,v3,vm,vs;
  string 255 label,tstr;// Edit ************************** Tuesday, 4 December 2012 10:28:40
  WindowBegin("Invoice",IVDClass,CGview,-);
  //Sizeable(-1,-1,0,0);
  UseView(IVVc);
  if (CurrentCompany==10) then begin //Edit***************************Sasha2,11:19 20.03.2015 {
    ToolBar; 
      HalPushButton(230,5,290,25,"PrintDoInvFormButton","Print");
    EndToolBar; 
  end; //Edit***************************Sasha2,11:19 20.03.2015 }

  ActiveFieldOnNew("OfficialSerNr");  
  SetWRect(20,80,750,500);
  //CommunicateButton;

  EditField(75,vm=(v=6),95,"No.",ViewOnly,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"Customer",ViewOnly,CustCode,false,CUSClass);
  EnterSkip(PayDeal);
  EditField(h=255,v=vm,-40,"Name.",ViewOnly,Addr0,false,0);
  EditField(h,vm=(v+=20),135,"Official No.",Normal,OfficialSerNr,false,LegalInvNrSClass);
  //CheckBox(h4=-100,v,0,"OK",OKFlag);
  vs = 20;
  label = UserDefined("CUVc","InvAddr0");
  if (blank(label)) then begin label = "Invoice"; end;
  EditField(h=75,v=90,-40,label,Normal,Addr1,false,0);
  label = UserDefined("CUVc","InvAddr1");
  if (blank(label)) then begin label = "Address"; end;
  EditField(h,v+=vs, -40,label,Normal,Addr2,false,0);
  label = UserDefined("CUVc","InvAddr2");
  EditField(h,v+=vs, -40,label,Normal,Addr3,false,0);
  label = UserDefined("CUVc","InvAddr3");
  EditField(h,v+=vs, -40,label,Normal,InvAddr3,false,0);
  label = UserDefined("CUVc","InvAddr4");
  EditField(h,v+=vs, -40,label,Normal,InvAddr4,false,0);
  EditField(h,vm=(v+=vs),80,"#VAT Reg. No.#",Normal,VATNr,false,0);

  EndWindow;
end; //Edit***************************Sasha2,11:13 20.03.2015 }
/*
window IVDClass:2
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,hm,hs,t,v,v2,v3,vm,vs;
  string 255 label,tstr;// Edit ************************** Tuesday, 4 December 2012 10:28:40
  WindowBegin("Invoice",IVDClass,CGview,-);
  Sizeable(-1,-1,0,0);
  UseView(IVVc);
  if (CurrentCompany==10) then begin //Edit***************************Sasha2,11:19 20.03.2015 {
    ToolBar; 
      HalPushButton(230,5,290,25,"PrintDoInvFormButton","Print");
    EndToolBar; 
  end; //Edit***************************Sasha2,11:19 20.03.2015 }
if (HasTouchScreenLook==false) then begin
  ActiveFieldOnNew("CustCode");  
  SetWRect(20,80,750,460);
  CommunicateButton;
  Tile(0,74,false,"",CustCode);
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"Customer",Normal,CustCode,false,CUSClass);
  EnterSkip(PayDeal);
  EditField(h=255,v=vm,-40,"Name",Normal,Addr0,false,0);
  EditField(h,vm=(v+=20),135,"Official No.",Normal,OfficialSerNr,false,LegalInvNrSClass);
  CheckBox(h+200,v,0,"Not for reports",NotForReport);		//Edit----------------------Dima  01.04.2015
  CheckBox(h4=-100,v,0,"OK",OKFlag);
  TileButton(1,"Terms");
  TileButton(2,"Items");
  TileButton(3,"Currency");
  TileButton(4,"Del. Terms");
  TileButton(5,"Identifiers");
  TileButton(6,"Price List");
  TileButton(7,"Inv. Address");
  TileButton(8,"Faktura");// Edit ************************** Tuesday, 20 October 2015 14:08:21
  Tile(1,110,false,"1",InvDate);
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -100;
  EditField(h1,vm=(v=6),82,"Invoice Date",Normal,InvDate,false,PasteCurDate);
  EditField(h1,v+=vs,25,"Payment Terms",Normal,PayDeal,false,PDSClass);//PDMSClass);
  EditField(h1,v+=vs,82,"Due Date",Normal,PayDate,false,PasteCurDate);
  EditField(h1,v+=vs,82,"Trans. Date",Normal,TransDate,false,PasteCurDate);
  EditField(h2,v=vm,135,"Our Reference",Normal,OurContact,false,0);
  EditField(h2,v+=vs,135,"Attention",Normal,ClientContact,false,ContactSClass);
  EditField(h2,v+=vs,135,"Objects",Normal,Objects,false,ObjSClass);
  EditField(h2,v+=vs,135,"Reference",Normal,RefStr,false,0);
  EditField(h2,v+=vs,135,"Cust. Ord. No.",Normal,CustOrdNr,false,0);
  EditField(h3,v=vm,80,"#Salesman#",Normal,SalesMan,false,UserSClass);
  EditField(h3,v+=vs,80,"Loc. machine ",Normal,MachineName,false,LocalMachineSClass);// Edit ************************** Monday, 15 April 2013 12:00:16
  EditField(h3,v+=vs,80,"Renting",Normal,RetValue,false,0);// Edit ************************** Monday, 15 April 2013 12:00:16
  EditField(h3,v+=vs,80,"Receipt No.",Normal,ReceiptNrForReturn,false,0);	//Edit----------------------Dima  14.04.2015
  
  EnterSkip(Math);
  Tile(2,220,true,"2",Math);
  //  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(55,-41,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  if (UserCanAction("ViewCostPrice",true)) then begin
    //EditField(160,-41,70,"GP %",Normal,GPProc,true,0);
    EditField(160,-21,70,"Total GP",ViewOnly,TotGP,true,0);
  end;
  EditField(290,-41,70,"TAX2",ViewOnly,TAX2Sum,true,0);
  EditField(290,-21,70,"Ext. Tax",ViewOnly,TAX1Sum,true,0);
  EditField(410,-41,95,"#VAT#",ViewOnly ,Sum3,true,0);
  EditField(410,-21,95,"Base",ViewOnly,BaseSum4,true,0);
  EditField(-150,-41,95,"Subtotal",ViewOnly ,Sum1,true,0);
  EditField(-150,-21,95,"TOTAL",ViewOnly ,Sum4,true,0);
  v = 24;
  MatrixBegin(4,v,-50,-49,-,200);
  MatTypedRow(stp);
  Flip(0);
  MatCol(t=kInvoiceRowTypeNormal,32,"Item",0,ArtCode,false,INSClass);
  //  MatCol(t,94,"Var",0,VARList,true,VARSClass);
  //  MatCol(t,144,"Qty",0,Quant,true,0);
  if (HasVarieties) then begin
  MatCol(t,94,"Qty",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(t,94,"Qty",0,Quant,true,0); 
  end;
  EnterSkip(ArtCode);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,32,"Item",0,ArtCode,false,INSClass);
  if (HasVarieties) then begin
  MatCol(t,94,"Qty",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(t,94,"Qty",0,Quant,true,0); 
  end;
  EnterSkip(ArtCode);
  MatText(t=kInvoiceRowTypeCredit,32,"Credit of Invoice",true);
  MatCol(t,208,"",0,OrdRow,false,ARSClass);
  MatCol(t,-216,"",0,Spec,false,0);//MatText(t,-216,"",true);
  MatText(t=kInvoiceRowTypeInterest,32,"Interest",true);
  MatCol(t,98,"",0,ArtCode,false,0);
  MatCol(t,153,"",0,Quant,true,0);
  MatCol(t,188,"",0,Spec,false,0);
  MatText(t=kInvoiceRowTypeDownpayment,32,"Down Payment",true);
  MatColTL(t,122,"",0,-1,ViewOnly,0,ArtCode,true,0); 
  MatColTL(t,188,"",0,-1,ViewOnly,0,Quant,true,0);
  MatCol(t,238,"",0,Spec,false,0);
  MatColTL(t,-170,"",0,-1,Normal,0,Sum,true,0); //?? TL?
  if (UseTaxTemplatesforTaxCalc) then begin
    MatCol(t,-100,"",0,SalesAcc,false,AccSClass);
    MatCol(t,-54,"",0,TaxTemplateCode,false,TaxTemplateSClass);
  end else begin
    MatCol(t,-70,"",0,SalesAcc,false,AccSClass);
    MatCol(t,-24,"",0,VATCode,false,VATCodeSClass);
  end;
  MatText(t=kInvoiceRowTypePrepayment,32,"Prepayment Number",true);
  MatCol(t,170,"",0,CUPNr,true,ARPay2SClass);
  MatCol(t,-300,"",0,BasePrice,false,0);
  MatCol(t,-170,"",0,Price,true,0);// Price holds the VAT sum, Recipe holds the date of prepaym. 
  MatCol(t,-100,"",0,Sum,true,0);  
  MatText(t=kInvoiceRowTypeLoan,32,"Loan",true);
  MatCol(t,98,"",0,CuAccCode,true,CuAccSClass);
  MatCol(t,-350,"",0,SalesAcc,true,AccSClass);
  MatCol(t,-230,"",0,Objects,false,0);
  MatCol(t,-110,"",0,Sum,true,0);
  MatCol(t,-30,"",0,VATCode,false,VATCodeSClass);
  MatText(t=kInvoiceRowTypeLoanInterest,32,"Loan Int.",true);
  MatCol(t,98,"",0,CuAccCode,true,CuAccSClass);
  MatCol(t,-350,"",0,SalesAcc,true,AccSClass);
  MatCol(t,-230,"",0,Objects,false,0);
  MatCol(t,-110,"",0,Sum,true,0);
  MatCol(t,-30,"",0,VATCode,false,VATCodeSClass);
  MatText(t=kInvoiceRowTypeVoid,28,"Void",false);
  MatColTL(t,65,"Sign",0,-1,ViewOnly,0,VoidedSign,false,0);
  MatCol(t,100,"Item",0,ArtCode,false,INSClass);
  if (HasVarieties) then begin
  MatCol(t,150,"Qty.",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(t,150,"Qty.",0,Quant,true,0); 
  end;
  MatCol(t,190,"Price",0,Price,true,0);
  MatCol(t,250,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-195,"Ser. No",0,SerialNr,false,SerialNrSClass);
  MatCol(t,-110,"%",0,vRebate,true,0);
  MatCol(t,-80,"Sum",0,Sum,true,0);
  MatText(t=kInvoiceRowTypeSubtotal,32,"TOTAL",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatColTL(t,-140,"Sum",0,-1,ViewOnly,0,Sum,true,0);
  //  MatCol(t,-70,"Cost",0,Cost,true,0);
  MatText(t=kInvoiceRowTypeHidden,32,"This row and all rows below it will be hidden on printout",false);
  MatText(t=kInvoiceRowTypeCorrection,32,"K",true);
  MatCol(t,45,"Item",0,ArtCode,false,INSClass);
  MatCol(t,91,"Qty",0,Quant,true,0); 
  MatText(t=kInvoiceRowTypeRetention,32,"Retention",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatColTL(t,-210,"SalesAcc",0,-1,0,0,SalesAcc,false,AccSClass);
  MatColTL(t,-110,"Sum",0,-1,0,0,Sum,true,0);
  MatCol(t,-30,"",0,VATCode,false,VATCodeSClass);
  MatText(t=kInvoiceRowTypeGiftVoucherSold,32,"GV",true);
  MatCol(t,58,"",0,GCNr,false,GCSClass);
  MatCol(t,-416,"",0,Spec,false,0);
  MatCol(t,-84,"Sum",0,Sum,true,0);
  MatCol(t,-24,"",0,VATCode,false,VATCodeSClass);  
  MatText(t=kInvoiceRowTypeGiftVoucherPayment,32,"GVR",true);
  MatCol(t,58,"",0,GCNr,false,GCSSClass);
  MatCol(t,-316,"",0,Spec,false,0);
  MatCol(t,-84,"Sum",0,Sum,true,0);
  MatCol(t,-24,"",0,VATCode,false,VATCodeSClass);  
  MatText(t=kInvoiceRowTypeCashPayment,32,"CASH",true);
  MatCol(t,94,"Sum",0,Sum,true,0);
  MatCol(t,198,"Currency",0,CurncyCode,true,CurncyCodeSClass); 
  MatCol(t,250,"Spec",0,Spec,false,0); 
  MatText(t=kInvoiceRowTypeLoyaltyPointsPayment,32,"LOYPA",true);
  MatCol(t,68,"Sum",0,Sum,true,0);
  MatCol(t,108,"Points",0,Points,true,0);
  MatCol(t,148,"Currency",0,CurncyCode,true,CurncyCodeSClass);
  MatCol(t,-280,"Spec",0,Spec,false,0);
  MatText(t=kInvoiceRowTypeLoyaltyPointsBonus,28,"LOYBO",true);
  MatCol(t,68,"Points",0,Points,true,0);
  MatCol(t,141,"Spec",0,Spec,false,0);
  MatText(t=kInvoiceRowTypeCreditCardPayment,32,"CC",true);
  MatCol(t,58,"Sum",0,Sum,true,0);
  MatCol(t,-280,"",0,CreditCard,false,CreditCardSClass);
  MatCol(t,-84,"Authorization",0,AuthorizationCode,false,0);
  MatText(t=kInvoiceRowTypeHeader,32,"Header",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatText(t=kInvoiceRowType18,28,"Reserved",true); // Don't use this number
  MatCol(t,100,"",0,Spec,false,0);
  MatText(t=kInvoiceRowType19,28,"Reserved",true); // Don't use this number
  MatCol(t,100,"",0,Spec,false,0);
  MatText(t=kInvoiceRowTypePerceptionTax,32,"Perception Tax",true);
  MatCol(t,132,"",0,CuAccCode,false,0);
  MatCol(t,252,"",0,TAX2Prc,true,0);
  MatCol(t,292,"",0,Sum,true,0);
  MatCol(t,372,"",0,SalesAcc,false,0);
  MatCol(t,452,"",0,Spec,false,0);
  MatText(t=kInvoiceRowTypeWithholdingTax,32,"Withholding Tax",true);
  MatCol(t,132,"",0,WHTax,false,WHTaxSClass);
  MatCol(t,172,"",0,SalesAcc,false,AccSClass);
  MatCol(t,292,"",0,Sum,true,0);
  MatCol(t,392,"",0,Spec,false,0);
  MatText(t=kInvoiceRowTypeMultiBuyDiscount,32,"Multi-buy Discount",true);
  MatCol(t,152,"",0,MBRCode,false,0);
  MatCol(t,192,"",0,ArtCode,false,INSClass);
  MatCol(t,-400,"",0,Spec,false,0);
  MatCol(t,-270,"",0,Quant,true,0);
  MatCol(t,-235,"",0,Price,true,0);
  MatCol(t,-135,"",0,vRebate,true,0);
  MatCol(t,-100,"",0,Sum,true,0);
  MatText(t=kInvoiceRowTypeDebtorsTransfer,32,"DBT TRSF",true);
  MatCol(t,94,"Spec",0,Spec,false,0);
  MatCol(t,-235,"Debtors A/C",0,SalesAcc,false,0);
  MatCol(t,-135,"Sum",0,Sum,true,0);
  MatCol(t,-30,"#VAT#",0,VATCode,false,0);
 
  //t = 21 kInvoiceRowTypeChequePayment  
  Flip(1);
  //  MatCol(t=kInvoiceRowTypeNormal,194,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t=kInvoiceRowTypeNormal,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-235,"Price",0,Price,true,0);
  //  MatColTL(t,-235,"",0,M45Val,Normal,0,Price,true,0);
  MatCol(t,-135,"%",0,vRebate,true,0);
  MatCol(t,-100,"Sum",0,Sum,true,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-235,"Price",0,Price,true,0);
  //  MatColTL(t,-235,"",0,M45Val,Normal,0,Price,true,0);
  MatCol(t,-135,"%",0,vRebate,true,0);
  MatCol(t,-100,"Sum",0,Sum,true,0);
  MatCol(t=kInvoiceRowTypeInterest,-260,"",0,OrdRow,true,0);
  MatCol(t,-235,"",0,BasePrice,true,0);
  MatCol(t,-135,"",0,vRebate,true,0);
  MatCol(t,-100,"",0,Sum,true,0);
  MatCol(t=kInvoiceRowTypeCorrection,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-235,"Price",0,Price,true,0);
  MatCol(t,-135,"%",0,vRebate,true,0);
  MatCol(t,-100,"Sum",0,Sum,true,0);
  Flip(2);
  MatCol(t=kInvoiceRowTypeNormal,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-360,"A/C",0,SalesAcc,false,AccSClass);
  MatCol(t,-310,"Accrual",0,PeriodCode,false,AutSimPerSClass);
  MatCol(t,-255,"Location",0,Location,false,LocationSClass);
  MatCol(t,-180,"Position",0,PosCode,false,UsedPosSClass);
  if (UseTaxTemplatesforTaxCalc) then begin
    MatCol(t,-144,"Objects",0,Objects,false,ObjSClass);
    MatCol(t,-70,"#VAT#",0,TaxTemplateCode,false,TaxTemplateSClass);
  end else begin
    MatCol(t,-124,"Objects",0,Objects,false,ObjSClass);
    MatCol(t,-30,"#VAT#",0,VATCode,false,VATCodeSClass);
  end;
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-360,"A/C",0,SalesAcc,false,AccSClass);
  MatCol(t,-310,"Accrual",0,PeriodCode,false,AutSimPerSClass);
  MatCol(t,-255,"Location",0,Location,false,LocationSClass);
  MatCol(t,-180,"Position",0,PosCode,false,UsedPosSClass);
  if (UseTaxTemplatesforTaxCalc) then begin
    MatCol(t,-144,"Objects",0,Objects,false,ObjSClass);
    MatCol(t,-70,"#VAT#",0,TaxTemplateCode,false,TaxTemplateSClass);
  end else begin
    MatCol(t,-124,"Objects",0,Objects,false,ObjSClass);
    MatCol(t,-30,"#VAT#",0,VATCode,false,VATCodeSClass);
  end;
  MatCol(t=kInvoiceRowTypeInterest,-70,"",0,SalesAcc,false,AccSClass);
  MatCol(t,-24,"",0,VATCode,false,VATCodeSClass);
  //  MatCol(t=kInvoiceRowTypePrepayment,-224,"",0,SalesAcc,false,AccSClass);
  //  MatCol(t,-24,"",0,VATCode,false,VATCodeSClass);
  MatCol(t=kInvoiceRowTypeCorrection,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-250,"A/C",0,SalesAcc,false,AccSClass);
  MatCol(t,-170,"Accrual",0,PeriodCode,false,AutSimPerSClass);
  MatCol(t,-104,"Objects",0,Objects,false,ObjSClass);
  MatCol(t,-30,"#VAT#",0,VATCode,false,VATCodeSClass);
  Flip(3);
  MatCol(t=kInvoiceRowTypeNormal,144,"Prev. Down Payment",0,Spec,false,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-380,"Price",0,Price,true,0);
    MatCol(t,-315,"%",0,vRebate,true,0);
    MatCol(t,-280,"Cost B2",0,BasePriceB2,true,0);
    MatCol(t,-210,"Cost",0,BasePrice,true,0);
    MatCol(t,-140,"GP",0,rowGP,true,0);
    MatCol(t,-70,"Row FIFO",0,FIFO,true,0);
  end else begin
    MatCol(t,-235,"Price",0,Price,true,0);
    MatCol(t,-135,"%",0,vRebate,true,0);
    MatCol(t,-100,"Sum",0,Sum,true,0);
  end;
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Prev. Down Payment",0,Spec,false,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-380,"Price",0,Price,true,0);
    MatCol(t,-315,"%",0,vRebate,true,0);
    MatCol(t,-280,"Cost B2",0,BasePriceB2,true,0);
    MatCol(t,-210,"Cost",0,BasePrice,true,0);
    MatCol(t,-140,"GP",0,rowGP,true,0);
    MatCol(t,-70,"Row FIFO",0,FIFO,true,0);
  end else begin
    MatCol(t,-235,"Price",0,Price,true,0);
    MatCol(t,-135,"%",0,vRebate,true,0);
    MatCol(t,-100,"Sum",0,Sum,true,0);
  end;
  MatCol(t=kInvoiceRowTypeCorrection,144,"Prev. Down Payment",0,Spec,false,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-315,"Price",0,Price,true,0);
    MatCol(t,-245,"%",0,vRebate,true,0);
    MatCol(t,-210,"Cost",0,BasePrice,true,0);
    MatCol(t,-140,"GP",0,rowGP,true,0);
    MatCol(t,-70,"Row FIFO",0,FIFO,true,0);
  end else begin
    MatCol(t,-235,"Price",0,Price,true,0);
    MatCol(t,-135,"%",0,vRebate,true,0);
    MatCol(t,-100,"Sum",0,Sum,true,0);
  end;
  Flip(4);
  MatCol(t=kInvoiceRowTypeNormal,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-370,"#Salesmen#",0,Salesmen,false,UserSClass); 
  MatCol(t,-310,"Serial No",0,SerialNr,false,SerialNrSClass); 
//  MatCol(t,-250,"Main Serial No.",0,MotherNr,true,0);
  MatCol(t,-230,"P.Factor",0,PriceFactor,true,0); 
  MatCol(t,-180,"Recipe",0,Recepy,false,RecSClass);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-70,"Row FIFO",0,FIFORowVal,true,0);
  end else begin
  end;
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-310,"Ser. No",0,SerialNr,false,SerialNrSClass);
  MatCol(t,-240,"P.Factor",0,PriceFactor,true,0);
  MatCol(t,-180,"Recipe",0,Recepy,true,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-110,"Row FIFO",0,FIFORowVal,true,0);
  end else begin
  end;
  MatCol(t,-40,"Coeff",0,Coefficient,true,0);
  MatCol(t=kInvoiceRowTypeCorrection,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,-310,"Ser. No",0,SerialNr,false,SerialNrSClass);
  MatCol(t,-240,"P.Factor",0,PriceFactor,true,0);
  MatCol(t,-180,"Recipe",0,Recepy,true,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-110,"Row FIFO",0,FIFORowVal,true,0);
  end else begin
  end;
  MatCol(t,-80,"",0,MotherArtCode,false,0);
  MatCol(t,-40,"",0,RecipeQuant,false,0);
  //  MatCol(t,-40,"Coeff",0,Coefficient,true,0);
  Flip(5);
  MatCol(t=kInvoiceRowTypeNormal,144,"Description",0,Spec,false,0);
  MatCol(t,-315,"Unit",0,UnitCode,false,UnitSClass);
  MatCol(t,-260,"Unit Qty",0,UnitFactQuant,true,0);
  MatCol(t,-200,"Width",0,UnitXval,true,0);
  MatCol(t,-160,"Height",0,UnitYval,true,0);
  MatCol(t,-120,"Depth",0,UnitZval,true,0);
  MatCol(t,-80,"Unit Pr. of Unit",0,UnitFactPrice,true,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  MatCol(t,-315,"Unit",0,UnitCode,false,UnitSClass);
  MatCol(t,-260,"Unit Qty",0,UnitFactQuant,true,0);
  MatCol(t,-200,"Width",0,UnitXval,true,0);
  MatCol(t,-160,"Height",0,UnitYval,true,0);
  MatCol(t,-120,"Depth",0,UnitZval,true,0);
  MatCol(t,-80,"Unit Pr. of Unit",0,UnitFactPrice,true,0);
  MatCol(t=kInvoiceRowTypeCorrection,144,"Description",0,Spec,false,0);//New Row Type..
  MatCol(t,-315,"Unit",0,UnitCode,false,UnitSClass);
  MatCol(t,-260,"Unit Qty",0,UnitFactQuant,true,0);
  MatCol(t,-200,"Width",0,UnitXval,true,0);
  MatCol(t,-160,"Height",0,UnitYval,true,0);
  MatCol(t,-120,"Depth",0,UnitZval,true,0);
  MatCol(t,-80,"Unit Pr. of Unit",0,UnitFactPrice,true,0);
  Flip(6);
  MatCol(t=kInvoiceRowTypeNormal,144,"Description",0,Spec,false,0);
  MatCol(t,-390,"Cust. Item No.",0,CustArtCode,false,CUINSClass); 
  MatCol(t,-300,"Coeff.",0,Coefficient,true,0); 
  MatCol(t,-260,"P.Factor",0,PriceFactor,true,0); 
  MatCol(t,-210,"Serv. Co. Hist.",0,CUServiceHistNr,false,0); 
  MatCol(t,-130,"Cred. Row",0,CreditedRow,false,0); 
  MatCol(t,-70,"Environ. Tax",0,RepaExVAT,true,0); 
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  MatCol(t,-390,"Cust. Item No.",0,CustArtCode,false,CUINSClass); 
  MatCol(t,-300,"Coeff.",0,Coefficient,true,0); 
  MatCol(t,-260,"P.Factor",0,PriceFactor,true,0); 
  MatCol(t,-210,"Serv. Co. Hist.",0,CUServiceHistNr,false,0); 
  MatCol(t,-130,"Cred. Row",0,CreditedRow,false,0); 
  MatCol(t,-70,"Environ. Tax",0,RepaExVAT,true,0); 
  MatCol(t=kInvoiceRowTypeCorrection,144,"Description",0,Spec,false,0);
  MatCol(t,-80,"Environ. Tax",0,RepaExVAT,true,0);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 22;
  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,2,"B");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,3,"C");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,4,"D");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,5,"E");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,6,"F");
  Tile(3,70,false,"3",FrRate);
  vs = 20;
  EditField(h1,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2,v,50,"Course",Normal,FrRate,true,0);
  EditField(h2+65,v,50,":",Normal,ToRateB1,true,0);
  StaticText(h2+125,v+12,"Base Currency 1",false);
  EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
  EditField(h2+65,v,50,":",Normal,ToRateB2,true,0);
  StaticText(h2+125,v+12,"Base Currency 2",false);
  EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
  Tile(4,110,false,"4",ShipDeal);
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -100;
  EditField(h1,v=6,80,"Delivery Terms",Normal,ShipDeal,false,ShipDealSClass);
  EditField(h1,v+=vs,80,"Delivery Mode",Normal,ShipMode,false,DMSClass);
  EditField(h1,v+=vs,80,"Route",Normal,Sorting,false,DelRouteSClass);
  EditField(h1,v+=vs,80,"Location",Normal,Location,false,LocationSClass);
  EditField(h1,v+=vs,80,"Branch",ViewOnly,BranchID,false,AllCUSClass);
  EditField(h2,v=vm,80,"Total Quantity",ViewOnly,TotQty,true,0);
  EditField(h2,v+=vs,80,"Total Weight",ViewOnly,TotWeight,true,0);
  EditField(h2,v+=vs,80,"Total Volume",ViewOnly,TotVolume,true,0);
  EditField(h2,v+=vs,80,"Freight",Normal,FrPrice,true,0);
  EditField(h2,v+=vs,80,"Freight Comp.",Normal,FreightCode,false,FreightCompanySClass);
  CheckBox(h3,v=vm,0,"Update #Stock#",UpdStockFlag);
  EditField(h3,v+=3*vs,80,"Freight #V-Cd#",Normal,FrVATCode,true,VATCodeSClass);
  Tile(5,170,false,"5",OrderNr);
  EditField(h1,v=vm,80,"Order No.",ViewOnly,OrderNr,false,0);
  EditField(h1,v+=vs,80,"Serv Ord. No.",ViewOnly,SVONr,false,0);
  EditField(h1,v+=vs,80,"Cred. Man. No.",ViewOnly ,CredManNr,false,0);
  EditField(h1,v+=vs,80,"Stat. Value",Normal,StatVal,true,0);
  EditField(h1,v+=vs,80,"Service Del. Date",Normal,ServiceDelDate,false,PasteCurDate);
  EditField(h1,v+=vs,80,"Trans. Time",Normal,TransTime,false,SetSClass);
  //  ColourPushButton(-100,v,-20,v+60,"TestIVDClassCardData","Test" & chr(10) & "CardData",4);
  //  SoftEditField(h3+50,v,100,"Control Code"  ,ViewOnly ,"TaxAuthIDCC",false,0,M4Str,60);
  EditField(h2,v=vm,135,"Tax Auth. ID",ViewOnly ,TaxAuthID,false,0);
  EditField(h2,v+=vs,135,"Control Code",ViewOnly ,TaxAuthIDCC,false,0);
  EditField(h2,v+=vs,135,"CAE/CAEA",Normal,CAE,false,0);
  EditField(h2,v+=vs,135,"CAE Expiry",Normal,CAEExpiry,false,0);
  EditField(h2,v+=vs,70,"CAEA Start",ViewOnly,CAEAStartDate,false,0);
  EditField(h2+173,v,70,"CAEA Expiry",ViewOnly,CAEAExpiryDate,false,0); //##cc  
  EditField(h2,v+=vs,70,"CAEA Start",ViewOnly,CAEAStartDate,false,0);
  EditField(h2+173,v,70,"CAEA Expiry",ViewOnly,CAEAExpiryDate,false,0); //##cc 
  EditField(h2,v+=vs,135,"Status",Normal,Status,false,SetSClass);
  EditField(h2,v+=vs,135,"Bank",Normal,BankCode,false,BankSClass);
  //  EditField(h2,v+=vs,135,"E-Inv Exp. Date",ViewOnly,EInvExpDate,false,0);//Tx server
  //  EditField(h2,v+=vs,135,"E-Inv Exp. Qty",ViewOnly,EInvExpQty,false,0);
  h3 = 545; //##ii;
  CheckBox(h3,v=vm,0,"No Reminder",NoRemndrFlag);
  CheckBox(h3,v+=16,0,"No Interest",NoInterestFlag);
  CheckBox(h3,v+=16,0,"No Collection",NoColectionFlag);
  CheckBox(h3,v+=16,0,"Cust. _Info on Trans.",ARonTR);
  CheckBox(h3,v+=16,0,"Don't send as E-Invoice",NoEInvoice);
  CheckBox(h3,v+=16,0,"Fiscal Invoice",FiscalFlag);
  CheckBox(h3,v+=16,0,"Self Billing",SelfBilling);
  //  CheckBox(h3,v+=16,0,"E-Invoice Exported",EInvExpFlag);
  Tile(6,150,false,"6",PriceList); vs = 20;
  EditField(h1,v=vm,80,"Price List",Normal,PriceList,false,PLDefSClass);
  EditField(h1,v+=vs,80,"Discount Matrix",ViewOnly,RebCode,false,0); 
  //  EditField(h1,v+=vs,80,"Disc. %",ViewOnly,DiscPerc,false,0);
  //  EditField(h1,v+=vs,80,"Disc. Amount",ViewOnly,DiscSum,false,0);
  EditField(h1,v+=vs,80,"Original Customer",ViewOnly,OrgCust,false,0);
  EditField(h1,v+=vs,80,"Credit Card",Normal,CreditCard,false,CreditCardSClass);
  EditField(h1,v+=vs,80,"Authorization",Normal,AuthorizationCode,false,0);
  EditField(h1,v+=vs,80,"Debtors",Normal,ARAcc,false,AccSClass);
  EditField(h1,v+=vs,-20,"Comment",Normal,InvComment,false,0);
  EditField(h2,v=vm,80,"Sales Group",ViewOnly,SalesGroup,true,0);
  EditField(h2,v+=vs,80,"Language",Normal,LangCode,false,LangSClass);
  EditField(h2,v+=vs,80,"Commission",Normal,Commision,true,0);
  EditField(h2,v+=vs,80,"Total Incl. Com.",ViewOnly,SumIncCom,true,0);
  EditField(h2,v+=vs,80,"Interest",Normal,IntCode,true,IntSClass);
  EditField(h2,v+=vs,80,"Org. No.",Normal,CredInv,false,0);
  EditField(h3,v=vm,80,"Reminder Level",Normal,LastRemndr,false,0);
  EditField(h3,v+=vs,80,"Last Reminder Date",Normal,LastRemDate,false,PasteCurDate);
  EditField(h3,v+=vs,80,"Loyalty Card",Normal,LoyaltyCardNr,false,LoyaltyCardSClass);
  EnterSkip(Math);
  EditField(h3,v+=vs,80,"Membership Level",ViewOnly,LCMLevel,false,LCMemberLevelSClass);
  EditField(h3,v+=vs,80,"Loyalty Points",ViewOnly,Points,true,0);
  EditField(h3,v+=vs,80,"TREO No.",Normal,TREONr,false,0);
  Tile(7,250,false,"7",Addr1); vs = 20;
  label = UserDefined("CUVc","InvAddr0");
  if (blank(label)) then begin label = "Invoice"; end;
  EditField(h=110,v=6,-20,label,Normal,Addr1,false,0);
  label = UserDefined("CUVc","InvAddr1");
  if (blank(label)) then begin label = "Address"; end;
  EditField(h,v+=vs, -20,label,Normal,Addr2,false,0);
  label = UserDefined("CUVc","InvAddr2");
  EditField(h,v+=vs, -20,label,Normal,Addr3,false,0);
  label = UserDefined("CUVc","InvAddr3");
  EditField(h,v+=vs, -20,label,Normal,InvAddr3,false,0);
  label = UserDefined("CUVc","InvAddr4");
  EditField(h,v+=vs, -20,label,Normal,InvAddr4,false,0);
  EditField(h,vm=(v+=vs),80,"Country",Normal,InvCountry,false,CountrySClass);
  ButtonFrame(h3=h+4,v=(vm+=40),123,6,"Approval status");
  RadioButton(h3,v,kAcceptanceStateNotRequired,0,"Not Required",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateNotStarted,0,"Not Started",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateNotRequested,0,"Not Requested",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStatePending,0,"Pending",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateApproved,0,"Approved",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateRejected,0,"Rejected",AcceptanceStatus);  
   //v = VATZoneButtonsLabelsENG(h3=290,v=vm,140,16);// Edit ************************** Saturday, 19 August 2017 11:40:03
  EditField(h2=-170,v=vm,150,"Region",Normal,Region,false,RegionSClass); 
  EditField(h2,v+=vs,150,"#VAT Reg. No.#",Normal,VATNr,false,0);
  EditField(h2,v+=vs,150,"Telephone",Normal,Phone,false,0);
  EditField(h2,v+=vs,150,"Fax",Normal,Fax,false,0);
  
  Tile(8,170,false,"8",ShipAddr0); vs = 20;
  EditField(h1,v=6,80,"Do paragonu",Normal,ReceiptNrForReturn,false,0);// Edit ************************** Tuesday, 20 October 2015 14:14:09
  EditField(h1,v+=vs,-20,"Name",Normal,Addr0,false,0);
  EditField(h1,v+=vs,-20,"Addres 1",Normal,Addr1,false,0);
  EditField(h1,v+=vs,-20,"Addres 2",Normal,Addr2,false,0);
  EditField(h1,v+=vs,-20,"Addres 3",Normal,Addr3,false,0);
  EditField(h1,v+=vs,-20,"NIP",Normal,VATNr,false,0);
  
  EnterSkip(InvDate);
  
  SpecialMenu("Item Status",'I',0,"ItemStatusIVDsm");
  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  SpecialMenu("Invoice Status",'r',2,"IVInfoIVDsm");
  SpecialMenu("Previous Sales Prices",' ',15,"IVLastSPrsm");
  SpecialMenu("Add Header Line",' ',12,"HeaderLineIVDsm");
  SpecialMenu("Add Hidden Line",' ',12,"HiddenLineIVDsm");
  SpecialMenu("Add Environment Tax",' ',19,"RepaIVsm");
  SpecialMenu("Add Retention",' ',25,"RetentionLineIVDsm"); 
  SpecialMenu("Add Subtotal",' ',12,"SubTotalLineIVDsm");
  SpecialMenu("Send for Approval",' ',6,"IVSendforAcceptanceIVDsm");
  SpecialMenu("Cancel Approval Request",' ',2,"CancelApprovalRequestDsm"); //!!PRODTRANSLATE
  if (GuiType==kGuiiPhone) then begin
    SpecialMenu("Sign",' ',10,"SignIVDsm"); //!!TRANSLATE
  end;
  SpecialMenu("Change to Base 1",' ',14,"SwitchToBase1IVDsm");
  SpecialMenu("Connect to Prepayment",' ',4,"ConnectToPrepayIVDsm");
  SpecialMenu("Recalculate Discount",' ',11,"RecalcDiscountIVDsm");
  SpecialMenu("Recalculate Weight and Volume",' ',10,"RecalcWeightIVDsm");
  SpecialMenu("Update Currency Price List Items",' ',5,"UpdatePricesIVDsm");
  SpecialMenu("Print Cash IN-OUT",' ',7,"PrintCashInOutIVDsm");
  SpecialMenu("Print Proforma Invoice",' ',3,"PrintProformaIVDsm");
  SpecialMenu("Send to Fiscal Device",' ',19,"PrintToFiscPrntIVDsm");
  SpecialMenu("Credit Card Payment",' ',22,"CCPayIVDsm");
  SpecialMenu("Edit #Instalments#",' ',24,"EditInstalmentIVDsm");
  SpecialMenu("Resend E-Invoice",' ',21,"ResendEIVDsm");

  SpecialMenu("Open #NL# Transaction",'t',8,"OpenTRFromIV");
  SpecialMenu("Create Cash In",' ',1,"DoCLInFromIVD");
  SpecialMenu("Create #Credit Note#",' ',20,"CreateCreditNoteIVDsm");
  SpecialMenu("Create Credit Agreement",' ',25,"CreateCredManIVsm");
  SpecialMenu("Create Contract",' ',13,"COFromIVDsm");
  SpecialMenu("Create Correction Invoice",' ',16,"CreateCreditNoteIVDsm");// Edit ************************** Tuesday, 7 July 2015 12:02:08
  
  
  SpecialMenu("Create Correction Invoice #2",' ',16,"CorrectionIVsm");// Edit ************************** Tuesday, 7 July 2015 12:02:08
  SpecialMenu("Create Debit Note",' ',20,"CreateDebitNoteIVDsm");
  SpecialMenu("Create EDI Invoice",' ',9,"DoEDIInvFromIVD");
  SpecialMenu("Create E-Mail",'m',23,"CreateMailFromIVDsm");

  SpecialMenu("Create #Instalment# Receipts",' ',6,"CreateInstalmentsIVDsm");
  SpecialMenu("Create #VAT# Correction #S/L#",' ',17,"VATCorrectionIVsm");
  SpecialMenu("Manager's Discount Override",' ',24,"MgrsDiscOverrideIVDsm");  
  SpecialMenu("Open TAX Matrix",' ',25,"TestVatMatrixIVDsm"); 
  SpecialMenu("Add Returns",' ',0,"PasteRetItemIVDsm");
   // SpecialMenu("Apple Warranty Status Check",'w',26,"WarrantyStatusIVDsm"); 
  if(currentuser=="SA")then begin
		SpecialMenu("Register Rxport",' ',0,"ExportRegIVDsm");
	end;
end else begin

  date td;
  integer acnt,wn;
  longint bm,lt,rt,tp,page;
  real h,h2,h3,h4,v;
  record IVVc IVr;
  record LocalMachineBlock LMb;
  record POSButtonsVc POSBr;
  string 255 bc1,bc2,compname,lmc,nr,sessdesc,sm;
  time tt;

  BlockLoad(LMb);    
    wn = CurWindow;
    GetScreenSize(wn,tp,lt,bm,rt);
    switch (GuiType) begin
      case kGuiCocoa:      
        bm = bm - 80;
      case kGuiGDI:
        tp = tp + 30;
        bm = bm - 40;
        rt = rt - 55;
        lt = lt - 45;
      case kGuiWPF:
        tp = tp + 30;
        bm = bm - 40;
        rt = rt - 55;
        lt = lt - 45;
    end;
    
    page = StringToInt(GetWindowString(wn,"touchscreenwindowpage"));
    if (page<1) then begin
      page = 1;
    end;
    ReadPOSButtons("IVDClass",LMb.POSButtonGroup,page,bc1,bc2,compname,POSBr);
    SetWRect(lt,tp,rt,bm); 
    BrowseButtons(false);
    Sizeable(-1,-1,0,0);
    BrowseButtons(false);
    DynamicWindow;
    UseView(IVVc);
    ActiveFieldOnNew("ivcashcommand");
    ToolBar;
//    PushButton(-340,5,-340 + 34,5+18,ToolPasteSpec,"v");
    EndToolBar;
    
    v = 20;
    h = -300; h2 = -150; h3 = -70; h4 = -10;
    
    wn = CurWindow;
    if (wn>0) then begin
      switch (GetWindowClass(wn)) begin
        case "IVDClass":
          GetWindowRecord(wn,IVr);
      end;
    end;
    td = IVr.TransDate;
    if (blankdate(td)) then begin td = CurrentDate; end;
    tt = IVr.TransTime;
    if (blanktime(tt)) then begin tt = CurrentTime; end;
    lmc = IVr.MachineName;
    if (blanktime(lmc)) then begin lmc = LMb.LocalMachineCode; end;
    sm = IVr.SalesMan;
    if (blanktime(sm)) then begin sm = CurrentUser; end;
    nr = "Invoice: ";
    if (IVr.SerNr>0) then begin
      nr = nr & IVr.SerNr;
    end;

    sessdesc = "Discount: " & IVr.RebCode;
      
      
    DisplayRecordDetails_ENG(10,26,compname,td,tt,lmc,sm,nr,IVr.CustCode,IVr.Addr0,"","","","","",IVr.LoyaltyCardNr,LMb.ShowBaggerSupervisor,"","","",blankval,sessdesc,true,IVr.OfficialSerNr,"");
    
    if (bm<650) then begin
      SoftEditFieldTLX(360,6,h4,"",M4Str,ViewOnly,100,20,patM4black,"CustomerDisplayData_Line1",true,0);
      SoftEditFieldTLX(360,36,h4,"",M4Str,ViewOnly,100,30,patM4black,"CustomerDisplayData_Line2",true,0);
    end else begin
      SoftEditFieldTLX(360,6,h4,"",M4Str,ViewOnly,100,30,patM4black,"CustomerDisplayData_Line1",true,0);
      SoftEditFieldTLX(360,46,h4,"",M4Str,ViewOnly,100,50,patM4black,"CustomerDisplayData_Line2",true,0);
    end;
    
    
    
    HalPushButton(20,350,150,680,"IVDClassUpdateWebBrowser","Show item picture");
    SoftEditFieldTLX(20,380,650,"",M4Str,ViewOnly,100,10,patM4black,"CustomerDisplayData_Line3",false,0);
   	WebPage(20,400,700,-80,"$subset","");
    //WebPage(20,700,390,-80,"$HWStore","");
    switch (LMb.POSButtonsPosition) begin
      case kPOSButtonsPositionLeft:
        SoftEditField(110,-22,200,"Item/Command"  ,Normal ,"ivcashcommand",false,INSClass,M4Str,255);
      case kPOSButtonsPositionRight:
        SoftEditField(-260,-22,200,"Item/Command"  ,Normal ,"ivcashcommand",false,INSClass,M4Str,255);
    end;
    
    EditField(360,116,-10,"Comment",Normal,InvComment,false,0);
    
    SoftEditField(2000,-22,200,""  ,Normal ,"ivcashcommandlastitemsernrf",false,0,M4Str,255);        
    DrawPOSInterface_ENG(bc1,bc2,POSBr,acnt,"",100);
    BottomBar;
    SpecialMenu("Paste products from moving",'B',6,"PasteStoclMovToIVsm");
end;
  EndWindow;
end;
*/
window ImportImagesVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("Import Images To IN",ImportImagesVClass,CGMnt,RcType);
  SetWRect(20,80,400,240);
  vs = 20;h = 130; v = 26;
  
  EndWindow;
end;


window INSClass:4
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer,android,iPad,iPhone")
begin
  real v;
  Integer icn;

  icn = StringToInt(USetStr(912));
  WindowBegin("Paste Item",INSClass,CGslist,-);
  Sizeable(-1,-1,0,0);
  UseView(INVc);
  SpawnClass(INDClass);
  if (GuiType==kGuiAndroid) then begin
    SetWRect(0,0,320,418);
    WindowTitleBar(6002,icn,6003,"Paste Item");
    RecordList(0,0,-1,-1);
    RLCellKey(0,12,280,12,Code,false,kFontSizeLarge,patM4curpen,Code);
    RLCell(0,56,80,56,Group,false,kFontSizeSmall,patM4curpen);
    RLCell(80,56,280,56,Name,false,kFontSizeSmall,patM4curpen);
    RLCell(-50,56,-1,56,UPrice1,false,kFontSizeSmall,patM4curpen);
  end else begin
    if (GuiType==kGuiiPhone) then begin
      RecordList(4,17,-21,-39);
      RLCellKey(10,6,150,19,Code,false,12,patM4blue,Code);
      RLCell(210,6,280,19,Group,false,12,patM4black);
      RLCell(10,26,150,39,Name,false,12,patM4black);
      RLCell(210,26,280,39,UPrice1,false,12,patM4black);
    end else begin
      v = 0;
      if (GuiType==kGuiCocoa) then begin
        SetWRect(210,80,850,498);
        FlowView(0,0,-1,200);
        v = v+200;
      end else begin
        SetWRect(210,80,850,298);
      end;
      RecordList(4,v+17,-21,-39);
      RlColKey(4,4,"No.",Code,false,ActCode);
      if (HasModIN) then begin
        RlColKey(105,105,"Group",Group,false,ActGroup);
        RlColKey(160,160,"Description",Name,false,ActName);
      end else begin
        RlColKey(105,105,"Description",Name,false,ActName);
      end;
      if (IsEnterprise) then begin
        RlColKey(-250,-250,"Alt. Code",AlternativeCode,false,ActAlternativeCode);
      end;
      if (IsEnterprise) or (HasModIN) then begin
        RlCol(-120,-120,"Base Price",UPrice1,true);
      end else begin
        RlCol(-120,-120,"Price",UPrice1,true);
      end;
      if (IsEnterprise) then begin
        CalculatedColumn(-50,-50,"In #Stock#","INSClassInStock",true);
      end;
      SearchField("Search");
      if (HasModIN) then begin
        if (UserCanReport("INInfoRn","",true)) then begin
          SpecialMenu("Item Status Report",'I',0,"INStatusINSsm");
        end;
      end;
      if (IsEnterprise) then begin
        SpecialMenu("Search",'F',1,"INSearchSsm");
        SpecialMenu("Alternative Items",'l',2,"AltItemINSsm");
        SpecialMenu("Cross Sales Items",'r',2,"CrossItemINSsm");
      end;
    end;
    SearchField("Search");
  end;
  EndWindow;
end;

window NPTSCashPaymentTClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  array boolean achangecrncyf;
  array string 255 acrncy;
  integer acrncnt,i,typ;
  real f,h,h2,h3,h4,hm,l,v,v3,vm,vs;
  WindowBegin("Cash Payment",NPTSCashPaymentTClass,CGother,RcType);
  AutoSizeWindow(false);
  DynamicWindow;
  CntPOSCurrencies(acrncy,achangecrncyf,acrncnt);
  if (acrncnt<2) then begin acrncnt = 2; end;

//  Modality(1);
  UseView(RcVc);
  SetWRect(80,200,950,430+acrncnt*30);
//  Sizeable(-1,-1,0,0);
  h = 120; h2 = 170; v=40; vs = 30;
  h = 40; f = 70;
  v = 30;
  StaticText(h,v,"Currency",false);
  StaticText(h+=60,v,"Total Due",false);
  StaticText(h+=120,v,"Amount Due",false);
  StaticText(h+=120,v,"Amount Tendered",false);
  StaticText(h+=120,v,"Change Given",false);
  StaticText(h+=120,v,"Change Due",false);
  v = v + 10;

  for (i=0;i<acrncnt;i=i+1) begin
    h = 40;
    StaticText(h,v+14,acrncy[i],false);
    SoftEditFieldTLX(h+=60,v,f=110,"",M4Str,ViewOnly,100,20,patM4black,"NPTSCashPaymentTotalDue" & i,true,0);
    SoftEditFieldTLX(h+=120,v,f,"",M4Str,ViewOnly,100,20,patM4black,"NPTSCashPaymentCashAmountDue" & i,true,0);
    SoftEditFieldTLX(h+=120,v,f,"",M4Str,Normal,100,20,patM4black,"NPTSCashPaymentCashReceived" & i,true,0);
    typ = ViewOnly;
    if (achangecrncyf[i]) then begin
      typ = Normal;
    end;
    SoftEditFieldTLX(h+=120,v,f,"",M4Str,Normal,100,20,patM4black,"NPTSCashPaymentChangeGiven" & i,true,0);
    SoftEditFieldTLX(h+=120,v,f,"",M4Str,ViewOnly,100,20,patM4black,"NPTSCashPaymentChangeDue" & i,true,0);
    v = v + vs;
    if (HasMultiCurrency==false) then begin
      if (i==0) then begin
        i = acrncnt;
      end;
    end;
  end;
/*
  h = 40;
  EditFieldTL(h,v+=10, 30,"Base",M4Str,ViewOnly,5,CurncyCode,false,0);
  h = h + 70;
  SoftEditField(h+=90,v,f,"",ViewOnly ,"NPTSCashPaymentCashAmountDueTotal",true,0,M4Str,255);
  SoftEditField(h+=100,v,100,"",ViewOnly ,"NPTSCashPaymentCashReceivedTotal",true,0,M4Str,255);
  SoftEditField(h+=120,v,100,"",ViewOnly ,"NPTSCashPaymentChangeGivenTotal",true,0,M4Str,255);
  SoftEditField(h+=120,v,f,"",ViewOnly ,"NPTSCashPaymentChangeDueTotal",true,0,M4Str,255);
*/
  h = 40;
  v = v + 10;
  if (HasMultiCurrency) then begin
    EditFieldTL(h,v, 30,"Base",M4Str,ViewOnly,5,CurncyCode,false,0);
  end;
  h = h + 40;
  SoftEditFieldTLX(h+=120,v,f=110,"",M4Str,ViewOnly,100,15,patM4black,"NPTSCashPaymentCashAmountDueTotal",true,0);
  SoftEditFieldTLX(h+=120,v,f,"",M4Str,ViewOnly,100,15,patM4black,"NPTSCashPaymentCashReceivedTotal",true,0);
  SoftEditFieldTLX(h+=120,v,f,"",M4Str,ViewOnly,100,15,patM4black,"NPTSCashPaymentChangeGivenTotal",true,0);
  SoftEditFieldTLX(h+=120,v,f,"",M4Str,ViewOnly,100,15,patM4black,"NPTSCashPaymentChangeDueTotal",true,0);

  v = 10; h2 = 55; v3 = 48; vs = 52;
  ColourPushButton(-550,v+4*vs,-550+3*h2,v+4*vs+v3,"CancelNPTSCashPaymentTClass","Cancel<BR>F2",20);
  ColourPushButton(-370,v+4*vs,-370+3*h2,v+4*vs+v3,"ProceedNPTSCashPaymentTClass","Proceed<BR>F1",20);
  
  /*h3 = 210; h4 = 400; v = 10; hm = 680;

  vm = -160; l = 57;
  v = 10;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad1","1_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad2","2_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad3","3_",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad4","4_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad5","5_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad6","6_",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad7","7_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad8","8_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad9","9_",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyDel","Del",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad0","0_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"IVDClassToolKeyPadPoint",".",2);
  v = v+vs;
  h = hm; ColourPushButton(h,v,h+3*h2,v+v3,"NPTSPaymentToolKeyEnter","Enter",2);*/
  EndWindow;
end;

window PricePointListDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,t,v,vs;
  WindowBegin("Price Point Sheet",PricePointListDClass,CGview,AT2RevView);
  SetWRect(20,80,512,639);
  UseView(PricePointListVc);
  vs = 20; h=50; h1=100; h2=220;
  EditField(h=30,v=10, 70, "No.",Normal,SerNr,false,0);
  EditField(h+150,v, 82, "Date",Normal,TransDate,false,PasteCurDate);
  CheckBox(-100,v,0,"",OKFlag);
  CheckBox(-100,v+=20,0,"Closed",Closed);
  
  MatrixBegin(3,v+=40,-20,-20,0,1599);
  //MatCol(t=1,32,"Num",0,Num,false,0);
  MatCol(t=1,32,"Cost",0,Cost,false,0);
  MatCol(t,150,"Price",0,Price,true,0);
  EndMatrix;
  EndWindow;
end;

window PricePointListLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Price Point Sheet",PricePointListLClass,CGmlist,RcType);
  SetWRect(20,80,509,298);
  SpawnClass(PricePointListDClass);
  Sizeable(-1,-1,0,0);
  UseView(PricePointListVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"SerNr",SerNr,false,SerNr);
  RlColKey(81,81,"Date",TransDate,false,TransDate);
  SearchField("Search");
  EndWindow;
end;

window INDClass:8
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  integer tilenr;
  real h,h1,h2,h3,h4,h5,v,vm,vs;
  string 255 label;
  WindowBegin("Item",INDClass,CGview,-);
  SetWRect(20,80,800,400);
  Sizeable(-1,-1,-1,0);
  DynamicWindow;
  UseView(INVc);
  Tile(0,87,false,"",Code); 
  v = 6; vs = 20; h = 155; h1 = 300; h2 = 385; h3 = 395; h4 = 285; h5 = 433;
  EditField(h,v, 150,"No.",Normal,Code,false,0);
  EditField(h2,v,80,"Group",Normal,Group,false,ITSClass);
  EditField(h,v+=vs,-40,"Description(ENG)",Normal,Name,false,0); //Edit***************************Sasha2,15:18 03.12.2014
  tilenr = 1;
  TileButton(tilenr,"Pricing"); tilenr = tilenr + 1;
  //if (UserCanAction("AllowJewelleryInterface",false)) then begin
    TileButton(tilenr,"Jewellery"); tilenr = tilenr + 1; 
    TileButton(tilenr,"Watch"); tilenr = tilenr + 1;
  //end;
  TileButton(tilenr,"#Stock#"); tilenr = tilenr + 1;
  TileButton(tilenr,"Warehouse"); tilenr = tilenr + 1;
  if (UserCanAction("ViewCostPrice",true)) then begin
    TileButton(tilenr,"Costs"); tilenr = tilenr + 1;
  end;
  TileButton(tilenr,"Recipe"); tilenr = tilenr + 1;
  TileButton(tilenr,"A/C"); tilenr = tilenr + 1;
  if (GuiType==kGuiiPhone) then begin
    TileButton(tilenr,"Image"); tilenr = tilenr + 1;
  end;
  TileButton(tilenr,"Varieties"); tilenr = tilenr + 1;
  TileButton(tilenr,"Texts"); tilenr = tilenr + 1;
  TileButton(tilenr,"Cost Model"); tilenr = tilenr + 1;
  //TileButton(tilenr,"User Values");
  tilenr = 1;
  CheckBox(h,v+=vs,0,"Closed",Terminated);
  CheckBox(h2,v,0,"Not For Sales",NotForSales);
  Tile(tilenr,209,false,tilenr,Unittext); tilenr = tilenr + 1;
  EditField(h,v=6 ,100,"Unit",Normal,Unittext,false,UnitSClass);
  if (UserCanAction("AllowJewelleryInterface",false)) and (UserCanAction("ViewCostPrice",true)) then begin
    //EditField(h,v+=vs,100,"",Normal,InPrice,true,0); 
  end;
  EditField(h,v+=vs,100,"Base Price",Normal,UPrice1,true,0);
  EditField(h,v+=vs,100,"Base Price Change",ViewOnly,LastBasePriceChange,true,0);
  EditField(h,v+=vs,100,"Price Factor",Normal,PriceFactor,true,0);
  EditField(h,v+=vs,100,"Item Formula",Normal,CalcPrice,false,CPMSClass);
  EditField(h,v+=vs,100,"Markup %",Normal,Markup,true,0);
  EditField(h,v+=vs,100,"Bonus %",Normal,Bonus,true,0);
  EditField(h,v+=vs,-240,"Objects",Normal,Objects,false,ObjSClass);
  EditField(h,v+=vs,-240,"Classification",Normal,DispGroups,false,DISClass);
  ButtonFrame(h1,v=24,130,4,"Item Type");
  RadioButton(h1,v,kItemTypePlain,0,"Plain",ItemType);
  RadioButton(h1,v+=16,kItemTypeStocked,0,"#Stocked# Item",ItemType);
  RadioButton(h1,v+=16,kItemTypeStructured,0,"Structured Item",ItemType);
  RadioButton(h1,v+=16,kItemTypeService,0,"Service",ItemType);
  
  // Edit Start ---------------------------------------------- Edit Start
	//Wednesday, 17 December 2014 12:44:51
	 
  ButtonFrame(h1+150,v=24,130,3,"Item Type");
  RadioButton(h1+150,v,0,0,"Common",ConsgType);
  RadioButton(h1+150,v+=16,1,0,"Consigment",ConsgType);
  RadioButton(h1+150,v+=16,2,0,"LowCost",ConsgType);
  EditField(h1+150,v+56 ,50,"Purch Acc",Normal,PurchAcc,false,AccSClass);
	// Edit End ---------------------------------------------- Edit End
  
  Pict_Field(-205,8,-35,178,"");
  if (GuiType==kGuiCocoa) then begin
    PushButton(-190,182,-50,202,ToolImagePicker,"Add picture");//##cc  
  end;
  CheckBox(h1,v+=32,0,"Treat Item as Material on Project",ItemMaterial);
  //if (UserCanAction("AllowJewelleryInterface",false)) then begin
    Tile(tilenr,110,false,tilenr,-); tilenr = tilenr + 1;
			EditField(h,v=6, 140,"Metal",Normal,Metal,false,0);
			EditField(h,v+=vs, 140,"Weight",Normal,RowWeight,false,0);
			EditField(h,v+=vs, 140,"Size",Normal,Size,false,0);
			EditField(h,v+=vs, 140,"Length",Normal,Length,false,0);
			EditField(h,v+=vs, 140,"Reference",Normal,Reference,false,0);
			v = 6; 
			EditField(h5+50,v, 140,"Major Stone Detail",Normal,MajStoneDet,false,0);
			EditField(h5+50,v+=vs, 140,"#Colour#",Normal,Colour,false,0);
			EditField(h5+50,v+=vs, 140,"Clarity",Normal,Clarity,false,0);
			EditField(h5+50,v+=vs, 140,"Certificate",Normal,Cert,false,0);
			EditField(h5+50,v+=vs, 140,"Minor Stone Detail",Normal,MinStoneDet,false,0);
			Tile(tilenr,90,false,tilenr,WatchBrand); tilenr = tilenr + 1;
			EditField(h,v=6, 140,"Watch Brand",Normal,WatchBrand,false,0);
			EditField(h,v+=vs, 140,"Style Name",Normal,StyleName,false,0);
			EditField(h,v+=vs, 140,"Watch Metal",Normal,WatchMetal,false,0);
			EditField(h,v+=vs, 140,"Movement",Normal,Movement,false,0);
			v = 6; 
			EditField(h5,v, 140,"Bracelet/Strap",Normal,BrcStr,false,0);
			EditField(h5,v+=vs, 140,"Gender",Normal,Gender,false,0);
			EditField(h5,v+=vs, 140,"Other",Normal,Other,false,0);
			EditField(h5,v+=vs, 140,"Other2",Normal,Other2,false,0); 
  //end;
  Tile(tilenr,170,false,tilenr,MinLevel);  tilenr = tilenr + 1; // Need to clean this Tile up!
  v = 6;
  vm = v;
  ButtonFrame(h1,v+=14,143,3,"Serial Number Tracking");
  RadioButton(h1,v,0,0,"None",SerNrf);
  RadioButton(h1,v+=16,1,0,"Unit Number",SerNrf);
  RadioButton(h1,v+=16,2,0,"Batch Number",SerNrf);
  CheckBox(h1+200,v,0,"Do not Require Batch No. on POS Invoice",DonotRequireBatchNrOnIVCash);
  EditField(h,v=6,100,"Minimum Level",Normal,MinLevel,true,0);
  EditField(h,v+=vs,100,"Maximum Level",Normal,MaxLevel,true,0);
  EditField(h,v+=vs  ,100,"Department",Normal,Department,false,DepSClass);
  EditField(h,v+=vs  ,100,"Shelf Code",Normal,InvCode,false,0);
  EditField(h,v+=vs,100,"Default Source",Normal,DefaultSource,false,SourceSClass);  
  EditField(h5,v ,50,"Environment Tax per Kilo",Normal,RepaPricePerWeight,true,0);
  EditField(h,v+=vs ,100,"Hazard Level",Normal,HazLevCode,false,HazLevSClass);
  EditField(h5,v ,50,"Alcohol %",Normal,AlcPrc,true,0);
  EditField(h,v+=vs ,100,"Unit 2",Normal,Unittext2,false,UnitSClass);
  EditField(h5,v ,50,"Conversion 1",Normal,Conversion1,true,0);
  EditField(h,v+=vs,100,"Unit Coefficient",Normal,UnitCoefficient,true,0);
  EditField(h5,v ,50,"Conversion 2",Normal,Conversion2,true,0);
  Tile(tilenr,170,false,tilenr,LocArea);  tilenr = tilenr + 1;
  EditField(h,vm=(v=6) ,100,"Default Pallet Item",Normal,DefPalletItem,true,INSClass);
  EditField(h5,v ,80,"Picking Area",Normal,PickArea,false,LocAreaSClass);
  EditField(h,v+=vs ,100,"Default Location Area",Normal,LocArea,false,LocAreaSClass);
  EditField(h5,v ,50,"Pallets In Picking Area",Normal,PalletsInPickArea,true,0);
  EditField(h,v+=vs ,50,"Max. Qty on Pallet",Normal,QtyonPallet,true,0);
  EditField(h4,v ,50,"Pallet Layers",Normal,PalletLayers,true,0);
  EditField(h5,v ,50,"Qty per Layer",Normal,QtyonPalletLayer,true,0);
  EditField(h,v+=vs ,50,"Full Pallet Width",Normal,PalletWidth,true,0);
  EditField(h4,v ,50,"Height",Normal,PalletHeight,true,0);
  EditField(h5,v ,50,"Depth",Normal,PalletDepth,true,0);
  EditField(h,v+=vs ,50,"Default Position Width",Normal,DefPosWidth,true,0);
  EditField(h4,v ,50,"Height",Normal,DefPosHeight,true,0);
  EditField(h5,v ,50,"Depth",Normal,DefPosDepth,true,0);
  EditField(h,v+=vs ,50,"Item Width",Normal,Width,true,0);
  EditField(h4,v ,50,"Height",Normal,Height,true,0);
  EditField(h5,v ,50,"Depth",Normal,Depth,true,0);
  EditField(h,v+=vs ,50,"Item Volume",Normal,Volume,true,0);
  EditField(h4,v ,50,"Density",Normal,Density,true,0);
  EditField(h5,v ,50,"Net Weight",Normal,NetWeight,true,0);
  EditField(h5,v+=vs ,50,"Weight",Normal,Weight,true,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
  Tile(tilenr,190,false,tilenr,InPrice);  tilenr = tilenr + 1;
  EditField(h+38,vm=(v=6),100,"Cost Price",Normal,InPrice,true,0); //##cc
	EditField(h5,v,70,"Cost Price Change",ViewOnly,LastPriceChange,true,0);
  EditField(h+38,v+=vs ,100,"Cost Price in Base 2",Normal,InPriceB2,true,0);
  ButtonFrame(h1,v+=24,264,4,"Upd. Cost Price at Goods Receipt");
  RadioButton(h1,v,0,0,"No",UpdateCost);
  RadioButton(h1,v+=16,1,0,"Last Purchase Cost (incl. extras)",UpdateCost);
  RadioButton(h1,v+=16,2,0,"Weighted Average",UpdateCost);
  RadioButton(h1,v+=16,3,0,"Last Purchase Cost (excl. extras)",UpdateCost);
  ButtonFrame(h5=580,v=v-3*16,200,3,"Upd. Cost Price at #Stock# Revaluation"); //##cc
RadioButton(h5,v,0,0,"No",SRUpdateCost);
  RadioButton(h5,v+=16,1,0,"Last Revaluation Cost",SRUpdateCost);
  RadioButton(h5,v+=16,2,0,"Weighted Average",SRUpdateCost);
  EditField(h+38,v=vm+2*vs,100,"Extra Cost",Normal,ExtraCost,true,0);
  EditField(h+38,v+=vs ,100,"Weighted Average",Normal,WeighedAvPrice,true,0);
  EditField(h+38,v+=vs ,100,"Weighted Av., Base 2",Normal,WeighedAvPriceB2,true,0);
  EditField(h+38,v+=vs ,100,"Last Pur. Cost (incl. extras)",Normal,LastPurchPrice,true,0);
  EditField(h+38,v+=vs ,100,"Last Pur. Price (excl. extras)",Normal,LastPurchPrice2,true,0);
  EditField(h+38,v+=vs ,100,"Last Purchase Currency",Normal,LastPurchCurncyCode,false,CurncyCodeSClass);
  EditField(h+38,v+=vs ,100,"Fixed Freight",Normal,FixedFreight,true,0);
  CheckBox(h1,v,0,"Include Item Fixed Charge",InclItemFreight);
  end;
  Tile(tilenr,170,false,tilenr,Recepy);  tilenr = tilenr + 1;
  EditField(h,v=6 ,120,"Recipe",Normal,Recepy,false,RecSClass);
  CheckBox(h1,v,0,"Paste Components during Entry",ExplodeRec); // "Show components on documents" is better English but VERY confusing
  EditField(h,v+=vs ,120,"Invoice Recipe",Normal,InvRecepy,false,RecSClass);
  EditField(h2,v,150,"Barcode",Normal,BarCode,false,0);
  EditField(h,v+=vs ,120,"Contract Item",Normal,ContractItem,false,INSClass);
  EditField(h2,v,150,"Commodity Code",Normal,EUCodex,false,CommoditySClass);
  EditField(h,v+=vs ,120,"Rental Invoicing",Normal,RentalItem,false,INSClass);
  EditField(h2,v,150,"EKN Code",Normal,EKNCode,false,0); // i think it is same as Commodity Code
  EditField(h2,v+=vs,150,"PKWiU Code",Normal,CPSCode,false,0);//Edited **** // 	// Edit by Victor 02.12.14
  EditField(h,v+=vs ,120,"Warranty Months",Normal,WarrantyLength,true,0);
  EditField(h2,v,150,"#Colour#",Normal,colnr,false,SetSClass);
  EditField(h,v+=vs,-40,"Alternative Code",Normal,AlternativeCode,false,0);
  EditField(h,v+=vs,-40,"Warning",Normal,WarnText1,false,0);
  Tile(tilenr,170,false,tilenr,SalesAcc);  tilenr = tilenr + 1;
  v = 6;
  vm = v;
  EditField(h,vm,55,"#Dom.# Sales A/C",Normal,SalesAcc,false,AccSClass);
  EditField(h,v+=vs,55,"Sales A/C",Normal,EUSalesAcc,false,AccSClass);
  EditField(h,v+=vs,55,"Export Sales A/C",Normal,ExpSalesAcc,false,AccSClass);
  EditField(h,v+=vs,55,"Serv. Invble Sales A/C",Normal,SVOInvbleSalesAcc,false,AccSClass);
  EditField(h,v+=vs,55,"Serv. Warranty Sales A/C",Normal,SVOWarrantySalesAcc,false,AccSClass);
  EditField(h,v+=vs,55,"Serv. Contract Sales A/C",Normal,SVOContractSalesAcc,false,AccSClass);
  EditField(h,v+=vs,55,"Serv. Goodwill Sales A/C",Normal,SVOGoodwillSalesAcc,false,AccSClass);

  EditField(h,v+=vs,55,"Components Usage",Normal,CompUsage,false,AccSClass);

  EditField(h2=360,v=vm,55,"#Dom.# Cost A/C",Normal,CostAcc,false,AccSClass);
  EditField(h2,v+=vs,55,"Cost A/C",Normal,EUCostAcc,false,AccSClass);
  EditField(h2,v+=vs,55,"Export Cost A/C",Normal,ExpCostAcc,false,AccSClass);
  EditField(h2,v+=vs,55,"Serv. Invble Cost A/C",Normal,SVOInvbleCostAcc,false,AccSClass);
  EditField(h2,v+=vs,55,"Serv. Warranty Cost A/C",Normal,SVOWarrantyCostAcc,false,AccSClass);
  EditField(h2,v+=vs,55,"Serv. Contract Cost A/C",Normal,SVOContractCostAcc,false,AccSClass);
  EditField(h2,v+=vs,55,"Serv. Goodwill Cost A/C",Normal,SVOGoodwillCostAcc,false,AccSClass);
  EditField(h2,v+=vs,55,"Hotel WIP A/C",Normal,HotelWIPAcc,false,AccSClass);

  EditField(h2=530,v=vm,20,"#Dom.# #VAT# Code",Normal,VATCode,false,VATCodeSClass);
  EditField(h2,v+=vs,20,"#VAT# Code",Normal,VATCodeEU,false,VATCodeSClass);
  EditField(h2,v+=vs,20,"Export #VAT# Code",Normal,VATCodeExp,false,VATCodeSClass);
  CheckBox(h2,v+=20,0,"Calculate Perception Taxes",Perceptions);
  CheckBox(h2,v+=16,0,"Calculate Withholdings Taxes",Withholdings);
  EditField(h2=670,v=vm,50,"#Dom.# Tax Temp.",Normal,TaxTemplateCode,false,TaxTemplateSClass);
  EditField(h2,v+=vs,50,"Tax Temp.",Normal,TaxTemplateCodeEU,false,TaxTemplateSClass);
  EditField(h2,v+=vs,50,"Export Tax Temp.",Normal,TaxTemplateCodeExp,false,TaxTemplateSClass);
  if (GuiType==kGuiiPhone) then begin
    Tile(tilenr,70,false,tilenr,-);  tilenr = tilenr + 1;
    AttachmentDisplay(10,10,200,200);
//    PushButton(30,10,-80,40,ToolImagePicker,"Take picture");
//    ControlLabel(0,0,0,0,"Take picture","SystemFont",17,kTextStyleBold,AdjCenter,patM4ReportsTextBlue);
  end;
  Tile(tilenr,70,false,tilenr,VARMask);  tilenr = tilenr + 1;
  EditField(h,v=6,-40,"Variety Mask",Normal,VARMask,false,VARMasksSClass);
  EditField(h,v+=vs,-40,"Report Order",Normal,VARRepOrder,false,VARMasksSClass);
  EditField(h,v+=vs,-40,"Subsets",Normal,VARSubsets,false,VARSubsetsSClass);
  Tile(tilenr,120,true,tilenr,Math);  tilenr = tilenr + 1;
  v = 24;
  MatrixBegin(4,v,-32,-40,-,99);
  MatCol(1,24,"Language",0,LangCode,false,LangSClass);
  MatCol(1,94,"Description",0,Text,false,0); //Edit***************************Sasha2,17:37 01.12.2014
  MatCol(1,300,"Specification",0,Description,false,0); //Edit***************************Sasha2,17:37 01.12.2014
  MatCol(1,-200,"Technical parameters",0,Technical,false,0); //Edit***************************Sasha2,17:36 01.12.2014
  EndMatrix;
  Tile(tilenr,220,false,tilenr,CostPerc);  tilenr = tilenr + 1;
  ButtonFrame(h=100,vm=(v=20),230,6,"Primary Cost Model");
  RadioButton(h,v,0,0,"Default",PrimaryCostModel);
  RadioButton(h,v+=16,1,0,"Cost Price",PrimaryCostModel);
  RadioButton(h,v+=16,2,0,"% _of Base Price",PrimaryCostModel);
  EditField(h+150,v,55,"%",Normal,CostPerc,true,0);
  RadioButton(h,v+=16,3,0,"Weighted Average",PrimaryCostModel);
  RadioButton(h,v+=16,4,0,"Queued",PrimaryCostModel);
  RadioButton(h,v+=16,kCostModelNoneItem,0,"None",PrimaryCostModel);
  ButtonFrame(h,v+=40,230,3,"Queued Cost Model");
  RadioButton(h,v,0,0,"Default",QueuedCostModel);
  RadioButton(h,v+=16,1,0,"F_IFO Price",QueuedCostModel);
  RadioButton(h,v+=16,2,0,"LIFO Price",QueuedCostModel);  
  
	ButtonFrame(h2=380,v=vm,250,3,"Cost Price for Serial Number");
  RadioButton(h2,v,0,0,"Default",FIFOPerSerialNr);
  RadioButton(h2,v+=16,1,0,"Cost Price not for Serial Number",FIFOPerSerialNr);
  RadioButton(h2,v+=16,2,0,"Cost Price for Serial Number",FIFOPerSerialNr);  
  ButtonFrame(h2,v+=40,250,3,"Queued Cost Model per Location");
  RadioButton(h2,v,0,0,"Default",FIFOPerLocation);
  RadioButton(h2,v+=16,1,0,"Queued Cost not per Location",FIFOPerLocation);
  RadioButton(h2,v+=16,2,0,"Queued Cost per Location",FIFOPerLocation);  
  ButtonFrame(h2,v+=40,250,3,"WA per Location");
  RadioButton(h2,v,0,0,"Default",WAPerLocation);
  RadioButton(h2,v+=16,1,0,"WA not per Location",WAPerLocation);
  RadioButton(h2,v+=16,2,0,"WA per Location",WAPerLocation);  
  
 if (UserCanReport("INInfoRn","",true)) then begin
    SpecialMenu("Item Status Report",'I',0,"INStatusINDsm");
  end;
  SpecialMenu("Create Purchase Item",' ',1,"PIFromINDsm");
  SpecialMenu("Create Recipe",' ',2,"RecFromINDsm");
//  SpecMenuItem("Recalculate Price List",' ',2);
  if (UserCanReport("INrsRn","INrsRClass",true)) then begin
    SpecialMenu("Item History",'h',3,"INHistINDsm");//CMD H DOES HIDE HANSA
  end;
  SpecialMenu("Item Location Status",' ',4,"LocItemStatDsm");
  SpecialMenu("Print price lable",' ',5,"DoPrintLablDsm");// Edit ************************** Tuesday, 27 May 2014 10:45:08
  if (UserCanAction("AllowJewelleryInterface",false)) and (UserCanReport("INInfoRn","",true)) then begin 
   // SpecialMenu("   . ",'S',5,"ItemStatusAltINDsm");
  end;
  EndWindow;
end;

window cutINDClass:8
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  integer tilenr;
  real h,h1,h2,h3,h4,h5,v,vm,vs;
  string 255 label;
  WindowBegin("Item",cutINDClass,CGview,-);
  SetWRect(20,80,830,400);//##cc
  Sizeable(-1,-1,-1,0);
  DynamicWindow;
  UseView(INVc);
  Tile(0,87,false,"",Code); 
  v = 6; vs = 20; h = 155; h1 = 300; h2 = 385; h3 = 395; h4 = 285; h5 = 433;
  EditField(h,v, 150,"No.",VIewOnly,Code,false,0);
  EditField(h2,v,80,"Group",VIewOnly,Group,false,ITSClass);
  EditField(h,v+=vs,-40,"Description",VIewOnly,Name,false,0);
  tilenr = 1;
  TileButton(tilenr,"Pricing"); tilenr = tilenr + 1;
  TileButton(tilenr,"Stock"); tilenr = tilenr + 1;
  TileButton(tilenr,"Recipe"); tilenr = tilenr + 1;
 
  tilenr = 1;
  
  Tile(tilenr,209,false,tilenr,Unittext); tilenr = tilenr + 1;
  EditField(h,v=6 ,100,"Unit",VIewOnly,Unittext,false,UnitSClass);
  EditField(h,v+=vs,-240,"Classification",VIewOnly,DispGroups,false,DISClass);
  
  Tile(tilenr,170,false,tilenr,MinLevel);  tilenr = tilenr + 1; // Need to clean this Tile up!
  v = 6;
  vm = v;
EditField(h,v+=vs  ,100,"Department",Normal,Department,false,DepSClass);
  EditField(h,v+=vs  ,100,"Shelf Code",Normal,InvCode,false,0);
  EditField(h5,v ,80,"Picking Area",Normal,PickArea,false,LocAreaSClass);
  EditField(h,v+=vs ,100,"Default Location Area",Normal,LocArea,false,LocAreaSClass);
  EditField(h5,v ,50,"Pallets In Picking Area",Normal,PalletsInPickArea,true,0);
  EditField(h,v+=vs ,50,"Max. Qty on Pallet",Normal,QtyonPallet,true,0);
  EditField(h4,v ,50,"Pallet Layers",Normal,PalletLayers,true,0);
  EditField(h5,v ,50,"Qty per Layer",Normal,QtyonPalletLayer,true,0);
  EditField(h,v+=vs ,50,"Full Pallet Width",Normal,PalletWidth,true,0);
  EditField(h4,v ,50,"Height",Normal,PalletHeight,true,0);
  EditField(h5,v ,50,"Depth",Normal,PalletDepth,true,0);
  EditField(h,v+=vs ,50,"Default Position Width",Normal,DefPosWidth,true,0);
  EditField(h4,v ,50,"Height",Normal,DefPosHeight,true,0);
  EditField(h5,v ,50,"Depth",Normal,DefPosDepth,true,0);
  EditField(h,v+=vs ,50,"Item Width",Normal,Width,true,0);
  EditField(h4,v ,50,"Height",Normal,Height,true,0);
  EditField(h5,v ,50,"Depth",Normal,Depth,true,0);
  EditField(h,v+=vs ,50,"Item Volume",Normal,Volume,true,0);
  EditField(h4,v ,50,"Density",Normal,Density,true,0);
  EditField(h5,v ,50,"Net Weight",Normal,NetWeight,true,0);
  EditField(h5,v+=vs ,50,"Weight",Normal,Weight,true,0);
 
  Tile(tilenr,170,false,tilenr,Recepy);  tilenr = tilenr + 1;
  v = 6;
  EditField(h,v,150,"Barcode",VIewOnly,BarCode,false,0);
  EditField(h,v+=vs,-40,"Alternative Code",VIewOnly,AlternativeCode,false,0);
    
  if (UserCanReport("INInfoRn","",true)) then begin 
  SpecialMenu("Item Status Report",'I',0,"INStatusINDsm");
  end;
  if (UserCanReport("INrsRn","INrsRClass",true)) then begin 
  SpecialMenu("Item History",'h',3,"INHistINDsm");
  end;
  SpecialMenu("Item Location Status",' ',4,"LocItemStatDsm");
  SpecialMenu("Print lable",' ',5,"DoPrintLablDsm");// Edit ************************** Tuesday, 27 May 2014 10:45:08
  EndWindow;
end;

window INImageIClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  integer wn;
  WindowBegin("Item picture",INImageIClass,CGother,-); 
  DynamicWindow;
  UseView(INVc);
  //SetWRect(10,10,300,300);
   SetWRect(0,10,300,300);
  Sizeable(-1,-1,-1,-1);
  Modality(2);
  EditField(70,20,100,"Item",ViewOnly,Code,false,0);
  EditField(70,40,100,"Name",ViewOnly,Name,false,0);
  Pict_Field(10,60,-10,-10,"");
  EndWindow;
end;

window PUDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,t,v,vm,vs;
  string 255 label;
  record CYBlock CYb;
  Integer tilenr;
  Integer f,flipnr;

  BlockLoad(CYb);
  WindowBegin("Goods Receipt",PUDClass,CGview,-);
  if (currentcompany==3) then begin
    SetWRect(20,80,870,620);
  end else begin
  SetWRect(20,80,750,460);
  end;
  Sizeable(-1,-1,0,0);
  UseView(PUVc);
  ActiveFieldOnNew("VECode");      
  FormName(PurchaseForm);
  Tile(0,74,false,"",TransDate);
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"#Supplier#",Normal,VECode,false,VESClass);
  EnterSkip(TransDate);
  EditField(h=255,v=vm,-40,"Name",Normal,VEName,false,0);
  EditField(h=300,v+20,100,"Official Ser.Nr",Normal,OfficialSerNr,false,0);	//Edit----------------------Dima  31.03.2015
  CheckBox(h=500,v+20,0,"Not for reports",NotForReport);							//Edit----------------------Dima  01.04.2015
  CheckBox(h4=-100,v+=20,0,"OK",OKFlag);
  CheckBox(h4,v+=16,0,"Price Incl. #VAT#",InclVAT);
  tilenr = 1;
  TileButton(tilenr,"Terms"); tilenr = tilenr + 1;
  TileButton(tilenr,"Items"); tilenr = tilenr + 1;
  if (HasMultiCurrency) then begin
    TileButton(tilenr,"Currency"); tilenr = tilenr + 1;
  end;
  if (IsEnterprise) then begin
    TileButton(tilenr,"Extra Costs"); tilenr = tilenr + 1;
    TileButton(tilenr,"Freight"); tilenr = tilenr + 1;
    TileButton(tilenr,"Comment"); tilenr = tilenr + 1;
  end;
  tilenr = 1;

  vs = 20; h1 = 110; h2 = 300; h3 = 550; h4 = -100;
  Tile(tilenr,70,false,tilenr,TransDate); tilenr = tilenr + 1;
  EditField(h1,vm=(v=6),82,"Trans. Date",Normal,TransDate,false,PasteCurDate);
  if (IsEnterprise==false) then begin
    EditField(h2,v,-20,"Comment",Normal,Comment,false,0);
  end;
  if (HasMultiLocations) then begin
    EditField(h1,v+=vs,82,"Location",Normal,Location,false,LocationSClass);
  end;
  if (IsEnterprise) then begin
    EditField(h1,v+=vs,82,"Route",ViewOnly,Sorting,false,0);
  end;
  if (HasObjects) then begin
    if (IsEnterprise) then begin
      EditField(h2,v=vm,135,"Objects",Normal,Objects,false,ObjSClass);
    end else begin
      if (HasMultiLocations) then begin
        EditField(h2,v,135,"Objects",Normal,Objects,false,ObjSClass);
      end else begin
        EditField(h2,v+=vs,135,"Objects",Normal,Objects,false,ObjSClass);
      end;
    end;
  end;
  if (IsEnterprise) then begin
    EditField(h2,v+=vs,135,"Purch. Order No.",ViewOnly,PONr,false,0);
    EditField(h2,v+=vs,135,"Purch. Contract",ViewOnly,POCOSerNr,true,POCOSClass);
    EditField(h3,v=vm,80,"Purch. Order Class",ViewOnly,PUClass,false,0);
  end;
  if (HasLanguages) then begin
    EditField(h3,v+=vs,80,"Language",Normal,LangCode,false,LangSClass);
  end;
//  CheckBox(h4,v=vm,0,"Price Incl. #VAT#",InclVAT);
  EnterSkip(Math);
  Tile(tilenr,220,true,tilenr,Math); tilenr = tilenr + 1;
  v = 24;
  if (HasSerialNumbers) then begin
    MatrixBegin(4,v,-50,-50,-,2000);
  end else begin
    MatrixBegin(4,v,-25,-50,-,2000);
  end;
  MatTypedRow(stp);
  MatOverStrike(ovst);
  Flip(0);
  MatCol(1,28,"Item",0,ArtCode,false,INSClass);

  if (HasVarieties) then begin
    MatCol(1,94,"Qty",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(1,94,"Qty",0,Quant,true,0);
  end;
  EnterSkip(Spec);
  MatText(t=3,28,"Signature",true);
  MatCol(t,100,"",0,Sign,false,0);
  MatText(t,160,"Correction Date",true);
  MatCol(t,290,"UpdDate",0,UpdDate,false,0);
  flipnr = 1;
  Flip(flipnr); flipnr = flipnr + 1;
  if (currentcompany==3) then begin
    MatColTL(1,144,"Unit",0,M4Code,ViewOnly,5,UnitCode,false,UnitSCLass);
    MatCol(1,184,"Description",0,Spec,false,0);
    MatCol(1,-485,"Location",0,Location,false,LocationSClass);
    MatCol(1,-430,"Serial No.",0,SerialNr,false,SerialNrSClass);
    MatCol(1,-320,"#Stock# Type",0,StockType,false,SetSClass);
  end else begin
  MatColTL(1,164,"Unit",0,M4Code,ViewOnly,5,UnitCode,false,UnitSCLass);
    MatCol(1,204,"Description",0,Spec,false,0);
  end;
  MatCol(1,-240,"Unit Price",0,UPrice,true,0);
  MatCol(1,-160,"Cost Price",0,CostPrice,true,0);
  MatCol(1,-80,"Sum",0,Sum,true,0);
  if (IsEnterprise) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"Description",0,Spec,false,0);
    MatCol(1,-350,"Location",0,Location,false,LocationSClass);
    MatCol(1,-280,"Serial No.",0,SerialNr,false,SerialNrSClass);
    MatCol(1,-150,"Best Before",0,BestBefore,false,0);
    MatCol(1,-60,"Batch Status",0,BatchStatus,false,BatchStatusSClass);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"Description",0,Spec,false,0);
    MatColTL(1,-404,"Item Cost",0,-1,ViewOnly,-1,InPrice,false,0);
    MatColTL(1,-324,"Price Varian.",0,-1,ViewOnly,-1,VarianceAmount,false,0);
    MatCol(1,-244,"Unit Price",0,UPrice,true,0);
    MatCol(1,-174,"Extra Cost",0,Extra,true,0);
    MatCol(1,-104,"Cost Price",0,CostPrice,true,0);
    if (CYb.UseTaxTemplatesforTaxCalc!=0) then begin
      MatCol(1,-34,"T-Cd",0,TaxTemplateCode,false,TaxTemplateSClass);
    end else begin
      MatCol(1,-34,"#V-Cd#",0,VATCode,false,VATCodeSClass);
    end;
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"Description",0,Spec,false,0);
    MatCol(1,-350,"#Supp.# Item No.",0,VEItemCode,false,0);
    MatColTL(1,-270,"#S.# Unit",0,M4Code,ViewOnly,5,VEUnit,false,UnitSCLass);
    MatCol(1,-200,"#Supp.# Qty",0,VEQuant,true,0);
    MatCol(1,-140,"Coeff.",0,Coefficient,true,0);
    MatCol(1,-90,"Base Price",0,BasePrice,false,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"Description",0,Spec,false,0);
    MatCol(1,-400,"#Stock# Type",0,StockType,false,SetSClass);
    MatCol(1,-310,"TREO",0,TREO,false,SetSClass);
    MatCol(1,-220,"#Stock# A/C",0,CostAcc,false,AccSClass);
    MatCol(1,-155,"Purch. A/C",0,CredAcc,false,AccSClass);
    MatCol(1,-90,"Objects",0,Objects,false,ObjSClass);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"Description",0,Spec,false,0);
    MatCol(1,-340,"Customs No.",0,CustomsNr,false,0);
    MatCol(1,-240,"Country of O.",0,CountryOfOrg,false,CountrySClass);
    MatCol(1,-140,"From Pos.",0,PosCode,false,PosSClass);
    MatCol(1,-70,"To Position",0,ToPosCode,false,FreePosSClass);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"Description",0,Spec,false,0);
    MatCol(1,-250,"Serial No.",0,SerialNr,false,SerialNrSClass);
    MatCol(1,-135,"Width",0,UnitXval,true,0);
    MatCol(1,-90,"Height",0,UnitYval,true,0);
    MatCol(1,-45,"Depth",0,UnitZval,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"Description",0,Spec,false,0);
    MatCol(1,-420,"Fr. Cost",0,ShipCost,true,0);
    MatCol(1,-360,"Customs",0,CustomsCost,true,0);
    label = UserDefined("AccBlock","PUCost1");
    if (blank(label)) then begin label = "Cost 1";end;
    MatCol(1,-300,label,0,RowCost1,false,0);
    label = UserDefined("AccBlock","PUCost2");
    if (blank(label)) then begin label = "Cost 2";end;
    MatCol(1,-240,label,0,RowCost2,false,0);
    label = UserDefined("AccBlock","PUCost3");
    if (blank(label)) then begin label = "Cost 3";end;
    MatCol(1,-180,label,0,RowCost3,false,0);
    label = UserDefined("AccBlock","PUCost4");
    if (blank(label)) then begin label = "Cost 4";end;
    MatCol(1,-120,label,0,RowCost4,false,0);
    label = UserDefined("AccBlock","PUCost5");
    if (blank(label)) then begin label = "Cost 5";end;
    MatCol(1,-60,label,0,RowCost5,false,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,144,"PO No.",0,PONr,false,POSClass);
    MatCol(1,194,"PO Row",0,OrdRow,false,0);
    MatCol(1,-370,"PO Recon.",0,PORecon,false,0);
    MatCol(1,-310,"Comment",0,POReconComment,false,0);
    MatCol(1,-200,"Inv. Recon.",0,VIRecon,false,0);
    MatCol(1,-130,"Comment",0,VIReconComment,false,0);
  end else begin
    if (HasSerialNumbers) then begin
      Flip(flipnr); flipnr = flipnr + 1;
      MatCol(1,144,"Description",0,Spec,false,0);
      MatCol(1,-150,"Serial No.",0,SerialNr,false,SerialNrSClass);
    end;

  end;
  if (currentcompany==3) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=1,144,"Description",0,Spec,false,0);
    MatCol(t,-350,"#Supp.# Serial No",0,SuppSerialNr,true,0);
    MatCol(t,-200,"Metal",0,Metal,true,0);
    MatCol(t,-150,"Weight",0,RowWeight,true,0);
    MatCol(t,-100,"Size",0,Size,true,0);
    MatCol(t,-50,"Length",0,Length,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=1,144,"Description",0,Spec,false,0);
    MatCol(t,-350,"Major Stone",0,MajStoneDet,true,0);
    MatCol(t,-250,"#Colour#",0,Colour,true,0);
    MatCol(t,-200,"Clarity",0,Clarity,true,0);
    MatCol(t,-150,"Cert",0,Cert,true,0);
    MatCol(t,-100,"Minor Stone",0,MinStoneDet,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=1,144,"Description",0,Spec,false,0);
    MatCol(t,-400,"Watch Brand",0,WatchBrand,true,0);
    MatCol(t,-300,"Style Name",0,StyleName,true,0);
    MatCol(t,-200,"Watch Metal",0,WatchMetal,true,0);
    MatCol(t,-100,"Movement",0,Movement,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=1,144,"Description",0,Spec,false,0);
    MatCol(t,-400,"Brc/Str",0,BrcStr,true,0);
    MatCol(t,-300,"Gender",0,Gender,true,0);
    MatCol(t,-200,"Other",0,Other,true,0);
    MatCol(t,-100,"Other 2",0,Other2,true,0);
  end;
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = 18; 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1)); 
      v = v + vs;
    end;
  end;
  EditField(110,-41,70,"Total Qty",ViewOnly,SumQuant,true,0);
//  EditField(110,-21,70,"Price Subtotal",Normal,SubTotal,true,0); //Shows the same as SumCostPrice?
  EditField(260,-41,70,"Freight",Normal,ShipCost,true,0);
  if (IsEnterprise) then begin
    EditField(260,-21,70,"Customs",Normal,CustomsCost,true,0);
  end;
  EditField(410,-41,70,"#VAT#",Normal,VATVal,true,0);
  if (IsEnterprise) then begin
    EditField(410,-21,70,"Ext. Tax",ViewOnly,TAX1Sum,true,0);
  end;
  EditField(-169,-41,118,"Subtotal",ViewOnly,SumCostPrice,true,0);
  EditField(-169,-21,118,"TOTAL",ViewOnly,PayVal,true,0);
  if (HasMultiCurrency or HasBase2) then begin
    Tile(tilenr,70,false,tilenr,FrRate); tilenr = tilenr + 1;
  vs = 20;
    if (HasBase2) then begin
      h1 = h1 + 20;
    end;
    EditField(h1,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
    if (HasMultiCurrency) then begin
      EditField(h2,v,50,"Rate",Normal,FrRate,true,0);
      EditField(h2+65,v,50,":",Normal,ToRateB1,true,0);
      if (HasBase2) then begin
        StaticText(h2+125,v+14,"Base Currency 1",false);
        EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
        EditField(h2+65,v,50,":",Normal,ToRateB2,true,0);
        StaticText(h2+125,v+14,"Base Currency 2",false);
        EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
      end else begin
        StaticText(h2+125,v+14,"Base Currency",false);
      end;
    end else begin
      EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
      EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
    end;
  end;
  if (IsEnterprise) then begin
    Tile(tilenr,120,false,tilenr,Cost1); tilenr = tilenr + 1;
    vs = 20;
    label = UserDefined("AccBlock","PUCost1");
    if (blank(label)) then begin label = "Extra Cost 1";end;
    EditField(h=110,v=6,70,label,Normal,Cost1,false,0);
    label = UserDefined("AccBlock","PUCost2");
    if (blank(label)) then begin label = "Extra Cost 2";end;
    EditField(h2=295,v,70,label,Normal,Cost2,false,0);
    label = UserDefined("AccBlock","PUCost3");
    if (blank(label)) then begin label = "Extra Cost 3";end;
    EditField(h,v+=vs,70,label,Normal,Cost3,false,0);
    label = UserDefined("AccBlock","PUCost4");
    if (blank(label)) then begin label = "Extra Cost 4";end;
    EditField(h2,v,70,label,Normal,Cost4,false,0);
    label = UserDefined("AccBlock","PUCost5");
    if (blank(label)) then begin label = "Extra Cost 5";end;
    EditField(h,v+=vs,70,label,Normal,Cost5,false,0);
    ButtonFrame(h3=400,v=16,130,2,"Extra Costs Calculation");
    RadioButton(h3,v,0,0,"Value",ExtraCostsCalculation);
    RadioButton(h3,v+=16,1,0,"Weight",ExtraCostsCalculation);
    ButtonFrame(h3=-163,v=16,123,6,"Approval Status");
    RadioButton(h3,v,kAcceptanceStateNotRequired,0,"Not Required",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateNotStarted,0,"Not Started",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateNotRequested,0,"Not Requested",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStatePending,0,"Pending",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateApproved,0,"Approved",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateRejected,0,"Rejected",AcceptanceStatus);  
    Tile(tilenr,130,false,tilenr,FreightCode); tilenr = tilenr + 1;
    EditField(h1,v=6,80,"Freight Company",Normal,FreightCode,false,FreightCompanySClass);
    EditField(h1,v+=vs,-20,"Name",Normal,FreightCompany,false,0);
    EditField(h1,v+=vs,-20,"#Reg. No.#",Normal,FreightCompanyRegNr,false,0);
    EditField(h1,v+=vs,-20,"Truck Information",Normal,TruckInfo,false,0);
    EditField(h1,v+=vs,-20,"Driver",Normal,Driver,false,0);
    EditField(h1,v+=vs,-20,"CMR",Normal,CMRText,false,0); // International transporting number
    Tile(tilenr,30,false,tilenr,Comment); tilenr = tilenr + 1;
    EditField(h1,v=6,-20,"Comment",Normal,Comment,false,0);
  end;
  if (IsEnterprise) then begin
    SpecialMenu("Item Search",'',1,"ItemSearchDsm");
    //SpecialMenu("Table Search",'f',1,"TableSearchDsm");  //Edit----------------Dima  17.12.2014
    SpecialMenu("Goods Receipt Status",'r',4,"PUStatusDsm");
    SpecialMenu("Generate Serial No.",' ',2,"GenSerialNosPUDsm");
    SpecialMenu("Open Batch Specification",' ',5,"OpenBatchPUDsm");
  end;
  if (HasModNL) then begin
    SpecialMenu("Open #NL# Transaction",'t',4,"OpenTRFromPU");
  end;
  if (IsEnterprise) then begin
    SpecialMenu("Open TAX Matrix",' ',25,"OpenVatMatrixPUDsm"); 
  end;
  SpecialMenu("Print Labels",'e',0,"PrintPULabPUDsm");
  if (IsEnterprise) then begin
    SpecialMenu("Send for Approval",' ',14,"PUSendforAcceptancePUDsm");
    SpecialMenu("Cancel Approval Request",' ',2,"CancelApprovalRequestDsm");
    SpecialMenu("Split Row",' ',7,"SplitRowPUDsm");
    SpecialMenu("Update Prices",' ',1,"UpdatePricesPUDsm");

    SpecialMenu("Accept Warehouse #Stock# Movements",' ',9,"OKStockMovPUrDsm");
  end;
  if (HasModPL) then begin
  SpecialMenu("Create #Purchase Invoice#",'F',3,"VIFromPUDsm");
  end;
  if (IsEnterprise) then begin
  SpecialMenu("Create Quality Control",'u',10,"QualConFromPUDsm");
//  SpecialMenu("  ",' ',6,"UpdateMarkPUDsm");
  SpecialMenu("Create Returned Goods",'B',7,"RetPUFromPUDsm");
//  SpecialMenu("Create Stock Movement",' ',5,"StockMovFromPUSpec");
//  SpecialMenu("Scan",' ',8,"ScanBarCodePUDsm");
  SpecialMenu("Create #Stock# Movement",' ',8,"INTransFromPUsm");
  SpecialMenu("Pack List",' ',8,"PackListPUDsm");
  end;
  EndWindow;
end;

window PasteRetItemTClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
	real h,v,vs;
	Integer tilenr,flipnr,f;
  WindowBegin("Insert items to return",PasteRetItemTClass,CGview,-); 
  DynamicWindow;
  SetWRect(0,10,700,300);
  /*UseView(RcVc);
  //Modality(2);
  
  EditField(100,20,100,"Item",Normal,ObjStr,false,INSClass);
  if(currentcompany==1)then begin
  	EditField(100,40,100,"Sale Date",Normal,sStartDate,false,PasteCurDate);
  end;
  HalPushButton(100,70,180,90,"SearchRetItems"," ");
  HalPushButton(230,70,350,90,"PasteRetItems"," ");
  
  StaticText(29+h,110,"Item",false);
  h=5;
  if(currentcompany>1)then begin
  	h=50;
  	StaticText(29+h,110,"Date",false);
  	h=80;
  end;
  StaticText(85+h,110,"Qty.",false);
  StaticText(119+h,110,"Price",false);
  StaticText(169+h,110,"Discount",false);
  StaticText(219+h,110,"Sum",false);
  StaticText(279+h,110,"Location",false);
  StaticText(339+h,110,"Customer",false);
  
  
  StringList(9,120,-24,-10);*/
  
  UseView(SHVc);
  
  Tile(0,110,false,"",DelAddrCode);
  EditField(100,20,150,"Item",Normal,DelAddrCode,false,INSClass);
  if(currentcompany==1)then begin
  	EditField(100,40,100,"Sale Date",Normal,ShipDate,false,PasteCurDate);
  end;
  HalPushButton(100,70,180,90,"SearchRetItems"," ");
  HalPushButton(230,70,350,90,"PasteRetItems"," ");
  
  StaticText(29+h,110,"Item",false);
  h=5;
  if(currentcompany>1)then begin
  	h=50;
  	StaticText(29+h,110,"Date",false);
  	h=80;
  end;
  
  tilenr = 1;
  TileButton(tilenr,"Items"); 
  Tile(tilenr,220,true,tilenr,Math); 
  v = 24;
  EnterSkip(Math);
  MatrixBegin(4,v,-40,-30,-,200);
  Flip(0);
  MatColTL(1,h=30,"Item",0,-1,ViewOnly,0,ArtCode,false,0);
  flipnr = 1;
  Flip(flipnr); flipnr = flipnr + 1;
  MatColTL(1,h+=100,"Date",0,-1,ViewOnly,0,BestBefore,false,0);
  MatColTL(1,h+=80,"Qty.",0,-1,ViewOnly,0,Ship,false,0);
  MatColTL(1,h+=50,"Price",0,-1,ViewOnly,0,BasePrice,false,0);
  MatColTL(1,h+=60,"Discount",0,-1,ViewOnly,0,PosCode,false,0);
  MatColTL(1,h+=60,"Sum",0,-1,ViewOnly,0,TAX2Reb,false,0);
  MatColTL(1,h+=60,"Location",0,-1,ViewOnly,0,Location,false,0);
  MatColTL(1,h+=60,"",0,-1,ViewOnly,0,CustArtCode,false,0);
  MatColTL(1,-110,"Customer",0,-1,ViewOnly,0,VARList,false,0);  
  if (CurrentUser=="SA" or CurrentUser=="SA1") then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatColTL(1,h=130,"FIFO row",0,-1,ViewOnly,0,FIFO,false,0);
    MatColTL(1,h+=70,"FIFO row cur.",0,-1,ViewOnly,0,FIFORowVal,false,0);
    MatColTL(1,h+=100,"Currency FIFO",0,-1,ViewOnly,0,TAX2Code,false,0);
    MatColTL(1,h+=70,"Invoice ",0,-1,ViewOnly,0,OrdRow,false,0);
    MatColTL(1,h+=70,"Invoice row",0,-1,ViewOnly,0,stp,false,0);
  end;
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = 18; 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-25,v,-6,v+vs,ToolFlip,f,chr(asc("A") + f - 1)); 
      v = v + vs;
    end;
  end;
  
  EndWindow;
end;

window ItemStockStatRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v;
  WindowBegin("Store balances Report",ItemStockStatRClass,CGRcW,RcType);
  SetWRect(20,80,440,150);
  h=100;
  EditFieldTL(h,v+=20,150,"Item",M4UStr,Normal,41,f1,false,INSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Location",M4UStr,Normal,41,f2,false,LocationSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Classification ",M4UStr,Normal,41,f3,false,DISClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Brand ",M4UStr,Normal,41,f4,false,DI2SClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Model ",M4UStr,Normal,41,f5,false,DI3SClass);//carefull we run ARRn
  EndWindow;
end;

window ItemStockStatExtRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v;
  WindowBegin("Store balances Report",ItemStockStatExtRClass,CGRcW,RcType);
  SetWRect(20,80,440,150);
  h=100;
  EditFieldTL(h,v+=20,150,"Date",M4Date,Normal,41,d1,false,PasteCurDate);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Item",M4UStr,Normal,41,f1,false,INSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Location",M4UStr,Normal,41,f2,false,LocationSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Classification ",M4UStr,Normal,41,f3,false,DISClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Brand ",M4UStr,Normal,41,f4,false,DI2SClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Model ",M4UStr,Normal,41,f5,false,DI3SClass);//carefull we run ARRn
  EndWindow;
end;

window ItemStockStatExtManRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v;
  WindowBegin("Store balances Report for Managers ",ItemStockStatExtManRClass,CGRcW,RcType);
  SetWRect(20,80,440,150);
  h=100;
  EditFieldTL(h,v+=20,150,"Date",M4Date,Normal,41,d1,false,PasteCurDate);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Item",M4UStr,Normal,41,f1,false,INSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Location",M4UStr,Normal,41,f2,false,LocationSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Classification ",M4UStr,Normal,41,f3,false,DISClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Brand ",M4UStr,Normal,41,f4,false,DI2SClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,150,"Model ",M4UStr,Normal,41,f5,false,DI3SClass);//carefull we run ARRn
  EndWindow;
end;

window CUChangeCurVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("Change currency to all users ",CUChangeCurVClass,CGMnt,RcType);
  SetWRect(20,80,400,240);
  vs = 20;h = 130; v = 26;
  EditFieldTL(h,v+=20,150,"Currency",M4UStr,Normal,41,f1,false,CurncyCodeSClass);//carefull we run ARRn
  CheckBox(h,v+=20,0,"Clear currency",flags[0]);
  EndWindow;
end;

window INChangeCSTVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("Undo changes to the cost on the item card ",INChangeCSTVClass,CGMnt,RcType);
  SetWRect(20,80,400,240);
  vs = 20;h = 130; v = 26;
  EndWindow;
end;

window FIXVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("FIXVClass",FIXVClass,CGMnt,RcType);
  SetWRect(20,80,400,240);
  vs = 20;h = 130; v = 26;
  EndWindow;
end;

window EmptyVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("update ",EmptyVClass,CGMnt,RcType);
  SetWRect(20,80,400,240);
  
  vs = 20;h = 130; v = 26;
  EditField(h=30,v=10, 70, "f1",Normal,f1,false,0);
  EndWindow;
end;

window ARDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,t,v,vs;
  WindowBegin("Price Point Sheet ",ARDClass,CGview,-);
  SetWRect(20,80,512,639);
  UseView(ARVc);
  vs = 20; h=50; h1=100; h2=220;
  EditField(h=30,v=10, 70, "InvoiceNr",Normal,InvoiceNr,false,0);
  EditField(h,v+=20, 82, "Date",Normal,DueDate,false,0);
  EditField(h,v+=20, 82, "RVal",Normal,RVal,false,0);
  EditField(h,v+=20, 82, "CustCode",Normal,CustCode,false,0);
  EditField(h,v+=20, 82, "ARRebDate",Normal,ARRebDate,false,0);
  EditField(h,v+=20, 82, "ARCurncyCode",Normal,ARCurncyCode,false,0);
  EditField(h,v+=20, 82, "CustName",Normal,CustName,false,0);
  EditField(h,v+=20, 82, "BookRVal",Normal,BookRVal,false,0);
  EditField(h,v+=20, 82, "OfficialSerNr",Normal,OfficialSerNr,false,0);
  EditField(h,v+=20, 82, "ARRebDate2",Normal,ARRebDate2,false,0);
  
  EndWindow;
end;

window ARLClass:10
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","iPad") 
begin
  WindowBegin("ARVc",ARLClass,CGmlist,-); 
  SetWRect(20,80,800,298);
  Sizeable(-1,-1,0,0);
  SpawnClass(ARDClass);
  UseView(ARVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"No.",InvoiceNr,false,InvoiceNr); 
  RlColKey(111,111,"Invoice date",DueDate,false,DueDate); 
  RlColKey(220,200,"Customer",CustName,false,CustName); 
  SearchField("Search "); 
  
  EndWindow;
end;

window ARPayDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,t,v,vs;
  WindowBegin("ARPayVc",ARPayDClass,CGview,-);
  SetWRect(20,80,512,639);
  UseView(ARPayVc);
  vs = 20; h=50; h1=100; h2=220;

  
  EndWindow;
end;

window ARPayLClass:10
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","iPad") 
begin
  WindowBegin("ARPayVc",ARPayLClass,CGmlist,-); 
  SetWRect(20,80,800,298);
  Sizeable(-1,-1,0,0);
  SpawnClass(ARPayDClass);
  UseView(ARPayVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"No.",CUPNr,false,CUPNr); 
  RlColKey(111,111,"Order",OrderNr,false,OrderNr); 
  RlColKey(220,200,"Customer",CustCode,false,CustCode); 
  SearchField("Search "); 
  
  EndWindow;
end;

  
  window IVrsLClass:1
    wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
  begin
    integer h,v;
      WindowBegin("Invoices",IVrsLClass,CGmlist,-);
      SetWRect(20,80,760,291);
      Sizeable(-1,-1,0,0);
      //SpawnClass(IVrsDClass);
      UseView(IVrsVc);
      RecordList(4,17,-21,-39);
      RlColKey(4,2,"1",SerNr,false,SerNr);
      RlColKey(70,70,"IVNr",IVNr,false,IVNr);
      RlColKey(105,105,"Invoice date",TransDate,false,TransDate);
      RlCol(180,180,"RowNr",RowNr,false);    
      RlCol(287,287,"ArtCode",ArtCode,false);
      RlCol(360,360,"Spec",Spec,false);
      RlColKey(430,430,"Group",Group,false,Group);
      RlColKey(490,490,"MachineName",MachineName,false,MachineName);
      RlCol(-110,-110,"Quant",Quant,true);
      RlCol(-90,-90,"Row FIFO",FIFO,true);
      RlCol(-45,-45,"Sum",Sum,true);
      SearchField("Search");
      EndWindow;
  end; 
  
window INLClass:3
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Items",INLClass,CGmlist,-);
  if(UserCanAction("DisallowFullINDClass",true)==true)then begin// Edit ************************** Thursday, 24 July 2014 10:09:24
		SpawnClass(INDClass);
  end else begin
  	SpawnClass(cutINDClass);// Edit ************************** Thursday, 24 July 2014 10:09:27
  end;
  SetWRect(64,80,609,298);
  Sizeable(-1,-1,0,0);
  UseView(INVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,    "Code",Code,false,Code);
  if (HasModIN) then begin
  RlColKey(131,131,"Class",DispGroups,false,MyDispGroups); //!!PRODTRANSLATE
  //RlColKey(131,131,"Group",Group,false,Group); //!!PRODTRANSLATE
  RlColKey(201,201,"Prev. Down Payment",Name,false,Name); //!!PRODTRANSLATE
  end else begin
  RlColKey(111,111,"Prev. Down Payment",Name,false,Name);
  end;
  if (IsEnterprise) then begin
    RlColKey(-150,-150,"Alt. Code",AlternativeCode,false,AlternativeCode); 
  end;
  /*if (IsEnterprise) or (HasModIN) then begin// Edit ************************** Thursday, 24 July 2014 10:29:18
    RlCol(-70,-70,". ",UPrice1,true); 
  end else begin
    RlCol(-70,-70,"Price",UPrice1,true); 
  end;*/
  SearchField("Search ");
  if (GuiType==kGuiMetro) then begin
    RowMenuBegin(""); //!!TRANSLATE
    if (HasModIN) then begin
      if (UserCanReport("INInfoRn","",true)) then begin //!!TRANSLATE
        RowMenuItem(1,"Item Status Report",'I','I',4315,"OKIVLsm"); //!!TRANSLATE
      end;
      RowMenuItem(2,"Item Status",' ',' ',4315,"ItemStatusINLsm"); //!!TRANSLATE
    end;
    if (IsEnterprise) then begin
      if (UserCanReport("INrsRn","INrsRClass",true)) then begin //!!TRANSLATE
        RowMenuItem(3,"Item History",'h','h',4315,"INHistINLsm"); //!!TRANSLATE
      end;
    end;
    if (currentcompany==3) then begin
      RowMenuItem(4,"Item Status per Alternative Code",'I','I',4315,"ItemStatusAltINLsm"); //!!TRANSLATE
    end;
    EndRowMenu;
    SpecMenuGroup("",kSpecMenuGroupTypeButtonsInBottomBarRight,0); //!!TRANSLATE
    SpecialMenuWithIcon("Search",'F',4313,2,"INSearchLsm"); //!!TRANSLATE
  end else begin
  if (HasModIN) then begin
    if (UserCanReport("INInfoRn","",true)) then begin 
    SpecialMenu("Help by product ",'I',0,"INStatusINLsm");
    end;
    SpecialMenu("Item Status",' ',1,"ItemStatusINLsm"); 
  end;
  if (IsEnterprise) then begin
    if (UserCanReport("INrsRn","INrsRClass",true)) then begin 
    SpecialMenu("Item History ",'h',2,"INHistINLsm");//CMD H DOES HIDE HANSA 
    end;
  end;
  SpecialMenu("Search ",'F',2,"INSearchLsm"); 
  if (currentcompany==3) then begin
    SpecialMenu("Item Status code for the Alternative ",'I',5,"ItemStatusAltINLsm");
    end;
  end;
  EndWindow;
end;

window SRDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,h4,v,vm,vs;
  Integer f,flipnr;
  
  WindowBegin("#Stock# Revaluation",SRDClass,CGview,-);
  SetWRect(20,80,560,350);
  Sizeable(-1,-1,0,0);
  FormName(SRForm);
  UseView(SRVc);
  vs = 20; h2 = 260; h3 = 410; h4 = 580;
  EditField(h=80,v=6, 82,"No.",Normal,SerNr,false,TSerSClass);
  EditField(h2,v,82,"Trans. Date",Normal,TransDate,false,PasteCurDate);
  if (IsEnterprise) then begin
    EditField(h3,v,100,"Reason",Normal,Reason,false,StandProblemsSClass);
  end;
  EditField(h,v+=vs,82,"Short Code",Normal,ACShort,false,ACShortSClass);
  if (HasModNL) then begin
    EditField(h2,v,82,"Var. A/C",Normal,SRVarAcc,false,AccSClass);
  end;
  EditField(h,v+=vs,82,"Location",Normal,Location,false,LocationSClass);
  if (HasObjects) then begin
    EditField(h2,v,200,"Objects",Normal,Objects,false,ObjSClass);
  end;
  EnterSkip(Math);
  v = v + 42;
  vm = v + 1;
  MatrixBegin(4,v,-50,-40,-,500);
  Flip(0);
  MatCol(1,32,"Item",0,ArtCode,false,INSClass);
  MatCol(1,94,"Qty",0,Qty,true,0);
  flipnr = 1;
  Flip(flipnr); flipnr = flipnr + 1;
  if (HasSerialNumbers) then begin
    MatCol(1,144,"Serial No.",0,SerialNr,false,SerialNrSClass);
    MatCol(1,244,"Prev. Down Payment",0,Spec,false,0);
  end else begin
    MatCol(1,144,"Prev. Down Payment",0,Spec,false,0);
  end;
  MatCol(1,-240,"Old Cost",0,FIFO,true,0);
  MatCol(1,-160,"New Cost",0,NewFIFO,true,0);
  MatCol(1,-80,"Diff.",0,DiffFIFO,true,0);
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(1,-300,"Tot. Cost",0,FIFORowVal,true,0);
  MatCol(1,-200,"New Tot. Cost",0,NewFIFORowVal,true,0);
  MatCol(1,-100,"Diff.",0,DiffFIFORowVal,true,0);
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,194,"Prev. Down Payment",0,Spec,false,0);
  if (HasSerialNumbers) then begin
    MatCol(1,-310,"Serial No.",0,SerialNr,false,SerialNrSClass);
  end;
  if (IsEnterprise) then begin
    MatCol(1,-200,"Location",0,Location,false,LocationSClass);
    MatCol(1,-100,"Position",0,PosCode,false,PosSClass);
  end else begin
    MatCol(1,-100,"Location",0,Location,false,LocationSClass);
  end;
  if (HasModNL or HasObjects) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,194,"Prev. Down Payment",0,Spec,false,0);
    if (HasModNL) then begin
      MatCol(1,-310,"Var. A/C",0,SRVarAcc,false,AccSClass);
    end;
    if (HasObjects) then begin
      MatCol(1,-200,"Objects",0,Objects,false,ObjSClass);
    end;
    if (HasModNL) then begin
      MatCol(1,-100,"Short Code",0,ACShort,false,ACShortSClass);
    end;
  end;
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,194,"Prev. Down Payment",0,Spec,false,0);
  MatCol(1,-350,"#Supp.# Inv. No.",0,VEInvoiceNr,false,0);
  MatCol(1,-180,"Coeff",0,Coefficient,true,0);
  MatCol(1,-135,"Width",0,UnitXval,true,0);
  MatCol(1,-90,"Height",0,UnitYval,true,0);
  MatCol(1,-45,"Depth",0,UnitZval,true,0);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = vm;/* 28 */ 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1));
      v = v + vs;
    end;
  end;
  CheckBox(4,-20,0,"OK",OKFlag);
  EditField(h=290,-40,-52,"Comment",Normal,Comment,false,0);
  EditField(h=106,-20,50,"Tot. Qty",ViewOnly,TotQty,true,0);
  EditField(-128,-20,76,"Tot. Diff.",ViewOnly,TotDiff,true,0);
  SpecialMenu("Item Status",'I',0,"ItemStatusSRDsm");
  if (HasModNL) then begin
    SpecialMenu("Open #NL# Transaction",'t',1,"OpenTRFromSR");
  end;
  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  EndWindow;
end;

window RebTableBlockTClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real v;
  WindowBegin("Configuring discounts to employees ",RebTableBlockTClass,CGHbl,-);
  SetBlid(RebTableBlock);
  SetWRect(64,80,650,300);
  Sizeable(-1,-1,0,0);
  MatrixBegin(4,v=17,-32,-5,-,99);
  MatCol(1,24,"Experience ",0,Days,false,0);
  MatCol(1,94,"Discount table",0,RebCode,false,RebSClass);
  EndMatrix;
  EndWindow;
end;

window CUDClass:14
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,h5,l,v,vm,vs;
  string 255 label;
  WindowBegin("Contact",CUDClass,CGview,-);
  DynamicWindow;
  SetWRect(20,80,680,441);
  Sizeable(-1,-1,0,0);
  UseView(CUVc);
  FormName(PrintCUD);  
  if (HasLocalization("GBR")) then begin 
  ActiveFieldOnNew("Code"); //dont change, otherwise automatic address lookup helper window wont show automatically //wns
  end else begin
    ActiveFieldOnNew("Name");
  end;
  CommunicateButton;
  Tile(0,95,false,"",Code);
  v = 6; h = 130; l=223; vs = 20; h1=410; h2 = 350; h3 = 430; h4 = 580; h5 = 460;
  EditField(h,v ,   95,"No.",Normal,Code,false,TSerSClass);
  EditField(h1,v,50,"Customer Category",Normal,CustCat,false,CCatSClass);
  EditField(h,v+=vs,95,"Short",Normal,SearchKey,false,0);
  EditField(h1,v,50,"#Supplier# Category",Normal,VECat,false,VGSClass);
  EditField(h,v+=vs,h1-h+50,"Name",Normal,Name,false,0);
  CheckBox(h1+80,v=6,0,"C_ustomer",CUType);
  CheckBox(h1+80,v+=16,0,"#Supplier#",VEType);
  CheckBox(h1+80,v+=16,0,"Guest",GuestType);
  CheckBox(h1+80,v+=16,0,"Dealer",DealerType);
  CheckBox(h1+180,v=6,0,"Employee",EmployeeType);
//  HalPushButton(h1+170,v=10,h1+170+100,v+20,"CreditInfoCUDsm","Credit Info");
//  HalPushButton(h1+170,v=10,h1+170+100,v+20,"UpdCustomerAddressCUDsm","Update Address");
  TileButton(1,"Co_ntact");
  TileButton(2,"Delivery");
  TileButton(3,"Terms");
  TileButton(4,"Pricing");
  TileButton(5,"Compan_y");
  TileButton(6,"Accounts");
  TileButton(7,"Web");
  TileButton(8,"C_omments");
  TileButton(9,"Guest");
  TileButton(10,"User Defined");
  Tile(1,290,true,"1",InvAddr0);
  v=6;
  HalPushButton(h+120,v,h+120+100,v+20,"UpdCustomerAddressCUDsm","Update Address");
  v=v+10;
  StaticText(h,v+13,"Invoice Address",false);
  label = UserDefined("CUVc","InvAddr0");
  EditField(h,v+=vs,-20,label,Normal,InvAddr0,false,0);
  label = UserDefined("CUVc","InvAddr1");
  EditField(h,v+=vs,-20,label,Normal,InvAddr1,false,0);
  label = UserDefined("CUVc","InvAddr2");
  EditField(h,v+=vs,-20,label,Normal,InvAddr2,false,0);
  label = UserDefined("CUVc","InvAddr3");
  EditField(h,v+=vs,-20,label,Normal,InvAddr3,false,0);
  label = UserDefined("CUVc","InvAddr4");
  EditField(h,v+=vs,-20,label,Normal,InvAddr4,false,0);
  EditField(h,v+=vs,50,"Country",Normal,CountryCode,false,CountrySClass);
  EditField(h1,v,-20,"Department",Normal,Department,false,0);
  EditField(h,v+=vs,150,"Telephone",Normal,Phone,false,0);
  EditField(h1,v,-20,"Fax",Normal,Fax,false,0);
  EditField(h,v+=vs,150,"Alt Phone",Normal,AltPhone,false,0);
  EditField(h1,v,-20,"#Mobile#",Normal,Mobile,false,0);
  EditField(h,v+=vs,150,"Skype Name",Normal,SkypeName,false,0);
  EditField(h1,v,-20,"SIP",Normal,SIPCode,false,0);
  EditField(h,v+=vs,150,"E-mail",Normal,eMail,false,0);  
  EditField(h1,v,-20,"Extension",Normal,Extension,false,0);
  EditField(h,v+=vs,150,"Primary Contact",Normal,Person,false,ContactSClass);
  EditField(h1,v,-20,"Web Site",Normal,wwwAddr,false,0);
  EditField(h,v+=vs,-20,"Classification",Normal,Classification,false,CClassSClass);
  RecordList2(10,v+=40,-30,-39,"ContactRelVc");
  RlColKey(4,4,"Code",ContactCode,false,ActCustContactCode);
  RlCol(55,55,"Title",ContactTitle,false);
  RlColKey(105,105,"Name",ContactName,false,ActCustContactName);
  RlCol(235,235,"Phone",ContactPhone,false);
  RlCol(335,335,"#Mobile#",ContactMobile,false);
  RlCol(435,435,"Job Title",JobTitle,false);
  RlCol(535,535,"E-mail",ContacteMail,false);
//  RlCol(-1,-1,"",Invalid,true);
  Tile(2,240,false,"2",DelAddr0);
  v=6;
  if (HasLocalization("GBR,LVA,EST,SWE")) then begin
    HalPushButton(h+120,v,h+120+100,v+20,"UpdDeliveryAddressCUDsm","Update Address");
  end;
  v=v+12;
  StaticText(h,v+13,"Delivery Address",false);
  label = UserDefined("CUVc","DelAddr0");
  EditField(h,v+=vs,-20,label,Normal,DelAddr0,false,0);
  label = UserDefined("CUVc","DelAddr1");
  EditField(h,v+=vs,-20,label,Normal,DelAddr1,false,0);
  label = UserDefined("CUVc","DelAddr2");
  EditField(h,v+=vs,-20,label,Normal,DelAddr2,false,0);
  label = UserDefined("CUVc","DelAddr3");
  EditField(h,v+=vs,-20,label,Normal,DelAddr3,false,0);
  label = UserDefined("CUVc","DelAddr4");
  EditField(h,v+=vs,-20,label,Normal,DelAddr4,false,0);  
  EditField(h,v+=vs,50,"Country",Normal,DelCountry,false,CountrySClass);
  EditField(h2+50,v,-20,"Order Comment",Normal,OrderComment,false,0);
  EditField(h,v+=vs,120,"Freight No.",Normal,FreightNr,false,0);
  EditField(h2+50,v,70,"Region",Normal,Region,false,RegionSClass); 
  EditField(h,vm=(v+=vs),120,"Sales Del. Terms",Normal,ShipDeal,false,ShipDealSClass);
  EditField(h2+50,v,70,"Purchase Del. Terms",Normal,VEShipDeal,false,ShipDealSClass); 
  EditField(h,v+=vs,120,"Sales Del. Mode",Normal,ShipMode,false,DMSClass);
  EditField(h2+50,v,70,"Purchase Del. Mode",Normal,VEShipMode,false,DMSClass); 
  EditField(h,v+=vs,120,"Route",Normal,Sorting,false,DelRouteSClass);
  EditField(h2+50,v,70,"Max shipping delay days",Normal,PlanShipDays,false,0);
/* these fields were used for securities trading, this module doesnt exist in hansa anymore */
/* Two of these fields are used in Russia and Ukraine */
//  EditField(h,vm=(v+=vs),120,"Securities Acc.",Normal,SecAccount,false,0);
//  EditField(h,v+=vs,120,"Bank Account",Normal,BankAccount,false,0);//xx
//  EditField(h,v+=vs,120,"Account Operator",Normal,AccOperator,false,BankSClass);//xx
//##  EditField(h,v+=vs ,70, "Com. Matrix",Normal,ComCode,false,ComSClass);
  ButtonFrame(h5+30,v=vm,150,2,"Delivery Date Based On");
  RadioButton(h5+30,v,0,0,"Current Date",DeliveryBasedOn);
  RadioButton(h5+30,v+=16,1,0,"Planned Delivery Date",DeliveryBasedOn);  
  Tile(3,190,false,"3",PayDeal);
    EditField(h,v=6,25,"Sales Pay. Terms",Normal,PayDeal,false,PDSClass);
  EditField(h,v+=vs,80,"Sales Credit Limit",Normal,CreditLimit,true,0);
  EditField(h,v+=vs,80,"Sales Credit Limit Days",Normal,CreditLimitDays,false,0);
  EditField(h,v+=vs,80,"Their #Supp.# Code",Normal,TheirCode,false,0);  
  EditField(h,v+=vs,80,"Invoice To",Normal,InvoiceToCode,false,CUSClass);
  EditField(h,v+=vs,80,"ANA Code",Normal,ANACode,false,0);
  EditField(h,v+=vs,80,"Interest Rate",Normal,IntRate,false,0);
  EditField(h,v+=vs,80,"Creation Date",Normal,DateCreated,false,PasteCurDate);
  EditField(h,v+=vs,80,"Main Partner",Normal,MainPartner,false,CUSClass);
  EditField(h2,v=6,25,"Purch. Pay. Terms",Normal,VEPayDeal,false,PDSClass);
  EditField(h2,v+=vs,80,"Purch. Credit Limit",Normal,VECreditLimit,true,0);
  EditField(h2,v+=vs,80,"Purch. Credit Limit Days",Normal,VECreditLimitDays,false,0);
  EditField(h2,v+=vs,80,"Their Customer Code",Normal,VECustID,false,0);  
  EditField(h2,v+=vs,80,"Invoice To",Normal,VEInvoiceToCode,false,VESClass);
  EditField(h2,v+=vs,80,"Factoring",Normal,VEFactoring,false,VESClass);
  EditField(h2,v+=vs,80,"Min. Order Sum",Normal,MinOrdSum,false,0);
  EditField(h2,v+=vs,80,"Reference",Normal,RefStr,false,0);
  EditField(h2,v+=vs,80,"Last Changed",Normal,DateChanged,false,0);
  CheckBox(h5,v=12,0,"Closed",blockedFlag);
  CheckBox(h5,v+=16,0,"On Hold",OnHoldFlag);
  CheckBox(h5,v+=16,0,"Reminders",RemndrFlag);
//  CheckBox(h5,v+=16,0,"Collection",ColectionFlag);
  CheckBox(h5,v+=16,0,"Interest",InterestFlag);
  CheckBox(h5,v+=16,0,"On Account",OnAccount);
  CheckBox(h5,v+=16,0,"No Factoring",NoFactoringFlag);
  CheckBox(h5,v+=16,0,"No Extra Tax",NoTax1);
  CheckBox(h5,v+=16,0,"Group Inv. Only",GroupInv);
  CheckBox(h5,v+=16,0,"Self Billing",SelfBilling);
  CheckBox(h4,v=12,0,"EGO Customer",EGOFlag);
  CheckBox(h4,v+=16,0,"EDI Customer",EDIFlag);
  CheckBox(h4,v+=16,0,"Allow Login",AllowLogin);
//  CheckBox(h4,v+=16,0,"Allow FTP Access",FTPLogin);
  CheckBox(h4,v+=16,0,"Fiscal Invoices Only",FiscalFlag);
  CheckBox(h4,v+=16,0,"No Mass Letters",NoLetterPosting);
  CheckBox(h4,v+=16,0,"No Mass Emailing",NoMailPosting);
  CheckBox(h4,v+=16,0,"No Environment Tax",NoRepa);
  CheckBox(h4,v+=16,0,"No Region Perceptions",NoTax2);
  CheckBox(h4,v+=16,0,"F-Tax (Sweden)",FTax);
  v=v+16;
  CheckBox(h5,v+=16,0,"Allow SMS",AllowSendSMS);
	CheckBox(h5,v+=16,0,"Allow eMail",AllowSendeMail);
	CheckBox(h5,v+=16,0,"Allow calling",AllowSendCall);
	CheckBox(h5,v+=16,0,"Allow delivery post",AllowSendkMail); 
  
  
  Tile(4,110,false,"4",PLCode);
  EditField(h,v=6,  80,"Sales Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h,v+=vs ,80, "Price List",Normal,PLCode,false,PLDefSClass);
  EditField(h,v+=vs ,80, "Discount Matrix",Normal,RebCode,false,RebSClass);
  EditField(h,v+=vs,80,"#Salesman#",Normal,SalesMan,false,UserSClass);
  EditField(h,v+=vs,80,"Default Items",Normal,CompItemCode,false,CompItemSClass);
  EditField(h2,v=6,80,"Purch. Currency",Normal,VECurncyCode,false,CurncyCodeSClass);
  EditField(h2,v+=2*vs ,80, "#Supp.# Disc. Matrix",Normal,VERebCode,false,RebSClass);
  EditField(h2,v+=vs,80,"Sales Group",Normal,SalesGroup,false,SalesGroupSClass);
  ButtonFrame(h5=480,v=24,170,3,"Price Based On");//##cc
  RadioButton(h5,v,0,0,"Order Date",PriceBasedOn);
  RadioButton(h5,v+=16,1,0,"Planned Del. Date",PriceBasedOn);
  RadioButton(h5,v+=16,2,0,"#Despatch# Dates",PriceBasedOn);  
  Tile(5,180,false,"5",Comment);
  EditField(h,v=6,-20,"Comment",Normal,Comment,false,0);
  EditField(h,v+=vs,-20,"Warning on Sales",Normal,WarnText1,false,0);
  EditField(h,v+=vs,-20,"Warning on Purchase",Normal,VEWarnText1,false,0);
  EditField(h,v+=vs,50,"Language",Normal,LangCode,false,LangSClass);
  EditField(h2-20,v,120,"#Reg. No.# 1",Normal,RegNr1,false,0);
//  EditField(h,v+=vs,50,"Country",Normal,CountryCode,false,CountrySClass);
  EditField(h2-20,v+=vs,120,"#Reg. No.# 2",Normal,RegNr2,false,RegDefSClass);
  EditField(h,v+=vs,20,"Sales #VAT# Code",Normal,VATCode,false,VATCodeSClass);
  EditField(h+125,v,50,"Sales Tax Temp.",Normal,TaxTemplateCode,false,TaxTemplateSClass);
  HalPushButton(h2-20,v,h2-20+100,v+20,"UpdCustomerAddressCUDsm","Update Address");
  EditField(h,v+=vs,20,"Purch. #VAT# Code",Normal,VEVATCode,false,VATCodeSClass);
  EditField(h+125,v,50,"Purch. Tax Temp.",Normal,VETaxTemplateCode,false,TaxTemplateSClass);
  ButtonFrame(h2-20,v+=vs,143,1,"Type");
  RadioButton(h2-20,v,0,0,"Company",CustType);
  RadioButton(h2+60,v,1,0,"Person",CustType);
  EditField(h,v,120,"#VAT Reg. No.#",Normal,VATNr,false,0);
//  EditField(h,v+=vs,120,"Channel",Normal,WebServiceChannel,false,SetSClass);
  v = 84;
  //v = VATZoneButtonsLabelsENG(h5+50,v,150,16); //##cc// Edit ************************** Saturday, 19 August 2017 11:40:07
  Tile(6,130,false,"6",AccAP);
  EditField(h,v=6,80,"Creditor A/C",Normal,AccAP,false,AccSClass);
  EditField(h,v+=vs,80,"Cost A/C",Normal,AccCost,false,AccSClass);
  EditField(h,v+=vs,80,"Cred. On Acc. A/C",Normal,OnAccAccAP,false,AccSClass);
  EditField(h,v+=vs,120,"Sales Objects",Normal,Objects,false,ObjSClass);
  EditField(h,v+=vs,200,"IBAN Code",Normal,IBANCode,false,0);
  EditField(h1,v=6,-20,"Bank Account",Normal,BankAccount,false,0);
  EditField(h1,v+=vs,-20,"Bank Account 2",Normal,Bank,false,0);
  EditField(h1,v+=vs,-20,"Account Operator",Normal,AccOperator,false,BankSClass);  
  EditField(h1,v+=vs,120,"Purch. Objects",Normal,VEObjects,false,ObjSClass);
  EditField(h1,v+=vs,80,"#Sort Code#",Normal,SortCode,false,0);
  EditField(h1,v+=vs,120,"Withholding Payment Modes",Normal,WithPayMode,false,PMSClass);
  Tile(7,70,false,"7",WebConf);
  EditField(h,vm=(v=6),120,"Web Conference",Normal,WebConf,true,0);
  EditField(h1,v,150,"Main Classification",Normal,MainDispGroup,false,WebNGProductCatSClass);
  EditField(h,v+=vs,120,"Web Start Page",Normal,WebStartPage,false,0);
  EditField(h1,v,150,"Display on the Web",Normal,WebDisplays,false,WebDisplaySClass);
  EditField(h,v+=vs,120,"Freight Code",Normal,FreightCode,false,WebFreightSClass);
  Tile(8,170,false,"8",Comment0);
  EditField(h,v=6,-20,"Comment",Normal,Comment0,false,0);
  EditField(h,v+=vs,-20,"",Normal,Comment1,false,0);
  EditField(h,v+=vs,-20,"",Normal,Comment2,false,0);
  EditField(h,v+=vs,-20,"Courtesy Title",Normal,Title,false,CourtesyTitlesSClass);
  EditField(h,v+=vs,-20,"Job Title",Normal,JobDesc,false,JobTitleSClass);
  EditField(h,v+=vs,-20,"Salutation 1",Normal,Salutation1,false,0);
  EditField(h,v+=vs,-20,"Salutation 2",Normal,Salutation2,false,0);
  EditField(h,v+=vs,-20,"Salutation 3",Normal,Salutation3,false,0);
  Tile(9,250,false,"9",DocType);
  EditField(h,v=6,100,"Doc. Type",Normal,DocType,false,0);
  EditField(h2,v,-20,"ID",Normal,PassportNr,false,0);
//  EditFieldTL(h,vm=(v+=20),100,"Nationality",M4StrSet,Normal,423,Nationality,false,StrSetSClass);
  EditField(h,vm=(v+=20),100,"Nationality",Normal,Nationality,false,CountrySClass);
  EditField(h,v+=20,100,"Birthday",Normal,BirthDate,false,0);
  EditField(h,v+=20,100,"Profession",Normal,Profesion,false,0);   
  EditField(h,v+=20,100,"Newspaper",Normal,Newspaper,false,NewspaperSClass);
  EditField(h,v+=20,100,"Passphrase",Normal,Passphrase,false,0);
  EditField(h,v+=vs,100,"Tour Operator",Normal,TourOperator,false,CUSClass);
  EditField(h,v+=vs,100,"Agent",Normal,Agent,false,CUSClass);
  EditField(h,v+=vs,100,"Def. Pay. Mode",Normal,DefGuestPayMode,false,PMSClass);
  EditField(h,v+=vs,100,"Def. Booking Org.",Normal,BookOrigin,false,BookOrgSClass);
  EditField(h,v+=vs,300,"Diet Remarks",Normal,DietRemarks,false,0);
  EditField(h,v+=vs,300,"Req. Remarks",Normal,RequirementRemarks,false,0);

  ButtonFrame(h2,v=vm+20,100,4,"Sex");
  RadioButton(h2,v,3,0,"-",Gender); //Edit***************************Sasha2,11:35 05.07.2017
  RadioButton(h2,v,0,0,"Male",Gender);
  RadioButton(h2,v+=17,1,0,"Female",Gender);
  RadioButton(h2,v+=17,2,0,"Group",Gender);// Edit ************************** Wednesday, 16 December 2015 11:17:28
  //pay attention that Gender RadioButton #3 is in use

  CheckBox(h2+130,v=vm+20,0,"Smoker",Smoking);
  CheckBox(h2+130,v+=17,0,"Blacklisted",Blacklist);

  ButtonFrame(h2,vm=(v+=60),100,5,"Marital Status");
  RadioButton(h2,v,4,0,"-",MarStatus); //Edit***************************Sasha2,11:38 05.07.2017
  RadioButton(h2,v,0,0,"Single",MarStatus);
  RadioButton(h2,v+=17,1,0,"Married",MarStatus);
  RadioButton(h2,v+=17,2,0,"Divorced",MarStatus);
  RadioButton(h2,v+=17,3,0,"Widowed",MarStatus);
  //pay attention that MarStatus RadioButton #4 is in use

  ButtonFrame(h2=h2+130,v=vm,100,3,"Age Status");
  RadioButton(h2,v,1,0,"Child",AgeStatus);
  RadioButton(h2,v+=17,0,0,"Adult",AgeStatus);
  RadioButton(h2,v+=17,2,0,"Pensioner",AgeStatus);
  
  Tile(10,270,false,"10",UserStr1);
  v=6;h=180;
  label = UserDefined("CUVc","UserStr1");
  if (nonblank(label)) then begin
    EditField(h,v,-20,label,Normal,UserStr1,false,0);
  end;
  label = UserDefined("CUVc","UserStr2");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr2,false,0);
  end;
  label = UserDefined("CUVc","UserStr3");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr3,false,0);
  end;
  label = UserDefined("CUVc","UserStr4");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr4,false,0);
  end;
  label = UserDefined("CUVc","UserStr5");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserStr5,false,0);
  end;
  label = UserDefined("CUVc","UserVal1");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserVal1,false,0);
  end;
  label = UserDefined("CUVc","UserVal2");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserVal2,false,0);
  end;
  label = UserDefined("CUVc","UserVal3");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserVal3,false,0);
  end;
  label = UserDefined("CUVc","UserDate1");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserDate1,false,0);
  end;
  label = UserDefined("CUVc","UserDate2");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserDate2,false,0);
  end;
  label = UserDefined("CUVc","UserDate3");
  if (nonblank(label)) then begin
    EditField(h,v+=vs,-20,label,Normal,UserDate3,false,0);
  end;
  h=h+50;
	EditField(h,v+=vs,-20,"Address Books",Normal,AddressBooks,false,0);
  v=v+vs;
  EditField(h,v+=vs,80,"Date of creation ",Normal,DateCreated,false,PasteCurDate);// Edit ************************** Friday, 27 September 2013 09:38:50
  EditField(h,v+=vs,80,"Card wound up in the store (warehouse) ",Normal,CreateLocation,false,GlobalLocationSClass);// Edit ************************** Friday, 27 September 2013 09:38:46
  EditField(h,v+=vs,80,"Card wound up in the company ",Normal,CreateCompany,false,0);// Edit ************************** Friday, 27 September 2013 09:38:46
  EditField(h,v+=vs,-20,"Commentary to create cards ",Normal,CreateComment,false,0);// Edit ************************** Friday, 27 September 2013 09:38:48
  
  if (UserCanReport("CustPSRn","",true)) then begin 
  SpecialMenu("Customer Status",'e',0,"CUStatusCUDsm");
  end;
  SpecialMenu("Link Existing Contact",' ',1,"AddContactCUDsm");
  SpecialMenu("Create New Contact",' ',1,"NewContactCUDsm");
  SpecialMenu("Remove Linked Contact",' ',1,"DelContactCUDsm");
  SpecialMenu("Edit Linked Contact Data",' ',1,"EditContactCUDsm");
  SpecialMenu("Create Activity",'c',2,"NewActCUDsm");
  SpecialMenu("Create Random Password Mail",' ',3,"RandomPassMailCUDsm");
  SpecialMenu("Create e-mail",'m',5,"NewMailCUDsm");
  if (UserCanReport("VEPSRn","",true)) then begin
    SpecialMenu("#Supplier# Status",'u',4,"VEStatusVEDsm");
  end;
  SpecialMenu("Update Contact Persons",' ',6,"UpdContactAddrCUDsm");
  if (GuiType==kGuiCocoa) then begin
    SpecialMenu("Copy to local address book",' ',7,"CopyToLocalAddressBookDsm");
  end;
  if (GuiType==kGuiiPhone) then begin
    SpecialMenu("Change Password",' ',1,"ChangePasswdCUDsm");
  end;
  SpecialMenu("Create a loyalty card",' ',1,"CreateLoyaltyCardDsm"); // Edit ************************** Tuesday, 1 April 2014 14:30:37
  EndWindow;
end;

window RebDClass:2
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,l,v,vs;
  WindowBegin("Discount Matrix",RebDClass,CGview,RebView);
  UseView(RebVc);
  SetWRect(20,80,647,333);
  Sizeable(-1,-1,-1,0);
  vs=20;
  Tile(0,40,false,"",Code);
  EditField(h=90,v=6,50,"Code",Normal ,Code,false,0);
  EditField(230,v,-40,"Comment",Normal,Comment,false,0);
  EditField(h,v+=vs,80,"Period",Normal,FromDate,false,PasteCurDate);
  EditField(230,v,80,"-",Normal,ToDate,false,PasteCurDate);
  EditField(440,v,-40,"Replace",Normal,Replaces,false,RebSClass);
  TileButtons(v,2);
  Tile(1,110,false,"1",StaffCode);
  h = 110; h1 = 200; h2 = 300; vs = 20;
  EditField(h,v=6,50,"Qty Dep. Disc.",Normal,StaffCode,false,StaffSClass);
  EditField(h,v+=vs,50,"Column 0",Normal,vra0,false,0);
  EditField(h,v+=vs,50,"Column 1",Normal,vra1,false,0);
  EditField(h1,v,50,"2",Normal,vra2,false,0);
  EditField(h2,v,50,"3",Normal,vra3,false,0);
  EditField(h,v+=vs,50,"Column 4",Normal,vra4,false,0);
  EditField(h1,v,50,"5",Normal,vra5,false,0);
  EditField(h2,v,50,"6",Normal,vra6,false,0);
  EditField(h,v+=vs,50,"Column 7",Normal,vra7,false,0);
  EditField(h1,v,50,"8",Normal,vra8,false,0);
  EditField(h2,v,50,"9",Normal,vra9,false,0);
  Tile(2,120,true,"2",Math);
  StaticText(h=46,v=27,"Item",false);
  StaticText(h+=64,v=27,"Item",false);
  StaticText(h+=69,v,"Qty Dep",false);
  StaticText(248,v,"Column",false);
  h = 10; v=v+20; l = 30;
  MatrixBegin(h,v,h+240+11*l,-10,-,200);
  MatCol(1,h=30,"Code",0,CodeType,false,SetSClass);
  MatCol(1,h=94,"Group",0,ITCode,false,ITSClass);
  MatCol(1,h+=70,"Discount",0,StaffCode,false,StaffSClass);
  MatCol(1,h+=70,"0",0,vra0,false,0);
  MatCol(1,h+=l,"1",0,vra1,false,0);
  MatCol(1,h+=l,"2",0,vra2,false,0);
  MatCol(1,h+=l,"3",0,vra3,false,0);
  MatCol(1,h+=l,"4",0,vra4,false,0);
  MatCol(1,h+=l,"5",0,vra5,false,0);
  MatCol(1,h+=l,"6",0,vra6,false,0);
  MatCol(1,h+=l,"7",0,vra7,false,0);
  MatCol(1,h+=l,"8",0,vra8,false,0);
  MatCol(1,h+=l,"9",0,vra9,false,0);
  EndMatrix;
/*  noone uses this one
  Tile(3,70,false,"3",DiscAcc);
  EditField(h=150,v=6,50,"Discount Account",Normal,DiscAcc,false,AccSClass);
  EditField(h,v+=20,50,"Discount Percent",Normal,DiscPerc,false,0);
  EditField(h,v+=20,50,"#VAT# Code",Normal,VATCode,false,VATCodeSClass);
*/  
  EndWindow;
end;  

window LoyPointRedeemDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,v,vs;
  WindowBegin("Loyalty Points Redemption",LoyPointRedeemDClass,CGview,-);
  UseView(LoyPointsRedeemVc);
  SetWRect(20,80,470,457);
  v = 20; h=70; h2 = h + 150; h3 = h + 281; vs=20;
  EditField(h,v=6,80,"Card Level",Normal,LCMLevel,false,LCMemberLevelSClass);
  EditField(h2,v, 60,"Points",Normal,Points,true,0);
  EditField(h3,v, 60,"Amount",Normal,Amount,true,0);
  EditField(h,v+=vs, -40,"Comment",Normal,Comment,false,0);
  CheckBox(h,v+=vs,0,"Calculate payment before adding discount",PayBefReb);// Edit ************************** Tuesday, 26 February 2013 10:13:11
  MatrixBegin(h=8,v+=40,-31,-10,-,199);
  MatCol(1,32,"Code",0,CodeType,false,SetSClass);
  MatCol(1,104,"Group",0,ITCode,false,ITSClass);
  MatCol(1,194,"Points",0,Points,true,0);
  MatCol(1,274,"Amount",0,Amount,true,0);
  EndMatrix;
  EndWindow;
end;

window LocLoyPointRedeemDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,v,vs;
  WindowBegin("Loyalty Points Redemption per Location",LocLoyPointRedeemDClass,CGview,-);
  UseView(LocLoyPointsRedeemVc);
  SetWRect(20,80,470,457);
  v = 20; h=70; h2 = h + 150; h3 = h + 341; vs=20;
  EditField(h,v=6, 60,"Location",Normal,Location,false,LocationSClass);
  EditField(h2,v,80,"Card Level",Normal,LCMLevel,false,LCMemberLevelSClass);
  EditField(h,v+=vs, 60,"Points",Normal,Points,true,0);
  EditField(h2,v, 80,"Amount",Normal,Amount,true,0);
  EditField(h,v+=vs, -40,"Comment",Normal,Comment,false,0);
  CheckBox(h,v+=vs,0,"Calculate payment before adding discount",PayBefReb);// Edit ************************** Tuesday, 26 February 2013 10:13:11
  MatrixBegin(h=8,v+=40,-31,-10,-,199);
  MatCol(1,32,"Code",0,CodeType,false,SetSClass);
  MatCol(1,104,"Group",0,ITCode,false,ITSClass);
  MatCol(1,194,"Points",0,Points,true,0);
  MatCol(1,274,"Amount",0,Amount,true,0);
  EndMatrix;
  EndWindow;
end;

window LoyaltyPaymentNPTSSClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,h4,hm,l,v,v3,vm,vs;
  WindowBegin("Loyalty Points Payment",LoyaltyPaymentNPTSSClass,CGother,RcType);
  UseView(RcVc);
  SetWRect(80,200,600,480);
  vs = 20;
  EditFieldTLX(h=140,v=6,150,"Balance",M4Val,Normal,100,30,patM4black,vals1,true,0);
  EditFieldTLX(h,v+=40,150,"Points",M4Val,Normal,100,30,patM4black,vals0,true,0);
	v=v+40;
  EditFieldTLX(h,v+=40,150,"Will be credited as",M4Val,viewonly,100,30,patM4black,vals2,true,0);
  v3 = 33; vs = 37; h3 = 210; h4 = 400; hm = 330;

  vm = -160; vs = 52; h2 = 55; v3 = 48; l = 57;

  v = 10;
  ColourPushButton(-450,v+4*vs,-450+2*h2,v+4*vs+v3,"CancelAndOverrideLogout","Cancel<BR>F2",20);
  ColourPushButton(-320,v+4*vs,-320+2*h2,v+4*vs+v3,"ProceedLoyaltyPaymentNPTSSClass","Proceed<BR>F1",20);


  /*vm = -160; l = 57;
  v = 10;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad1","1_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad2","2_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad3","3_",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad4","4_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad5","5_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad6","6_",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad7","7_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad8","8_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad9","9_",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyDel","Del",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad0","0_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"IVDClassToolKeyPadPoint",".",2);
  v = v+vs;
  h = hm; ColourPushButton(h,v,h+3*h2,v+v3,"NPTSPaymentToolKeyEnter","Enter",2);*/
  EndWindow;
end;

window LoyaltyCardLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Loyalty Cards",LoyaltyCardLClass,CGmlist,-);
  SetWRect(64,80,749,298);
  SpawnClass(LoyaltyCardDClass);
  Sizeable(-1,-1,0,0);
  UseView(LoyaltyCardVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"No.",SerNr,false,SerNr);
  RlColKey(84,84,"Customer",CustCode,false,CustCode);
  RlColKey(164,164,"Name",CustName,false,CustName);
  RlCol(-240,-240,"Start Date",StartDate,true);
  RlCol(-160,-160,"Expiry Date",ExpiryDate,true);
  RlColKey(-80,-80,"Points To",PointsTo,true,PointsTo);
  SearchField("Search");
  EndWindow;
end;

window LoyaltyCardDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,v,vm,vs;
  WindowBegin("Loyalty Card",LoyaltyCardDClass,CGview,-);
  SetWRect(64,80,640,230);
  FormName(LoyaltyCardForm);
  UseView(LoyaltyCardVc);
  ActiveFieldOnNew("CustCode");
  v = 16; vs = 20; h = 120; h2 = 300; h3 = 440;
  EditField(h,vm=v, 150,"No.",St_i,SerNr,false,0);
  EditField(h,v+=20,80, "Customer",Normal,CustCode,false,CUSClass);
  EnterSkip(StartDate);
   EditField(h2,v,-40, "Name",Normal,CustName,false,0);
  EditField(h,v+=20,70,"Start Date",Normal,StartDate,false,PasteCurDate);
  EditField(h2,v,70,"Expiry Date",Normal,ExpiryDate,false,PasteCurDate);
  EditField(h,v+=20,80,"Membership Level",Normal,LCMLevel,false,LCMemberLevelSClass);
  if(usercanaction("AllowChangeLoyaltyPoints",false))then begin
  		EditField(h2,v,70,"Accum. Points",Normal,PointsBalance,true,0);// Edit ************************** Wednesday, 27 February 2013 10:06:26
  end else begin
  		EditField(h2,v,70,"Accum. Points",viewonly,PointsBalance,true,0);
  end;
EditField(h3,v,-40,"Points To",Normal,PointsTo,false,LoyaltyCardSClass);
  CheckBox(h,v+=20,0,"Closed",Closed);
  EndWindow;
end;

window PLLClass:2
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Prices",PLLClass,CGmlist,-);
  SpawnClass(PLDClass);
  SetWRect(64,80,609,320);
  Sizeable(-1,-1,0,0);
  UseView(PLVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,2,"Item",ArtCode,false,ArtCode);
  RlColKey(100,100, "Price List",PLCode,false,PLCode);
  RlCol(180,180,"Customer",CustCode,false);
  RlColKey(270,270, "Comment",Comment,false,Comment);
  RlCol(-115,-30,"Price",ExVatPrice,true);
  SearchField("Search");
  EndWindow;
end;

window PLDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vm,vs;
  WindowBegin("Price",PLDClass,CGview,-);
  SetWRect(64,80,509,330);
  UseView(PLVc);
  v = 10; vs = 20; h = 120;
	EditField(h,v, 100,"Item",Normal,ArtCode,false,INSClass);
	EditField(h+200,v, 100,"Serial No.",Normal,SerialNr,false,SerialNrSClass);// Edit ************************** Friday, 22 March 2013 10:14:04
	EditField(h+200,v+vs,50,"Curency",Normal,CurncyCode,false,CurncyCodeSClass);
   EditField(h,v+=vs,50,"Price List",Normal,PLCode,false,PLDefSClass);
  EditField(h,v+=vs,307,"Comment",Normal,Comment,false,0);
  EditField(h,v+=vs ,70,"Price",Normal,ExVatPrice,true,0);
  if (HasModNL) then begin
    EditField(h,vm=(v+=vs),70,"Sales A/C",Normal,SalesAcc,false,AccSClass);
  end;
//  EditField(h,v+=vs,70,"#VAT# Code",Normal,VATCode,false,VATCodeSClass);
  if (IsEnterprise or HasStandardCRM) then begin
    EditField(h,v+=vs,70,"Customer",Normal,CustCode,false,CUSClass);
  end;
  if (IsEnterprise) then begin
    EditField(h,v+=vs ,70,"Cost Price",Normal,CostPrice,true,0);
    EditField(h,v+=20,70,"BuyBack Accr. A/C",Normal,BBVarAcc,false,AccSClass);
  end;
  if (IsEnterprise or HasStandardCRM) then begin
    CheckBox(80,v+=30,0,"Use this price, don't use any other Pricing Calculations",NoOtherPricing);
    CheckBox(80,v+=16,0,"Do not Recalculate",DonotRecalculate);
  end;
  if (IsEnterprise) then begin
    CheckBox(80,v+=16,0,"Generate BuyBack Transaction",BBGenTrans);
  end;
  EndWindow;
end;

window StockMovDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,v,vm,vs;
  Integer tilenr,f,flipnr;
  
  WindowBegin("#Stock# Movement",StockMovDClass,CGview,-);
  if (HasJewelleryInterface) then begin
    SetWRect(20,80,850,400);
  end else begin
    SetWRect(20,80,700,400);
  end;
  Sizeable(-1,-1,0,0);
  UseView(StockMovVc);
  ActiveFieldOnNew("SentTransDate");      
  Tile(0,90,false,"",TransDate);
  v = 6; vs = 20; h = 110; h2 = 300; h3 = 500; h4 = 620;
  EditField(h,v,80, "No.",Normal,SerNr,false,TSerSClass);
  CheckBox(h2,v,0,"Reserved",Reserved);
  EditField(h3,v,80,"Reason",Normal,Reason,false,StandProblemsSClass);
  EditField(h,v+=vs,80,"Ord. Date",Normal,OrdTransDate,false,PasteCurDate);
  EditField(h2,v,80,"Sent Date",Normal,SentTransDate,false,PasteCurDate);
  EditField(h3,v,80,"Received Date",Normal,TransDate,false,PasteCurDate);
    EditField(h,v+=vs,80, "From Location",Normal,FrLocation,false,LocationSClass);
    EditField(h2,v,80,"Via Location",Normal,ThrouLocation,false,LocationSClass);
    EditField(h3,v,80,"AAA Location",Normal,ToLocation,false,LocationSClass);
  CheckBox(h4,v,0,"Not for reports",NotForReport);  	//Edit----------------------Dima  01.04.2015
  tilenr = 1;
  if (IsEnterprise) or (HasATOL==false) then begin 
    TileButton(tilenr,"Positions"); tilenr = tilenr + 1;
  end;
  if (HasObjects) then begin
    TileButton(tilenr,"Objects"); tilenr = tilenr + 1;
  end else begin
    TileButton(tilenr,"Comment"); tilenr = tilenr + 1;
  end;
  TileButton(tilenr,"Items"); tilenr = tilenr + 1;
  if (HasMultiCurrency or HasBase2) then begin
    TileButton(tilenr,"Currency"); tilenr = tilenr + 1;
  end;
  TileButton(tilenr,"Durations"); tilenr = tilenr + 1;
  TileButton(tilenr,"Freight"); tilenr = tilenr + 1;
  tilenr = 1;
  if (IsEnterprise) or (HasATOL==false) then begin 
    Tile(tilenr,60,false,tilenr,FrPos); tilenr = tilenr + 1;
    EditField(h,v=6,80, "From Position",Normal,FrPos,false,UsedPosSClass);
    EditField(h2,v,80,"To Position",Normal,ToPos,false,FreePosSClass);
    EditField(h3,v,80,"For Production",Normal,ProdSerNr,false,ProdSClass);
    EditField(h3,v+=vs,150,"Route",Normal,Sorting,false,DelRouteSClass);
    CheckBox(h,v,0,"Manual Pick",ManualPick);
    CheckBox(h,v+=16,0,"Send To Forklift Queue",ToForkLiftQue);
  end;
  Tile(tilenr,70,false,tilenr,Comment); tilenr = tilenr + 1;
  v = 6;
  if (HasObjects) then begin
    EditField(h,v,-20,"Objects",Normal,Objects,false,ObjSClass);
    v = v + vs;
  end;
  EditField(h,v,-20,"Comment",Normal,Comment,false,0);
  EditField(h,v+=vs,135,"Official Ser. No.",Normal,OfficialSerNr,false,LegalInvNrSClass);
  EnterSkip(Math);
  Tile(tilenr,79,true,tilenr,Math); tilenr = tilenr + 1;
  v = 24;
  MatrixBegin(4,v,-50,-50,-,199);  
  Flip(0);
  flipnr = 1;
  if (HasJewelleryInterface) then begin
    MatCol(1,24,"Serial No.",0,SerialNr,false,SerialNrSClass);
    EnterSkip(Quant);
    MatCol(1,130,"Item",0,ArtCode,false,INSClass);
    Flip(flipnr); flipnr = flipnr + 1;
    if (HasVarieties) then begin
      MatCol(1,200,"Req. Qty",0,OrdQuant,true,MATVARINSClass);
    end else begin
      MatCol(1,200,"Req. Qty",0,OrdQuant,true,0);
    end;
    MatCol(1,250,"Sent Qty",0,SentQuant,true,0);
    MatCol(1,300,"Rcvd. Qty",0,Quant,true,0);
    MatCol(1,350,"Description",0,Spec,false,0);
  end else begin
    MatCol(1,24,"Item",0,ArtCode,false,INSClass);
    Flip(flipnr);  flipnr = flipnr + 1;
    if (HasVarieties) then begin
      MatCol(1,86,"Req. Qty",0,OrdQuant,true,MATVARINSClass);
    end else begin
      MatCol(1,86,"Req. Qty",0,OrdQuant,true,0);
    end;
    MatCol(1,148,"Sent Qty",0,SentQuant,true,0);
    MatCol(1,210,"Rcvd. Qty",0,Quant,true,0);
    MatCol(1,272,"Description",0,Spec,false,0);
  end;
  MatCol(1,-260,"R. Old Unit Pr.",0,OldPrice,true,0);
  MatCol(1,-160,"R. Extra Cost",0,ExtraSCost,true,0);
  MatCol(1,-80,"R. New Unit Pr.",0,NewPrice,true,0);
  Flip(flipnr); flipnr = flipnr + 1;
  if (HasVarieties) then begin
    MatCol(1,86,"Req. Qty",0,OrdQuant,true,MATVARINSClass);
  end else begin
    MatCol(1,86,"Req. Qty",0,OrdQuant,true,0);
  end;
  MatCol(1,148,"Sent Qty",0,SentQuant,true,0);
  MatCol(1,210,"Rcvd. Qty",0,Quant,true,0);
  MatCol(1,272,"Description",0,Spec,false,0);
  MatCol(1,-260,"#S.# Old Unit Pr.",0,SentOldPrice,true,0);
  MatCol(1,-160,"#S.# Extra Cost",0,SentExtraSCost,true,0);
  MatCol(1,-80,"#S.# New Unit Pr.",0,SentNewPrice,true,0);
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,86,"Description",0,Spec,false,0);
  if (HasObjects) then begin
    MatCol(1,-380,"Objects",0,Objects,false,ObjSClass);
  end;
  if (HasSerialNumbers) then begin
    MatCol(1,-280,"Serial No.",0,SerialNr,false,SerialNrSClass);
  end;
  MatCol(1,-140,"Base Price",0,BasePrice,true,0);
  MatCol(1,-40,"Coeff",0,Coefficient,false,0);
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,86,"Description",0,Spec,false,0);
  if (HasSerialNumbers) then begin
    MatCol(1,-280,"Serial No.",0,SerialNr,false,SerialNrSClass);
  end;
  MatCol(1,-135,"Width",0,UnitXval,true,0);
  MatCol(1,-90,"Height",0,UnitYval,true,0);
  MatCol(1,-45,"Depth",0,UnitZval,true,0);
  if (IsEnterprise) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,86,"Description",0,Spec,false,0);
    MatCol(1,-180,"From Position",0,FrPosCode,false,UsedPosSClass);
    MatCol(1,-90,"To Position",0,ToPosCode,false,FreePosSClass);
  end;
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = 18; 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1)); 
      v = v + vs;
    end;
  end;
  CheckBox(20,-52,0,"Confirmed",OrdFlag);
  CheckBox(20,-36,0,"Sent",SentOKFlag);
  CheckBox(20,-20,0,"Received",OKFlag);
  EditField(170,-20,62,"Sent Qty",Normal,TotSentQty,true,0);
  EditField(310,-20,62,"Rcvd. Qty",Normal,TotQty,true,0);
  EditField(550,-20,100,"Non Accounted Extra Costs",Normal,OtherExtraCosts,false,0);
  if (HasMultiCurrency or HasBase2) then begin
    Tile(tilenr,70,false,tilenr,FrRate); tilenr = tilenr + 1;
    h1 = 110; vs = 20;
    if (HasBase2) then begin
      h1 = h1 + 20;
    end;
    EditField(h1,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
    if (HasMultiCurrency) then begin
      EditField(h2,v,50,"Rate",Normal,FrRate,true,0);
      EditField(h2+65,v,50,":",Normal,ToRateB1,true,0);
      if (HasBase2) then begin
        StaticText(h2+125,v+14,"Base Currency 1",false);
        EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
        EditField(h2+65,v,50,":",Normal,ToRateB2,true,0);
        StaticText(h2+125,v+14,"Base Currency 2",false);
        EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
      end else begin
        StaticText(h2+125,v+14,"Base Currency",false);
      end;
    end else begin
      EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
      EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
    end;
  end;
  Tile(tilenr,110,false,tilenr,PlanSendDate); tilenr = tilenr + 1;
  vs = 20; h1 = 130; h2 = 340; h3 = 590;//##cc 
  EditField(h,v=6,80,"Plan. Sent Date",Normal,PlanSendDate,false,PasteCurDate);
  EnterSkip(PlanSendTime);
  EditField(h2,v,40,"Plan. Duration Days",ViewOnly,PlanDurationDays,false,0);
  EditField(h,v+=vs,80,"Plan. Sent Time",Normal,PlanSendTime,false,PasteCurTime);
  EnterSkip(PlanArrDate);
  EditField(h2,v,80,"Plan. Duration Hours",ViewOnly,PlanDurationTime,false,0);
  EditField(h3,v=6,80,"Plan. Arrival Date",Normal,PlanArrDate,false,PasteCurDate);
  EditField(h3,v+=vs,80,"Plan. Arrival Time",Normal,PlanArrTime,false,PasteCurTime);
  EditField(h,vm=(v+=32),80,"Actual Sent Date",Normal,ActSendDate,false,PasteCurDate);
  EnterSkip(ActSendTime);
  EditField(h2,v,40,"Actual Duration Days",ViewOnly,ActDurationDays,false,0);
  EditField(h,v+=vs,80,"Actual Sent Time",Normal,ActSendTime,false,PasteCurTime);
  EnterSkip(ActArrDate);
  EditField(h2,v,80,"Actual Duration Hours",ViewOnly,ActDurationTime,false,0);
  EditField(h3,v=vm,80,"Actual Arrival Date",Normal,ActArrDate,false,PasteCurDate);
  EditField(h3,v+=vs,80,"Actual Arrival Time",Normal,ActArrTime,false,PasteCurTime);
  Tile(tilenr,110,false,tilenr,FreightCode); tilenr = tilenr + 1;
  vs = 20; h2 = 255; 
  EditField(h=130,v=6,60,"Freight Company",Normal,FreightCode,false,FreightCompanySClass);
  EditField(h2,v,-40,"#Reg. No.#",Normal,FreightCompanyRegNr,false,0);
  EditField(h,v+=vs,-40,"Name",Normal,FreightCompany,false,0);
  EditField(h,v+=vs,-40,"Truck Information",Normal,TruckInfo,false,0);
  EditField(h,v+=vs,-40,"Driver",Normal,Driver,false,0);
  EditField(h,v+=vs,-40,"CMR",Normal,CMRText,false,0);
  SpecialMenu("Cost Price in Old Unit Price",'=',0,"StockMovFillFIFODsm");
  SpecialMenu("Item Status",'I',1,"ItemStatusStockMovDsm");
  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  if (HasModNL) then begin
    SpecialMenu("Open #NL# Transaction Sent",' ',2,"OpenTRFromStockMovSent");
    SpecialMenu("Open #NL# Transaction Received",'t',3,"OpenTRFromStockMov");
  end;
  if (IsEnterprise) then begin 
  SpecialMenu("Quality Control",'u',2,"QualConFromStockMovDsm");
  SpecialMenu("Retail prices of goods",' ',2,"StockMovPricingDsm");
  SpecialMenu("Migration Status",' ',2,"StockMovCostSumDsm");
  if(usercanaction("AllowBackStockMov",false))then begin
		SpecialMenu("Create a reverse movement",'',2,"BackStockMovDsm");// Edit ************************** Thursday, 28 March 2013 17:03:51
  end;
  SpecialMenu("Pack List",' ',8,"PackListSMDsm");// Edit ************************** Tuesday, 1 October 2013 10:56:40
  SpecialMenu("Track report",' ',8,"PackListReportDsm");
  end;
  EndWindow;
end;

window BackStockMovVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  string 255 label;
  WindowBegin("Create a reverse movement",BackStockMovVClass,CGMnt,RcType);
  SetWRect(20,100,400,300);
  v = 6; vs = 20; h = 150;
  EditFieldTL(h,v, 80,"Date",M4Date,Normal,10,d1,false,PasteCurDate);
  EndWindow;
end;

window AmendLineNPTSSClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,h4,hm,l,v,v3,vm,vs;
  WindowBegin("Amend Line",AmendLineNPTSSClass,CGother,RcType);
//  Modality(kModalityGlobal);
  UseView(RcVc);
  SetWRect(80,200,700,520);
  vs = 20;
  EditFieldTL(h=100,v=6,70,"Item",M4UStr,ViewOnly,20,AccStr,false,0);
  EditFieldTL(h,v+=vs,-20,"Name",M4Str,Normal,255,f1,false,0);
  EditFieldTL(h,v+=vs,70,"Qty",M423Val,Normal,0,vals0,true,0);
  if(usercanaction("AllowEditPOSRowIV",true))then begin
		EditFieldTL(h,v+=vs,70,"Price",M4Val,Normal,0,vals1,true,0);
  EditFieldTL(h,v+=vs,70,"Discount",M41Val,Normal,0,vals2,true,0);
  EditFieldTL(h,v+=vs,70,"Sum",M4Val,Normal,0,vals3,true,0);
  end else begin
		EditFieldTL(h,v+=vs,70,"Price",M4Val,ViewOnly,0,vals1,true,0);
		EditFieldTL(h,v+=vs,70,"Discount",M41Val,ViewOnly,0,vals2,true,0);
		EditFieldTL(h,v+=vs,70,"Sum",M4Val,ViewOnly,0,vals3,true,0);

  end;

  v = -385; h2 = 55; v3 = 48; vs = 52;
  ColourPushButton(-580,-60,-580+3*h2,-60+v3,"CancelAndOverrideLogout","Cancel",20);
  ColourPushButton(-410,-60,-410+3*h2,-60+v3,"ProceedAmendLineNPTSSClass","Procceed",20);

//  ColourPushButton(h=10,v=-50,h+100,v+40,"CancelAndOverrideLogout","Cancel<BR>F2",20);
//  ColourPushButton(h+=120,v,h+100,v+40,"ProceedAmendLineNPTSSClass","Proceed<BR>F1",20);
//  ColourPushButton(h+=120,v,h+100,v+40,"CashPayTouchScreenKeypad","Keypad<BR>F3",2);

  hm = 383;

  h2 = 80; v3 = 33; vs = 37; h3 = 210; h4 = 400;

  vm = -160; vs = 52; h2 = 55; v3 = 48; l = 57;
  v = v + 117+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad1","1_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad2","2_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad3","3_",2);
  h = h+l+10; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyDel","Del",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad4","4_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad5","5_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad6","6_",2);
  h = h+l+10; ColourPushButton(h,v,h+h2,v+3*v3+8,"NPTSPaymentToolKeyEnter","OK",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad7","7_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad8","8_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad9","9_",2);
  v = v+vs;
  h = hm-2; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPM","+/-",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"NPTSPaymentToolKeyPad0","0_",2);
  h = h+l; ColourPushButton(h,v,h+h2,v+v3,"IVDClassToolKeyPadPoint",".",2);

  EndWindow;
end;

window IVDClass:1
  wtag("language","ENG"), wtag("product","TravellingSaleman"), wtag("productcode","MobileSalesman"), wtag("device","iPad")
begin
  real h,h1,h2,h3,h4,hof,hs,l,l2,l3,t,v,vm,vs;
  WindowBegin("Invoice",IVDClass,CGview,-);
  SetWRect(20,80,560,350);
  Sizeable(-1,-1,0,0);
  UseView(IVVc);
  ActiveFieldOnNew("CustCode");    
  //CommunicateButton;
  Tile(0,74,false,"",CustCode);
  vs = 40; h1 = 15;  
  EditField(h1,vm=(v=6),180,"No.",Normal,SerNr,false,TSerSClass);
  EditField(h1,v+=vs,180,"Customer1",Normal,CustCode,false,CUSClass);
  EnterSkip(PayDeal);
  EditField(h=225,v=vm,150,"Official No.",Normal,OfficialSerNr,false,LegalInvNrSClass);
  CheckBox(-112,v+2,0,"Disputed",DisputedFlag);
  EditField(h=225,vm=(v+=vs),-20,"Name",Normal,Addr0,false,0);

  h2 = 290; h3 = 550; h4 = -132; l = 240; l2 = 225; l3 = 200;
  EditField(h1,vm=(v+=vs+20),l,"Invoice Date",Normal,InvDate,false,PasteCurDate);
  EditField(h1,v+=vs,l,"Payment Terms",Normal,PayDeal,false,PDSClass);
  EditField(h1,v+=vs,l,"Due Date",Normal,PayDate,false,PasteCurDate);
  EditField(h1,v+=vs,l,"Trans. Date",Normal,TransDate,false,PasteCurDate);
  EditField(h2,v=vm,l2,"Our Reference",Normal,OurContact,false,0);
  EditField(h2,v+=vs,l2,"Attention",Normal,ClientContact,false,ContactSClass);
  EditField(h2,v+=vs,l2,"Objects",Normal,Objects,false,ObjSClass);
  EditField(h2,v+=vs,l2,"Reference",Normal,RefStr,false,0);
  EditField(h2,v+=vs,l2,"Cust. Ord. No.",Normal,CustOrdNr,false,0);
  EditField(h3,v=vm,l3,"#Salesman#",Normal,SalesMan,false,UserSClass);
  EditField(h3,v+=vs,l3,"Project",Normal,PRCode,false,PRSClass);
  v = v + vs + vs + vs;
  
  h1 = 20; hof = 105; hs = hof + 20; 
  ColourPushButton(h1,v=v+vs+20,h1+hof,v+45,"IVDClassOpenCurrency","Currency",4);
  ColourPushButton(h1+=hs,v,h1+hof,v+45,"IVDClassOpenDelTerms","Delivery Terms",4);
  ColourPushButton(h1+=hs,v,h1+hof,v+45,"IVDClassOpenIdentifiers","Identifiers",4);
  ColourPushButton(h1+=hs,v,h1+hof,v+45,"IVDClassOpenPriceList","Price List",4);
  ColourPushButton(h1+=hs,v,h1+hof,v+45,"IVDClassOpenInvAddress","Invoice Address",4);
  ColourPushButton(h1+=hs,v,h1+hof,v+45,"IVDClassOpenDelAddress","Delivery Address",4);
  MatrixBegin(0,v=v+=vs+vs,-1,-100,-,200);
  MatTypedRow(stp);
  t = kInvoiceRowTypeNormal;
  //F0
  MatCell(t,10,6,90,19,ArtCode,false,12,patM4black);
  MatCell(t,100,6,150,19,Quant,false,12,patM4black);
  //F1
  MatCell(t,160,6,430,19,Spec,false,12,patM4black);
  MatCell(t,10,26,90,39,Price,true,12,patM4black);
  MatCell(t,100,26,240,39,vRebate,true,12,patM4black);
  MatCell(t,250,26,370,39,Sum,true,12,patM4black);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  l = 130;
  EditField(15,v=-87,l+15,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  CheckBox(67,v+vs+2,0,"OK",OKFlag);
  if (UserCanAction("ViewCostPrice",true)) then begin
    //EditField(175,v,l,"GP %",Normal,GPProc,true,0);
    EditField(175,v+vs,l,"Total GP",ViewOnly,TotGP,false,0);
  end;
  EditField(320,v,l,"TAX2",ViewOnly,TAX2Sum,true,0);
  EditField(320,v+vs,l,"Ext. Tax",ViewOnly,TAX1Sum,true,0);
  EditField(465,v,l,"#VAT#",ViewOnly ,Sum3,true,0);
  EditField(465,v+vs,l,"Base",ViewOnly,BaseSum4,true,0);
  EditField(-150,v,l,"Subtotal",ViewOnly,Sum1,true,0);
  EditField(-150,v+vs,l,"TOTAL",ViewOnly,Sum4,true,0);
  SpecialMenu("Item Status",'I',0,"ItemStatusIVDsm");
//  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  SpecialMenu("Invoice Status",'r',2,"IVInfoIVDsm");
//  SpecialMenu("Previous Sales Prices",' ',15,"IVLastSPrsm");
//  SpecialMenu("Add Header Line",' ',12,"HeaderLineIVDsm");
//  SpecialMenu("Add Hidden Line",' ',12,"HiddenLineIVDsm");
//  SpecialMenu("Add Environment Tax",' ',19,"RepaIVsm");
//  SpecialMenu("Add Retention",' ',25,"RetentionLineIVDsm"); 
//  SpecialMenu("Add Subtotal",' ',12,"SubTotalLineIVDsm");
  SpecialMenu("Send for Approval",' ',6,"IVSendforAcceptanceIVDsm");
  SpecialMenu("Cancel Approval Request",' ',2,"CancelApprovalRequestDsm");
//  SpecialMenu("Change to Base 1",' ',14,"SwitchToBase1IVDsm");
  SpecialMenu("Connect to Prepayment",' ',4,"ConnectToPrepayIVDsm");
  SpecialMenu("Recalculate Discount",' ',11,"RecalcDiscountIVDsm");
  SpecialMenu("Recalculate Weight and Volume",' ',10,"RecalcWeightIVDsm");
//  SpecialMenu("Update Currency Price List Items",' ',5,"UpdatePricesIVDsm");
//  SpecialMenu("Print Cash IN-OUT",' ',7,"PrintCashInOutIVDsm");
//  SpecialMenu("Print Proforma Invoice",' ',3,"PrintProformaIVDsm");
//  SpecialMenu("Send to Fiscal Device",' ',19,"PrintToFiscPrntIVDsm");
  SpecialMenu("Credit Card Payment",' ',22,"CCPayIVDsm");
  SpecialMenu("Edit #Instalments#",' ',24,"EditInstalmentIVDsm");
//  SpecialMenu("Resend E-Invoice",' ',21,"ResendEIVDsm");
//  SpecialMenu("Send/Resend Argentinian E-Invoice",'a',17,"SendArgEInvIVDsm");
  SpecialMenu("Open #NL# Transaction",'t',8,"OpenTRFromIV");
  SpecialMenu("Create Cash In",' ',1,"DoCLInFromIVD");
  SpecialMenu("Create #Credit Note#",' ',20,"CreateCreditNoteIVDsm");
//  SpecialMenu("Create Credit Agreement",' ',25,"CreateCredManIVsm");
  SpecialMenu("Create Contract",' ',13,"COFromIVDsm");
  SpecialMenu("Create Correction Invoice",' ',16,"CorrectionIVsm");
//  SpecialMenu("Create EDI Invoice",' ',9,"DoEDIInvFromIVD");
//  SpecialMenu("Create E-Mail",'m',23,"CreateMailFromIVDsm");
//  SpecialMenu("Create First Event",' ',18,"FirstEventIVDsm");
//  SpecialMenu("Create #Instalment# Receipts",' ',6,"CreateInstalmentsIVDsm");
//  SpecialMenu("Create #VAT# Correction #S/L#",' ',17,"VATCorrectionIVsm");
//  SpecialMenu("Manager's Discount Override",' ',24,"MgrsDiscOverrideIVDsm"); 
//  SpecialMenu("Open TAX Matrix",' ',25,"TestVatMatrixIVDsm"); 
////  SpecialMenu("Test Mex E-Invoices",'1',0,"TestMexEInvoices");
  EndWindow;
end;

window IV1LClass:8 //Edit***************************Sasha2,15:52 23.12.2014 {
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Invoices",IV1LClass,CGmlist,-);
    SetWRect(20,80,800,298);
    Sizeable(-1,-1,0,0);
    SpawnClass(IV1DClass);
    UseView(IVVc);
    FormName(PrintIVL);
    RecordList(4,17,-21,-39);
    RlColKey(4,4,"No.",SerNr,false,SerNr);
    RlColKey(79,79,"OK",OKFlag,false,OKFlag);
    RlColKey(111,111,"Invoice Date",InvDate,false,InvDate);
    RlColKey(191,191,"Location",Location,false,Location);    
  RlColKey(301,301,"Order No.",OrderNr,false,OrderNr);
  RlColKey(381,381,"Customer",CustCode,false,CustCode); 
  RlColKey(441,441,"Name",Addr0,false,Name); 
    RlColKey(-110,-110,"Total",Sum4,true,Sum4);
    RlCol(-39,-39,"",CredMark,true);
    RlCol(-30,-30,"Cur.",CurncyCode,true);
    RlCol(-1,-1,"",Invalid,true);
    SearchField("Search");
  if (HasLimitedAccess) then begin 
    BrowseSubsetButton(-40,-15);
  end;
    SpecialMenu("OK",'G',0,"OKIVLsm");
    SpecialMenu("Print Proforma Invoices",' ',1,"PrintIVLsm");
    SpecialMenu("Invoice Status",'r',2,"IVInfoIVLsm");
    EndWindow;
end; //Edit***************************Sasha2,15:52 23.12.2014 }

window IVLClass:8
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Invoices",IVLClass,CGmlist,-);
  SetWRect(20,80,800,298);
  Sizeable(-1,-1,0,0);
  SpawnClass(IVDClass);
  UseView(IVVc);
  FormName(PrintIVL);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"No.",SerNr,false,SerNr);
  RlColKey(79,79,"OK",OKFlag,false,OKFlag);
  RlColKey(111,111,"Invoice Date",InvDate,false,InvDate);
  RlColKey(191,191,"Official No.",OfficialSerNr,false,OfficialSerNr);    
  RlColKey(301,301,"Order No.",OrderNr,false,OrderNr);
  RlColKey(381,381,"Customer",CustCode,false,CustCode);
  RlColKey(441,441,"Name",Addr0,false,Name);
  RlColKey(-110,-110,"Total",Sum4,true,Sum4);
  RlCol(-39,-39,"",CredMark,true);
  RlCol(-30,-30,"Cur.",CurncyCode,true);
  RlCol(-1,-1,"",Invalid,true);
  SearchField("Search");
  if (HasLimitedAccess) then begin 
    BrowseSubsetButton(-40,-15);
  end;
  SpecialMenu("OK",'G',0,"OKIVLsm");
  SpecialMenu("Print Proforma Invoices",' ',1,"PrintIVLsm");
  SpecialMenu("Invoice Status",'r',2,"IVInfoIVLsm");
  
  EndWindow;
end;

window IPDClass:2
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,h4,t,v,vm,vs;
  record CYBlock CYb;
  Integer f,flipnr;

  BlockLoad(CYb);
  WindowBegin("Receipt",IPDClass,CGview,-);
  SetWRect(20,80,700,380);
  Sizeable(-1,-1,0,0);
  UseView(IPVc);
  ActiveFieldOnNew("TransDate");
  h = 100; h2 = 262; h3 = 470;v = 6;
  if (HasNumberSeries) then begin
    EditField(h,v,80,"No.",St_i,SerNr,false,TSerSClass);
  end else begin
    EditField(h,v,80,"No.",St_i,SerNr,false,0);
  end;
  EditField(h2,v,82,"Trans. Date",Normal,TransDate,false,PasteCurDate);
  EnterSkip(PayMode);
  if (IsEnterprise) then begin
    EditField(h3,v,-40,"Reference",Normal,RecNumber,false,0);
  end else begin
    CheckBox(h4=-100,v,0,"OK",OKFlag);
  end;
  EditField(h,v+=20,30,"Payment Mode",Normal,PayMode,false,PMSClass);
  EnterSkip(Math);
  EditField(h2,v,-40,"Comment",Normal,Comment,false,0);
  if (IsEnterprise) then begin
  EditField(h,v+=20,80,"Auth. Code",ViewOnly,AuthorizationCode,false,0);
  EditField(h+150,v,80,"Loc. mashine",Normal,MachineName,false,LocalMachineSClass);
   CheckBox(-300,v,0,"Cust. Info on #N/L# Transaction",ARonTR);
    CheckBox(h4=-100,v,0,"OK",OKFlag); 
  end;
  EnterSkip(Math);
  if (HasMultiCurrency) then begin
	EditField(-267,-21,40,"Currency",Normal,PayCurCode,false,CurncyCodeSClass);
  end;
  EditField(-142,-21,-40,"Deposited",Normal,CurPayVal,true,0);
  h=4; v=81;
  if (IsEnterprise or HasMultiCurrency or (HasLocalization("ENG") and HasModSL)) then begin //!!TRANSLATE
  MatrixBegin(h,v,-50,-24,-,299);
  end else begin
    MatrixBegin(h,v,-30,-24,-,99);
  end;
  vm = v;
  MatTypedRow(stp);
  MatOverStrike(ovst);
  Flip(0);
  if (BuildProductCode=="StandardAccounts") then begin
    if (HasLocalization("POL")) then begin
      MatCol(t=kReceiptRowTypeNormal,30,"Invoice No.",0,InvoiceOfficialSerNr,false,ARSClass);
    end else begin
      MatCol(t=kReceiptRowTypeNormal,30,"Invoice No.",0,InvoiceNr,false,ARSClass);
    end;
  end else begin
    MatCol(t=kReceiptRowTypeNormal,30,"Invoice No.",0,InvoiceNr,false,ARSClass);
  end;
  EnterSkip(RecVal);
  MatCol(t,125,"Customer",0,CustCode,false,CUSClass);
  if (BuildProductCode=="StandardAccounts") then begin
    if (HasLocalization("POL")) then begin
      MatCol(t=kReceiptRowTypeSettlementDiscount,30,"",0,InvoiceOfficialSerNr,false,ARSClass);
    end else begin
  MatCol(t=kReceiptRowTypeSettlementDiscount,30,"",0,InvoiceNr,false,ARSClass);
    end;
  end else begin
    MatCol(t=kReceiptRowTypeSettlementDiscount,30,"",0,InvoiceNr,false,ARSClass); 
  end;
  MatText(t,125,"Set. Disc.",false);
  if (HasObjects) then begin
    MatCol(t,190,"Object",0,Objects,false,ObjSClass);
  end;
  MatCol(t,-390,"I.Cur",0,InvCurncy,true,0);
  MatCol(t,-350,"Invoice Val",0,InvVal,true,0);
  MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
  MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
  MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
  MatCol(t,-90,"Received Value",0,RecVal,true,0);
  if (BuildProductCode=="StandardAccounts") then begin
    if (HasLocalization("POL")) then begin
      EnterSkip(InvoiceOfficialSerNr);
      MatCol(t=kReceiptRowTypeWriteoff,30,"",0,InvoiceOfficialSerNr,false,ARSClass); 
    end else begin
  EnterSkip(InvoiceNr);
  MatCol(t=kReceiptRowTypeWriteoff,30,"",0,InvoiceNr,false,ARSClass);
    end;
  end else begin
    EnterSkip(InvoiceNr);
    MatCol(t=kReceiptRowTypeWriteoff,30,"",0,InvoiceNr,false,ARSClass); 
  end;
  MatText(t,125,"Writeoff",false);
  MatCol(t,-460,"",0,WriteOffAcc,false,AccSClass);
  MatCol(t=kReceiptRowTypeBankFee,30,"",0,InvoiceNr,false,ARSClass);
  MatText(t,105,"Fee",false);
  MatCol(t,-390,"I.Cur",0,InvCurncy,true,0);
  MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
  MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
  MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
  MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
  MatCol(t,-90,"Received Value",0,RecVal,true,0);
  flipnr = 1;
  Flip(flipnr); flipnr = flipnr + 1;
  EnterSkip(PayDate);
  MatCol(t=kReceiptRowTypeNormal,200,"Text",0,CustName,false,0);
  if (IsEnterprise) then begin
    MatCol(t,-350,"Pay. Date",0,PayDate,false,0);
  end;
  if (HasObjects and IsEnterprise==false) then begin
    MatCol(t,190,"Object",0,Objects,false,ObjSClass);
  end;
  EnterSkip(RecVal);
  if (HasMultiCurrency) then begin
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
  end else begin
    MatCol(t,-270,"Open Inv. Value",0,InvOutstand,false,0);
    MatCol(t,-180,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-270,"Open Inv. Value",0,InvOutstand,false,0);
    MatCol(t,-180,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
  end;
  if (HasMultiCurrency) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,190,"Text",0,CustName,false,0);
    MatCol(t,-350,"I. Cur.",0,InvCurncy,true,0);
    MatCol(t,-310,"Open Inv.Value",0,InvOutstand,false,0);
    MatCol(t,-220,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
  end;
  if (IsEnterprise) then begin
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,190,"Text",0,CustName,false,0);
    MatCol(t,-270,"P. Mode",0,PayMode,false,PMSClass);
    MatCol(t,-220,"#Cheque# No.",0,ChequeNr,false,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,190,"Text",0,CustName,false,0);
    MatCol(t,-320,"Order No.",0,OrderNr,false,ORSClass);
    MatCol(t,-230,"Prepayment No.",0,CUPNr,false,ARPaySClass);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,190,"Text",0,CustName,false,0);
    if (CYb.UseTaxTemplatesforTaxCalc!=0) then begin
    MatCol(1,-310,"T-Cd",0,TaxTemplateCode,false,TaxTemplateSClass);
    end else begin
    MatCol(1,-310,"#V-Cd#",0,VATCode,false,VATCodeSClass);
    end;
    MatCol(t,-270,"#VAT# Value",0,VATVal,false,0);
    MatCol(t,-200,"Extra Tax",0,TAX1Sum,false,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,190,"Text",0,CustName,false,0);
    MatCol(t,-260,"Objects",0,Objects,false,ObjSClass);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Rec. Value",0,RecVal,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,190,"Round Off A/C",0,RoundOffAcc,false,AccSClass);
    MatCol(t,-360,"Round Off",0,RoundOff,true,0);
    MatCol(t,-300,"#Instalment#",0,InstNr,false,ARInstallSClass);
    MatCol(t,-170,"Reference Number",0,rkRecNumber,false,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,190,"Debtors A/C",0,ARAcc,false,AccSClass);
    MatCol(t,-320,"Cred. Man. No.",0,CredManNr,false,CredManSClass);
    MatCol(t,-220,"Comment",0,Comment,false,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(t=kReceiptRowTypeNormal,200,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-410,"Bank Amt.",0,BankVal,true,0);
  //  MatCol(t,-340,"Bank Fee",0,BankFeeVal,true,0);
    MatCol(t,-280,"To B. Cur. 1",0,ToRateB1BankVal,true,0);
    MatCol(t,-210,"Bank Amt. in Cur. 1",0,B1BankVal,true,0);
    MatCol(t,-105,"Bank Amt. in Cur. 2",0,B2BankVal,true,0);
  //  MatCol(t,-200,"Fee %",0,BankFeePrc,true,0); /* What was this ?? */
  //  MatCol(t,-70,"Coef. Value",0,Coef,true,0);
    MatCol(t=kReceiptRowTypeWriteoff,-390,"I.Cur",0,InvCurncy,true,0);
    MatCol(t,-350,"Invoice Value",0,InvVal,true,0);
    MatCol(t,-260,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-220,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-130,"R. Cur.",0,RecCurncy,true,CurncyCodeSClass);
    MatCol(t,-90,"Received Value",0,RecVal,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
 MatCol(t=1,-470,"B. Cur.",0,BankCurncy,true,CurncyCodeSClass);
    MatCol(t,-430,"Bank Amount",0,BankVal,true,0);
    MatCol(t,-350,"Rate",0,FrRateBankVal,true,0);
    MatCol(t,-310,"To B. Cur. 1",0,ToRateB1BankVal,true,0);
    MatCol(t,-240,"To B. Cur. 2",0,ToRateB2BankVal,true,0);
    MatCol(t,-170,"Base Rate 1",0,BaseRate1BankVal,true,0);
    MatCol(t,-90,"Base Rate 2",0,BaseRate2BankVal,true,0);
    MatCol(t,-10,"Received Value",0,RecVal,true,0);
  end else begin
    if (BuildProductCode=="StandardAccounts") then begin //!!TRANSLATE
      if (HasLocalization("ENG")) and (HasModSL) then begin //!!TRANSLATE
        Flip(flipnr); flipnr = flipnr + 1;
        MatCol(t=kReceiptRowTypeNormal,190,"Text",0,CustName,false,0); //!!TRANSLATE
        if (HasModSO) then begin
          MatCol(t,-200,"Order No.",0,OrderNr,false,ORSClass); //!!TRANSLATE
        end;
        MatCol(t,-100,"Prepayment No.",0,CUPNr,false,ARPaySClass); //!!TRANSLATE
      end;
    end;
  end;
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 22;
  v = v + 1; 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1)); 
      v = v + vs;
    end;
  end;
  vs = 20;
  if (IsEnterprise) then begin
    SpecialMenu("Add Settlement Discount",' ',0,"CashDiscountIPDsm");
  end;
  SpecialMenu("Add Write-off",' ',1,"NewWriteoffIPDsm");
  if (IsEnterprise) then begin
    SpecialMenu("Add Fee",' ',2,"NewFeeIPDsm");  
    SpecialMenu("Add Withholdings rows",' ',8,"IPPasteWithholdingIPDsm");
    SpecialMenu("Distribute #Cheques#",' ',13,"DistributeChequesIPDsm");
    SpecialMenu("Distribute Receipt",' ',3,"IPExpandIPDsm");
    SpecialMenu("Calculate Amount",'=',4,"CalculateFieldIPDsm");
    SpecialMenu("Write-off Prepayment",' ',5,"WriteofPrepayIPDsm");
    SpecialMenu("Check Receipt Amounts",' ',6,"IPInfoIPDsm");  
  end;
  if (HasModNL) then begin
    SpecialMenu("Open #NL# Transaction",'t',9,"OpenTRFromIP");
  end;
  if (IsEnterprise) then begin
    SpecialMenu("Open TAX Matrix",' ',25,"OpenVatMatrixIPDsm"); 
    SpecialMenu("Create Activity",'c',14,"ActFromIPDsm");
    SpecialMenu("Create Cash In",' ',11,"CLInFromIPDsm");
    SpecialMenu("Create #Cheque#",' ',9,"CreateCheckIPDsm");
    SpecialMenu("Create Down Payment",' ',7,"DownPayFromIPDsm");
    SpecialMenu("Create E-Mail",'m',18,"CreateMailFromIPDsm");
    if (HasLocalization("UKR")) then begin
      SpecialMenu("Create First Event",' ',12,"FirstEventIPDsm");
    end;
  end;
  if (IsEnterprise) or ((HasLocalization("ENG")) and (HasModSO)) then begin
    SpecialMenu("Create Prepayment Invoice",' ',10,"IVFromPrepIPDsm");
  end;
  if (IsEnterprise) then begin
    SpecialMenu("Create #VAT# Correction #S/L#",' ',17,"VATCorrectionIPDsm");
    SpecialMenu("Credit Card Payment",' ',15,"CCPayIPDsm");
    SpecialMenu("Bank Statement",' ',16,"BankStIPDsm");
    SpecialMenu("Print Cash IN-OUT",' ',8,"PrintCashInOutIPDsm");
  end;
  EndWindow;
end;

window PUtoIVVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v;
  WindowBegin("Specify the number of moving",PUtoIVVClass,CGMnt,RcType);
  SetWRect(20,80,450,250);
  EditFieldTL(h+200,v+=20, 82,"Move number",M4Long,Normal,50,long1,false,StockMovSClass);
  EndWindow;
end;

window StockMovSClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Specify the displacement",StockMovSClass,CGslist,-);
  SpawnClass(StockMovDClass);
  SetWRect(20,80,800,298);
  Sizeable(-1,-1,0,0);
  UseView(StockMovVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,  "No.",SerNr,false,SerNr);
  RlColKey(71,71,"Sender.",SentOKFlag,false,SentOKFlag);
  RlColKey(111,111,"Recipient",OKFlag,false,OKFlag);
  RlColKey(151,151,"Shipment date",SentTransDate,false,SentTransDate);
  RlColKey(223,223,"Date of receipt",TransDate,false,TransDate);
  RlColKey(295,295,"From location",FrLocation,false,FrLocOK); 
  RlColKey(450,450,"To location",ToLocation,false,ToLocOK);
  RlColKey(590,590, "Comment",Comment,false,Comment);
  SearchField("Search");
  EndWindow;
end;

window Attach2DClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h4,v,vs;
  WindowBegin("File",Attach2DClass,CGview,Attach2View);
  UseView(Attach2Vc);
  SetWRect(20,80,500,300);
  vs = 20;h = 100;h2 =  330;h4 = 500; v = 6;
  EditField(h,v,100,"Ser. No",St_i,SerNr,false,0);
  EditField(h,v+=vs,200,"Name",St_i,FileName,false,0);
  EditField(h,v+=vs,200,"Filesize",Normal,FileSize,false,0);  
  if (IsEnterprise) then begin
  EditField(h,v+=vs,200,"PackTyp",Normal,PackTyp,false,0);  
  EditField(h,v+=vs,200,"Uploading",Normal,Uploading,false,0);  
  EditField(h,v+=vs,200,"Type",Normal,Type,false,0);  
	EditField(h,v+=vs,200,"Storage",Normal,Storage,false,0);  
  end;
  SpecMenuItem("Download File",' ',mOpsDownloadFile);
  EndWindow;
end;

window ItemStockStatExtWebRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,v,vs,vm;
  WindowBegin("Store balances Report",ItemStockStatExtWebRClass,CGEcW,RcType);
  SetWRect(20,80,440,150);
  vs = 20;
  h=100;h2=250;
  EditFieldTL(h,v+=20,100,"Date",M4Date,Normal,41,d1,false,PasteCurDate);//carefull we run ARRn
  ButtonFrame(h2,vm=35,123,6,"Display in currency"); //Edit***************************Sasha2,13:32 27.04.2015 {
  RadioButton(h2,vm,0,0,"Last purchased",ArtMode);
  RadioButton(h2,vm+=16,1,0,"Base",ArtMode); //Edit***************************Sasha2,13:32 27.04.2015 }
  EditFieldTL(h,v+=20,100,"Item",M4UStr,Normal,41,f1,false,INSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,100,"Location",M4UStr,Normal,41,f2,false,LocationSClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,100,"Classification ",M4UStr,Normal,41,f3,false,DISClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,100,"Brand ",M4UStr,Normal,41,f4,false,DI2SClass);//carefull we run ARRn
  EditFieldTL(h,v+=20,100,"Model ",M4UStr,Normal,41,f5,false,DI3SClass);//carefull we run ARRn
  //EditField(h,v+=vs,-100,"IP",Normal,f6,false,0);
	//HalPushButton(-90,v,-10,v+20,"OstatkiSKartinkamiRn","");
  EndWindow;
end;

window SalesWithImagesRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("Sales Report with pictures",SalesWithImagesRClass,CGEcW,RcType);
  SetWRect(20,80,440,150);
  vs = 20;
  h=100;
  v = 6; vs = 20; h = 120;
  PeriodField(h,v,"Period");
  EditFieldTL(h,v+=vs,150,"Store(location)",M4Str,Normal,41,f1,false,LocationSClass);
  EditFieldTL(h,v+=vs,150,"Classification ",M4Str,Normal,200,f2,false,DISClass);
  EditFieldTL(h,v+=vs,150,"Brand ",M4UStr,Normal,41,f4,false,DI2SClass);//carefull we run ARRn
  //EditFieldTL(h,v+=vs,150,"",M4UStr,Normal,41,f5,false,DI3SClass);//carefull we run ARRn
  //EditField(h,v+=vs,-100,"IP",Normal,f6,false,0);
	//HalPushButton(-90,v,-10,v+20,"ProdajiSKartinkamiRn","");
  EndWindow;
end;

window IN2SClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("Paste Item",IN2SClass,CGSlist,-);
  SetWRect(0,0,920,298+20);
  Sizeable(-1,-1,0,0);
  UseView(INVc);
  SpawnClass(INDClass);
  v = 24; vs = 20;
  
  StaticText(179,v-8,"Items",false);
  StaticText(250,v-8,"Classifications",false);
  StaticText(350,v-8,"$subsetname",false);
  v = v+10;
  
  StringList(9,19,150,-9);
  RecordList(170,39,-21,-39);
  RlColKey(4,4,"Code",Code,false,DICode);
  RlColKey(75,75,"Alt. Code",AlternativeCode,false,DIAlternativeCode);
  RlColKey(220,220,"Name",Name,false,DIName);
  RlColKey(-350,-350,"Classification ",DispGroups,false,0);
  RlCol(-220,-220,"Color ",Colour,false);
  RlCol(-140,-140,"Size ",Size,false);
  CalculatedColumn(-50,-50,"In stock ","INSClassInStock",true); 
  // RlCol(-30,-30,"Price",UPrice1,true);
  h = 6; v = -58;
  HalPushButton(h,v,h+60,v+20,"IN2SClassTop","up");
  h = h+72;
  HalPushButton(h,v,h+60,v+20,"IN2SClassBack","back ");
  
  SearchField("Search ");
  SpecialMenu("Help by product ",'I',0,"INStatusINSsm");
  SpecialMenu("Search ",'F',1,"INSearchSsm");
  SpecialMenu("Substitute products ",'l',2,"AltItemINSsm");
  SpecialMenu("Related Products",'r',2,"CrossItemINSsm");
  EndWindow;
end;

window RebLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Discount Matrices",RebLClass,CGmlist,RebView);
  SpawnClass(RebDClass);
  SetWRect(64,80,509,298);
  Sizeable(-1,-1,0,0);
  UseView(RebVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"Code",Code,false,Code);
  RlCol(75,75, "Comment",Comment,false);
  RlCol(-200,-200, "Replace",Replaces,false);
  RlCol(-150,-150, "From date",FromDate,false);
  RlCol(-75,-75, "To date",ToDate,false);
  SearchField("Search ");
  EndWindow;
end;

window CUNPTDSClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  integer i,rwcnt;
  real h,h1,h2,h3,h4,h5,l,v,vs;
  record NPTSNewCUFieldsBlock NPTSNCUFb;
  row NPTSNewCUFieldsBlock NPTSNCUFbrw;
  WindowBegin("Contact",CUNPTDSClass,CGview,-);
  DynamicWindow;
  SetWRect(20,80,680,441);
  Sizeable(-1,-1,0,0); 
  UseView(CUVc);
  v = 6; h = 130; l=223; vs = 20; h1=410; h2 = 340; h3 = 430; h4 = 580; h5 = 460;
  ActiveFieldOnNew("Code"); //dont change, otherwise automatic address lookup helper window wont show automatically //wns
  
  EditField(h,v ,   95,"Code",Normal,Code,false,TSerSClass);// Edit ************************** Thursday, 24 October 2013 15:16:39
  
  EditField(h,v+=vs,h1-h+50,"Name",Normal,Name,false,0);
	CheckBox(h+350,v=20,0,"Allow SMS",AllowSendSMS);
	CheckBox(h+350,v=v+vs,0,"Allow eMail",AllowSendeMail);
	CheckBox(h+350,v=v+vs,0,"Allow phone",AllowSendCall);
	CheckBox(h+350,v=v+vs,0,"Allow delivery",AllowSendkMail);
	
  BlockLoad(NPTSNCUFb);
  rwcnt = MatRowCnt(NPTSNCUFb);
  for (i=0;i<rwcnt;i=i+1) begin
    MatRowGet(NPTSNCUFb,i,NPTSNCUFbrw);
    EditField2(h,v+=vs,h1-h+50,NPTSNCUFbrw.FieldName,NPTSNCUFbrw.EditState,NPTSNCUFbrw.FieldName,false,0);
  end;
  EndWindow;
end;

window SHDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,t,v,vm,vs;
  Integer tilenr,f,flipnr;

  WindowBegin("Delivery",SHDClass,CGview,-);
  SetWRect(20,80,750,460);
  Sizeable(-1,-1,0,0);
  UseView(SHVc);
  vs = 20;
  Tile(0,74,false,"",SerNr);
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"Customer",ViewOnly,CustCode,false,0);
  EditField(h=255,v=vm,-40,"Name",Normal,Addr0,false,0);
  v = v + vs;
  if (IsEnterprise) then begin
    EditField(h,vm=v,135,"Official No.",Normal,OfficialSerNr,false,LegalInvNrSClass); 
  EditField(h+230,vm,95,"TREO No.",Normal,TREONr,false,0);  
  end;
  CheckBox(h4=-100,v,0,"OK",OKFlag);
  tilenr = 1;
  if (IsEnterprise) then begin
    TileButton(tilenr,"Terms"); tilenr = tilenr + 1;
    TileButton(tilenr,"Items"); tilenr = tilenr + 1;
    TileButton(tilenr,"Del. Terms"); tilenr = tilenr + 1;
    TileButton(tilenr,"Packaging"); tilenr = tilenr + 1;
    TileButton(tilenr,"Freight"); tilenr = tilenr + 1;
    TileButton(tilenr,"Del. Address"); tilenr = tilenr + 1;
    TileButton(tilenr,"Comment"); tilenr = tilenr + 1;
  end else begin
    TileButton(tilenr,"Comment"); tilenr = tilenr + 1;
    TileButton(tilenr,"Items"); tilenr = tilenr + 1;
    TileButton(tilenr,"Address"); tilenr = tilenr + 1;
  end;
  tilenr = 1;
  Tile(tilenr,70,false,tilenr,ShipDate); tilenr = tilenr + 1;
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -100;
  EditField(h1,vm=(v=6),82,"Date",Normal,ShipDate,false,PasteCurDate);
  if (HasMultiLocations) then begin
    v = v + vs;
    EditField(h1,v,82,"Location",Normal,Location,false,LocationSClass);
  end;
  if (IsEnterprise) then begin
    v = v + vs;
    EditField(h1,v,82,"Route",Normal,Sorting,false,DelRouteSClass);
  end;
  if (HasObjects) then begin
    EditField(h2,v=vm,135,"Objects",Normal,Objects,false,ObjSClass);
  end;
  if (IsEnterprise) then begin
    v = v + vs;
    EditField(h2,v,135,"Branch",ViewOnly,BranchID,false,0);
  end;
  if (HasMultiLocations or IsEnterprise) then begin
    v = v + vs;
  end;
  if (IsEnterprise) then begin
    EditField(h2,v,135,"Project",ViewOnly,PRCode,false,0);
  end;
  if (HasObjects) then begin
    EditField(h3,v=vm,80,"Order No.",ViewOnly,OrderNr,false,0);
  end else begin
    if (IsEnterprise==false) then begin
      EditField(h2,v=vm,135,"Order No.",ViewOnly,OrderNr,false,0);
    end;
  end;
  if (IsEnterprise) then begin
    EditField(h3,v+=vs,80,"Order Class",Normal,SHClass,false,OrderClassSClass);
    CheckBox(h4,v=6,0,"Tel. Message",Check1);
  end;
  if (IsEnterprise==false) then begin
    if (HasMultiLocations) then begin
      EditField(h1,v+=2*vs,-40,"Comment",Normal,Comment,false,0);
    end else begin
      EditField(h1,v+=vs,-40,"Comment",Normal,Comment,false,0);
    end;
  end;
  Tile(tilenr,190,true,tilenr,Math); tilenr = tilenr + 1;
  v = 20;
  MatrixBegin(4,v,-50,-35,-,200);
  MatTypedRow(stp);
  Flip(0);
  MatCol(1,32,"Item",0,ArtCode,false,INSClass);
//  MatCol(1,94,"Var",0,VARList,false,VARSClass);
//  MatCol(1,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(1,144,"Description",0,Spec,false,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,32,"Item",0,ArtCode,false,INSClass);
//  MatCol(t,94,"Var",0,VARList,false,VARSClass);
//  MatCol(t,144,"Prev. Down Payment",0,Spec,false,0);
  MatCol(t,94,"Name",0,Spec,false,0);
  flipnr = 1;
  Flip(flipnr); flipnr = flipnr + 1;
  if (IsEnterprise) then begin
//    MatCol(1,-230,"  ",0,CustArtCode,false,CUINSClass); 
    MatCol(1,-230,"Cust.Item No.",0,CustArtCode,false,CUINSClass); 
  end;
  MatCol(1,-150,"Ordered",0,Ordered,true,0);
  MatCol(1,-98,"Avail.",0,InStock,true,0);
  MatCol(1,-50,"Del. Qty",0,Ship,true,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,-150,"Ordered",0,Ordered,true,0);
  if (IsEnterprise) then begin
  MatCol(t,-230,"Cust. Item No.",0,CustArtCode,false,CUINSClass); 
  end;
  MatCol(t,-98,"Avail.",0,InStock,true,0);
  MatCol(t,-50,"Del. Qty",0,Ship,true,0);
  Flip(flipnr); flipnr = flipnr + 1;
  if (IsEnterprise==false) then begin
    if (HasSerialNumbers) then begin
      MatCol(1,-350,"Serial No",0,SerialNr,false,SerialNrSClass); 
    end;
    if (HasObjects) then begin
      MatCol(1,-250,"Objects",0,Objects,false,ObjSClass); 
    end;
    MatCol(1,-98,"#Stock# Value",0,FIFORowVal,false,0);
  end else begin
    MatCol(1,-350,"Serial No.",0,SerialNr,false,SerialNrSClass);
    MatCol(1,-250,"Best Before",0,BestBefore,false,0);
    MatCol(1,-150,"Location",0,Location,false,LocationSClass);
    MatCol(1,-50,"Position",0,PosCode,false,UsedPosSClass);
    MatCol(t=kInvoiceRowTypeStructuredItemComponent,-350,"Serial No.",0,SerialNr,false,SerialNrSClass);
    MatCol(t,-250,"Best Before",0,BestBefore,false,0);
    MatCol(t,-150,"Location",0,Location,false,LocationSClass);
    MatCol(t,-50,"Position",0,PosCode,false,UsedPosSClass);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,-400,"BuyBack Pr.",0,BBCostPrice,false,0);
    MatCol(1,-320,"Row FIFO",0,FIFORowVal,false,0);
    MatCol(1,-220,"W. Av. Base2",0,WAB2,false,0);
    MatCol(1,-120,"Base Price",0,BasePrice,false,0);
    MatCol(1,-40,"Coeff",0,Coefficient,false,0);
    MatCol(t=kInvoiceRowTypeStructuredItemComponent,-400,"BuyBack Pr.",0,BBCostPrice,false,0);
    MatCol(t,-320,"Row FIFO",0,FIFORowVal,false,0);
    MatCol(t,-220,"W. Av. Base2",0,WAB2,false,0);
    MatCol(t,-120,"Base Price",0,BasePrice,false,0);
    MatCol(t,-40,"Coeff",0,Coefficient,false,0);
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,-400,"Recipe",0,Recepy,false,0);
    MatCol(1,-320,"Source",0,Source,false,SourceSClass);
    MatCol(1,-240,"Invoiced",0,Invd,false,0);
    MatCol(1,-160,"#Despatch# Date",0,DespatchRowDate,false,PasteCurDate);
    MatCol(1,-80,"#Despatch# Time",0,DespatchRowTime,false,PasteCurTime);
    MatCol(t=kInvoiceRowTypeStructuredItemComponent,-400,"Recipe",0,Recepy,false,0);
    MatCol(t,-300,"Source",0,Source,false,SourceSClass);
    MatCol(t,-240,"Invoiced",0,Invd,false,0);
    MatCol(t,-160,"#Despatch# Date",0,DespatchRowDate,false,PasteCurDate);
    MatCol(t,-80,"#Despatch# Time",0,DespatchRowTime,false,PasteCurTime);
    Flip(flipnr); flipnr = flipnr + 1;
		MatCol(1,-400,"Sales A/C",0,SalesAcc,false,AccSClass);
    MatCol(1,-330,"Cost A/C",0,CostAcc,false,AccSClass);
    MatCol(1,-250,"Objects",0,Objects,false,ObjSClass);
    MatCol(1,-135,"Width",0,UnitXval,true,0);
    MatCol(1,-90,"Height",0,UnitYval,true,0);
    MatCol(1,-45,"Depth",0,UnitZval,true,0);
    MatCol(t=kInvoiceRowTypeStructuredItemComponent,-400,"Sales A/C",0,SalesAcc,false,AccSClass);
    MatCol(t,-330,"Cost A/C",0,CostAcc,false,AccSClass);
    MatCol(t,-250,"Objects",0,Objects,false,ObjSClass);
    MatCol(t,-135,"Width",0,UnitXval,true,0);
    MatCol(t,-90,"Height",0,UnitYval,true,0);
    MatCol(t,-45,"Depth",0,UnitZval,true,0);
    Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,-300,"Packages",0,RowPackages,false,0);
    MatCol(1,-220,"P.Type",0,PackageType,false,PackTypeSClass);
    MatCol(1,-170,"Package Desc",0,PackageDesc,false,0);
  MatCol(1,-70,"OrdRow",0,OrdRow,false,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,-300,"Packages",0,RowPackages,false,0);
MatCol(t,-220,"P.Type",0,PackageType,false,PackTypeSClass);
    MatCol(t,-170,"Package Desc",0,PackageDesc,false,0);
  MatCol(t,-70,"OrdRow",0,OrdRow,false,0);
  end;
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 22;
  v = 21; 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1)); 
      v = v + vs;
    end;
  end;

//  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(-131,-20,80,"Total Qty",ViewOnly,TotQty,true,0);
  if (IsEnterprise) then begin
    Tile(tilenr,90,false,tilenr,ShipMode); tilenr = tilenr + 1;
    vs = 20;
    EditField(h1,v=vm,82,"Del. Mode",Normal,ShipMode,false,DMSClass);
    EditField(h1,v+=vs,80,"Tax Sum",ViewOnly,TAX1Sum,true,0);
    EditField(h1,v+=vs,80,"Declared Value",Normal,DeclaredVal,true,0);
    EditField(h1,v+=vs,-20,"E-Shipment status",ViewOnly,EShipStatus,false,0);
    EditField(h2,v=vm,80,"Total Quantity",ViewOnly,TotQty,true,0);
    EditField(h2,v+=vs,80,"Total Weight",Normal,TotWeight,true,0);
    EditField(h2,v+=vs,80,"Total Volume",Normal,TotVolume,true,0);
    CheckBox(473,v=vm,0,"Use Invoice Address",Check2);
    CheckBox(473,v+=16,0,"Electronic Shipment Created",EShipmentCreated);
    CheckBox(473,v+=16,0,"Electronic Shipment Collected",EShipCollected);
    Tile(tilenr,110,false,tilenr,Packages); tilenr = tilenr + 1;
    EditField(h1,v=6,82,"Transport No.",Normal,TransportNumber,false,0);
    EditField(h1,v+=vs,82,"Packages",Normal,Packages,true,0);
    EditField(h1,v+=vs,82,"Language",Normal,LangCode,false,LangSClass);
    EditField(h1,v+=vs,82,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
    EditField(h1,v+=vs,-20,"Transp. Directives",Normal,TransportDirect,false,0);
    EditField(h2,v=6,135,"From City",Normal,FromCity,false,0);
    EditField(h2,v+=vs,135,"To City",Normal,ToCity,false,0);
    EditField(h2,v+=vs,135,"From Dock",Normal,FromDock,false,0);
    EditField(h2,v+=vs,135,"To Dock",Normal,ToDock,false,0);
    HalPushButton(473,6,600,26,"UpdateSHPackages","Define Packages");
    Tile(tilenr,130,false,tilenr,FreightCode); tilenr = tilenr + 1;
    EditField(h1,v=6,80,"Freight Company",Normal,FreightCode,false,FreightCompanySClass);
    EditField(h1,v+=vs,-20,"Name",Normal,FreightCompany,false,0);
    EditField(h1,v+=vs,-20,"#Reg. No.#",Normal,FreightCompanyRegNr,false,0);
    EditField(h1,v+=vs,-20,"Truck Information",Normal,TruckInfo,false,0);
    EditField(h1,v+=vs,-20,"Driver",Normal,Driver,false,0);
    EditField(h1,v+=vs,-20,"CMR",Normal,CMRText,false,0); // International transporting number
  end;
  Tile(tilenr,150,false,tilenr,Addr1); tilenr = tilenr + 1;
  vs = 20;
  if (IsEnterprise) then begin
    EditField(h1,v=6,80,"Address Code",Normal,DelAddrCode,false,DelAddr3SClass);
    EditField(h1,v+=vs,-20,"Delivery",Normal,Addr1,false,0);
    EditField(h1,v+=vs,-20,"Address",Normal,Addr2,false,0);
  end else begin
    EditField(h1,v=6,-20,"Address",Normal,Addr1,false,0); 
    EditField(h1,v+=vs,-20,"",Normal,Addr2,false,0); 
  end;
  EditField(h1,v+=vs,-20,"",Normal,Addr3,false,0);
  EditField(h1,v+=vs,-20,"",Normal,DelAddr3,false,0);
  EditField(h1,v+=vs,-20,"",Normal,DelAddr4,false,0);
  if (IsEnterprise) then begin
    EditField(h1,v+=vs,80,"Country",Normal,DelCountry,false,CountrySClass);
    EditField(h3,v,-20,"Region",Normal,Region,false,RegionSClass); 
    Tile(tilenr,30,false,tilenr,Comment); tilenr = tilenr + 1;
  EditField(h1,v=6,-20,"Comment",Normal,Comment,false,0);
  end;
  SpecialMenu("Print Freight Labels",'l',0,"PrintSHLabSHDsm");
  if (IsEnterprise) then begin
    SpecialMenu("Recalculate Weight",'w',1,"SHCalcWeightDsm");
  end;
  SpecialMenu("Item Status",'I',2,"ItemStatusSHDsm");
  if (HasModNL) then begin
  SpecialMenu("Open #NL# Transaction",'t',3,"OpenTRFromSH");
  end;
  if (IsEnterprise) then begin
   SpecialMenu("ASG Export",' ',4,"ASGEnSHDsm"); /* Specific for Sweden */
  SpecialMenu("Winedi Export",' ',4,"WinEDIEnSHDsm"); /* Specific for Norway */
  SpecialMenu("Create Returned Goods",'B',5,"RetFromSHSpec");
   SpecialMenu("Refill Batch No. Items",' ',6,"INBatchSHSpec");
    SpecialMenu("Split Row",' ',7,"SplitRowSHDsm");
    SpecialMenu("OK Warehouse #Stock# Movements",' ',8,"OKStockMovSHrDsm");
    SpecialMenu("Warehouse Picking List",' ',9,"PickingListDsm");
//  SpecialMenu("Calculate Manually",' ',10,"CalcSHMan"); /* Specific for one customer in Portugal, you may comment it out */
    SpecialMenu("Register Electronic Shipment",' ',9,"EShipRegisterDsm");
    if (GuiType==kGuiiPhone) then begin
      SpecialMenu("Sign",' ',10,"SignSHDsm"); //!!TRANSLATE
    end;
  end;
	SpecialMenu("Pack List",' ',8,"PackListSHDsm");
	SpecialMenu("    ",'',1,"ExportToExcelSHDsm"); // Edit ************************** BPI Baku - Irkan Ahmadov- 02, 25 06 2020y. at 11:16:38 AM
  
  EndWindow;
end;

window StockMovLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("#Stock# Movements",StockMovLClass,CGmlist,-);
  SpawnClass(StockMovDClass);
  SetWRect(64,80,880,298);
  Sizeable(-1,-1,0,0);
  UseView(StockMovVc);
  FormName(PrintStockMovL);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,  "No.",SerNr,false,SerNr);
  RlColKey(71,71,"Sent",SentOKFlag,false,SentOKFlag);
  RlColKey(111,111,"Rcvd.",OKFlag,false,OKFlag);
  RlColKey(151,151,"Sent Date",SentTransDate,false,SentTransDate);
  RlColKey(223,223,"Rcvd. Date",TransDate,false,TransDate);
	RlColKey(295,295,"Fr. Location",FrLocation,false,FrLocOK);
	RlColKey(370,370,"Via Location",ThrouLocation,false,ToThrouLocOK);
	RlColKey(450,450,"To Location",ToLocation,false,ToLocOK);
	RlCol(540,540,"Official Ser.Nr.",OfficialSerNr,false);				//Edit----------------------Dima  31.03.2015
  if (IsEnterprise) then begin 
    //RlColKey(610,610, "Prod.",ProdSerNr,false,ProdSerNr);
    RlColKey(660,660, "Comment",Comment,false,Comment);
  end else begin
    RlColKey(640,640, "Comment",Comment,false,Comment);
  end;
  SpecialMenu("Receive",'G',0,"OKStockMovLsm");
  SearchField("Search");
  EndWindow;
end;

window CLInDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,l,t,v,vs;
  WindowBegin("Cash In",CLInDClass,CGview,-);
  SetWRect(20,80,700,480);
  UseView(CLInVc);
  ActiveFieldOnNew("TransDate");
//  Sizeable(-1,-1,0,0);
  vs = 20; h = 130; h2=h+200; h3 = 472;
  Tile(0,70,false,"",SerNr);
  EditField(h,v=6,80,"No.",St_i,SerNr,false,TSerSClass);
  EditField(h2,v,82,"Date",Normal,TransDate,false,PasteCurDate);
  EditField(h,v+=vs,135,"Official Ser. No.",Normal,OfficialSerNr,false,LegalCLInNrSClass);
  TileButton(1,"Amounts");
  TileButton(2,"Currency");
  TileButton(3,"Payments");
//  CheckBox(400,v,0,"OK",OKFlag);
  Tile(1,300,false,"",PayMode);
  EditField(h,v=6,30,"Pay Mode",Normal,PayMode,false,PMSClass);
  EditField(h2,v,50,"Person",Normal,Person,false,UserSClass);
  CheckBox(400,v,0,"Info on Trans.",ARonTR);
  EditField(h,v+=vs,120,"Corresp.",Normal,CorspCode,false,CLCorspSClass);
  EditField(h2,v,-20,"Comment",Normal,CorspComment,false,0);
  EditField(h,v+=vs,120,"Customer",Normal,CUCode,false,CUSClass);
  EditField(h2,v,100,"Reference",Normal,RefStr,false,0);
  EditField(h,v+=vs,-20,"Name",Normal,CUName,false,0);
  EditField(h,v+=vs,-20,"Address",Normal,Addr0,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr1,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr2,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr4,false,0);
  EditField(h,v+=vs,-20,"Specification",Normal,Comment,false,0);
  EditField(h,v+=vs,-20,"Objects",Normal,Objects,false,ObjSClass);
  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(h,v+=vs,100,"Total",Normal,Total,true,0);
  EditField(h2,v,50,"#VAT# Code",Normal,VATCode,false,VATCodeSClass);
  EditField(h3,v,50,"Language",Normal,LangCode,true,LangSClass);
  EditField(h,v+=vs,100,"Net",Normal,NetVal,true,0);
  EditField(h2,v,80,"#VAT#",Normal,VATVal,true,0);
  EditField(h3,v,50,"TAX",Normal,TAX1Sum,true,0);
  Tile(2,70,false,"2",CurncyCode);
  vs = 20;
  EditField(h=110,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2=295,v,50,"Rate",Normal,FrRate,true,0);
  EditField(h3=360,v,50,":",Normal,ToRateB1,true,0);
  StaticText(h3+60,v+12,"Base Currency 1",false);
  EditField(h,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
  EditField(h3,v,50,":",Normal,ToRateB2,true,0);
  StaticText(h3+60,v+12,"Base Currency 2",false);
  EditField(h,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
  Tile(3,200,false,"3",Math);
  h = 8; v=24; l = 35;
  MatrixBegin(4,v,-50,-10,-,99);
  MatTypedRow(stp);
  MatCol(t=1,h=34,"Type",0,Type,false,SetSClass);
  MatCol(t,h+=120,"Comment",0,Comment,false,0);
  //MatCol(t,h+=120,"",0,TransNr,false,ARSClass);
  //MatCol(t,h+=70,"",0,OrderNr,false,ORSClass);
  //MatCol(t,h+=70,"",0,Objects,false,ObjSClass);
  //MatCol(t,-180,"",ViewOnly,Company,false,0);// Edit ************************** Wednesday, 12 March 2014 16:01:14
  MatCol(t,-180,"Corresp.",ViewOnly,CorspCode,false,CLCorspSClass);
  MatCol(t,-80,"Sum",0,Sum,true,0);
  MatText(t=2,h=34,"Set. Disc.",true);
  MatCol(t,h+=80,"",0,Type,false,0);
  MatCol(t,h+=200,"",0,TransNr,false,0);
  //MatCol(t,-180,"",ViewOnly,Company,false,0);// Edit ************************** Wednesday, 12 March 2014 16:00:17
  MatCol(t,-180,"Corresp.",ViewOnly,CorspCode,false,CLCorspSClass);
  MatCol(t,-80,"Sum",0,Sum,true,0);
  Flip(2);
  MatCol(t=1,h=34,"Type",0,Type,false,SetSClass);
  //MatCol(t,h+=120,".",ViewOnly,CorspCode,false,CLCorspSClass);// Edit ************************** Wednesday, 12 March 2014 15:59:55
  MatCol(t,h+=120,"Company",ViewOnly,Company,false,0);
  MatCol(t,h+=120,"No.",0,TransNr,false,ARSClass);// Edit ************************** Tuesday, 6 May 2014 14:51:30
  MatCol(t,h+=70,"Order",0,OrderNr,false,ORSClass);// Edit ************************** Tuesday, 6 May 2014 14:51:29
  MatCol(t,h+=70,"Objects",0,Objects,false,ObjSClass);// Edit ************************** Tuesday, 6 May 2014 14:51:28
  //MatCol(t,h+=70,"",0,Comment,false,0);// Edit ************************** Tuesday, 6 May 2014 14:51:42
  MatText(t=2,h=34,"Set. Disc.",true);
  MatCol(t,h+=120,"Corresp.",ViewOnly,CorspCode,false,CLCorspSClass);
  MatCol(t,h+=70,"Comment.",0,Comment,false,0);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 22;
  v=v+ 1; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,2,"B");  
  SpecialMenu("Open #NL# Transaction",'t',0,"OpenTRFromCLIn");
  if (UserCanReport("CLInColIVRn","",true)) then begin
    SpecialMenu("Show Invoices",' ',0,"ShowColIVDsm");
  end;
  EndWindow;
end;

window CLOutDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,h3,l,t,v,vs;
  WindowBegin("Cash Out",CLOutDClass,CGview,-);
  SetWRect(20,80,700,440);
  UseView(CLOutVc);
  ActiveFieldOnNew("TransDate");
//  Sizeable(-1,-1,0,0);
  vs = 20; h = 100; h2=h+200; h3 = 430;
  Tile(0,50,false,"",SerNr);
  EditField(h,v=6,80,"No.",St_i,SerNr,false,TSerSClass);
  EditField(h+150,v,82,"Date",Normal,TransDate,false,PasteCurDate);
//  EditField(h3,v,82,"Local Machine",ViewOnly,LocalMachineCode,false,0);
  TileButton(1,"Amounts");
  TileButton(2,"Currency");
  TileButton(3,"Payments");
//  CheckBox(400,v,0,"OK",OKFlag);
  Tile(1,270,false,"",PayMode);
  EditField(h,v=6,30,"Pay Mode",Normal,PayMode,false,PMSClass);
  EditField(h2,v,50,"Person",Normal,Person,false,UserSClass);
  CheckBox(400,v,0,"Info on Trans.",ARonTR);
  EditField(h,v+=vs,120,"Corresp.",Normal,CorspCode,false,CLCorspSClass);
  EditField(h2,v,-20,"Comment",Normal,CorspComment,false,0);
  EditField(h,v+=vs,120,"#Supplier#",Normal,CUCode,false,VESClass);
  EditField(h2,v,100,"Reference",Normal,RefStr,false,0);  
  EditField(h,v+=vs,-20,"Name",Normal,CUName,false,0);
  EditField(h,v+=vs,-20,"Address",Normal,Addr0,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr1,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr2,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,Addr4,false,0);
  EditField(h,v+=vs,-20,"Specification",Normal,Comment,false,0);
  EditField(h,v+=vs,-20,"Objects",Normal,Objects,false,ObjSClass);  
  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(h,v+=vs,100,"Total",Normal,Total,true,0);
  EditField(h2,v,50,"#VAT# Code",Normal,VATCode,false,VATCodeSClass);
  EditField(h3,v,50,"Language",Normal,LangCode,true,LangSClass);
  EditField(h,v+=vs,100,"Net",Normal,NetVal,true,0);
  EditField(h2,v,80,"#VAT#",Normal,VATVal,true,0);
  EditField(h3,v,50,"TAX",Normal,TAX1Sum,true,0);
  Tile(2,70,false,"2",CurncyCode);
  vs = 20;
  EditField(h=110,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2=295,v,50,"Rate",Normal,FrRate,true,0);
  EditField(h3=360,v,50,":",Normal,ToRateB1,true,0);
  StaticText(h3+60,v+12,"Base Currency 1",false);
  EditField(h,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
  EditField(h3,v,50,":",Normal,ToRateB2,true,0);
  StaticText(h3+60,v+12,"Base Currency 2",false);
  EditField(h,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);  
  Tile(3,300,false,"3",Math);
  h = 8; v=24; l = 35;
  MatrixBegin(4,v,-50,-10,-,99);
  Flip(1);
  MatTypedRow(stp);
  MatCol(t=1,h=34,"Type",0,Type,false,SetSClass);
  MatCol(t,h+=120,"Comment",0,Comment,false,0);
  //MatCol(t,h+=120,"",0,TransNr,false,ARSClass);
  //MatCol(t,h+=70,"",0,OrderNr,false,ORSClass);
  //MatCol(t,h+=70,"",0,Objects,false,ObjSClass);
  //MatCol(t,-180,"",ViewOnly,Company,false,0);// Edit ************************** Wednesday, 12 March 2014 16:02:00
  MatCol(t,-180,"Corresp.",ViewOnly,CorspCode,false,CLCorspSClass);// Edit ************************** Wednesday, 12 March 2014 16:02:01
  MatCol(t,-80,"Sum",0,Sum,true,0);
  MatText(t=2,h=34,"Set. Disc.",true);
  MatCol(t,h+=80,"",0,Type,false,0);
  MatCol(t,h+=200,"",0,TransNr,false,0);
  //MatCol(t,-180,"",ViewOnly,Company,false,0);// Edit ************************** Wednesday, 12 March 2014 15:47:28
  MatCol(t,-180,"Corresp.",ViewOnly,CorspCode,false,CLCorspSClass);
  MatCol(t,-80,"Sum",0,Sum,true,0);
  Flip(2);
  MatCol(t=1,h=34,"Type",0,Type,false,SetSClass);
  //MatCol(t,h+=120,".",ViewOnly,CorspCode,false,CLCorspSClass);// Edit ************************** Wednesday, 12 March 2014 15:47:29
  MatCol(t,h+=120,"Company",ViewOnly,Company,false,0);// Edit ************************** Wednesday, 12 March 2014 15:47:29
  MatCol(t,h+=120,"No.",0,TransNr,false,ARSClass);
  MatCol(t,h+=70,"Order",0,OrderNr,false,ORSClass);
  MatCol(t,h+=70,"Objects",0,Objects,false,ObjSClass);
  //MatCol(t,h+=70,"",0,Comment,false,0);
  MatText(t=2,h=34,"Set. Disc.",true);
  MatCol(t,-180,"Company",ViewOnly,Company,false,0);
  MatCol(t,-80,"Sum",0,Sum,true,0);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 22;
  v=v+ 1; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,2,"B");
  SpecialMenu("Open #NL# Transaction",'t',0,"OpenTRFromCLOut");
  if (UserCanReport("CLOutColVIRn","",true)) then begin
    SpecialMenu("Show Invoices",' ',1,"ShowColVIDsm");
  end;
  EndWindow;
end;

window PULabMyRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,l,v,vm;
  WindowBegin("Define label receipts",PULabMyRClass,CGRcW,RcType);
  SetWRect(20,80,400,320);
  EditFieldTL(h=150,v=6,153,"Receipt",   M4Str,ViewOnly,30,f1,false,0);
  if (IsEnterprise) then begin
  ButtonFrame(h=100,vm=(v+=40) /*v=vm*/,l=160,5,"Size");
  RadioButton(h,v    ,6,0,"4*13 pcs. 46*21 mm",ArtMode);
  RadioButton(h,v+=16,7,0,"4*14 pcs. 52*20 mm",ArtMode);
end;
  EndWindow;
end;

window ItemHistDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,v;
  WindowBegin("Item History",ItemHistDClass,CGview,-);
  UseView(ItemHistVc);
  SetWRect(64,80,800,430);
  Sizeable(-1,-1,0,0);
  h = 130; h1=h+250; h2=h1+230;
  Tile(0,90,false,"",SerNr);
  EditField(h,v=6,100,"No.",Normal,SerNr,false,0);
  EditField(h1,v,80,"Trans. Date",Normal,TransDate,false,0);
  EditField(h2,v,80,"FIFO Date",Normal,FIFODate,false,0);
  EditField(h,v+=20,100,"Register",Normal,FileName,false,0);
  EditField(h1,v,100,"Record No.",Normal,TransNr,false,0);
  EditField(h2,v,50,"Row No.",Normal,Row,false,0);
  EditField(h,v+=20,100,"Source",Normal,Source,false,0);
  TileButton(1,"Item");
  TileButton(2,"Values");
  TileButton(3,"Remaining");
  TileButton(4,"Curncy Cost");
  Tile(1,70,false,"1",ArtCode);
  EditField(h,v=6,160,"Item Code",Normal,ArtCode,false,0);
  EditField(h1,v,100,"Variety",Normal,Variety,false,0);
  EditField(h2,v,100,"Serial No.",Normal,SerialNr,false,0);
  EditField(h,v+=20,100,"Location",Normal,Location,false,0);
  EditField(h1,v,100,"Position",Normal,Position,false,0);
  EditField(h,v+=20,100,"Quantity",Normal,Qty,true,0);
  EditField(h1,v,100,"Quantity 2",Normal,Qty2,true,0);
  Tile(2,70,false,"2",WATotCostPerLoc);
  EditField(h,v=6,100,"WA Per Location",Normal,WATotCostPerLoc,true,0);
  EditField(h1,v,100,"WA Total",Normal,WATotCost,true,0);
  EditField(h2,v,100,"Tot Cost Price",Normal,TotCostPrice,true,0);
  EditField(h,v+=20,100,"Cost Price Per Location",Normal,CPTotCostPerLoc,true,0);
  EditField(h1,v,100,"Cost Price Total",Normal,CPTotCost,true,0);
  EditField(h,v+=20,100,"Base Price Per Location",Normal,BPTotCostPerLoc,true,0);
  EditField(h1,v,100,"Base Price Total",Normal,BPTotCost,true,0);
  Tile(3,70,false,"3",RemQty);
  EditField(h,v=6,100,"Remaining Qty",Normal,RemQty,true,0);
  EditField(h,v+=20,100,"Remaining Cost Price",Normal,RemCostPrice,true,0);
  EditField(h,v+=20,100,"No. per Location",Normal,SerNrPerLoc,true,0);
  CheckBox(h1,v=6,0,"Update Stock",StockAffectf);
  CheckBox(h1,v+=20,0,"Consignment Stock",ConsigStock);
  CheckBox(h1,v+=20,0,"Will be Purged",WillBePurged);
  CheckBox(h2,v=6,0,"TREO Stock",TREOStock);
  Tile(4,70,false,"4",RemQty);
  EditField(h,v=6,100,"Cost in Curncy",Normal,TotCostPriceCurncy,true,0);
  EditField(h,v+=20,100,"Rem Cost In Curncy",Normal,RemCostPriceCurncy,true,0);
  EditField(h,v+=20,100,"Curncy Code",Normal,CurncyCode,true,0);
  SpecialMenu("Open Connected Register",'t',0,"OpenRegisterFromItemHistDsm");
  EndWindow;
end;

window ItemHistLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Item History",ItemHistLClass,CGmlist,-);
  SpawnClass(ItemHistDClass);
  SetWRect(20,80,1100,298);
  Sizeable(-1,-1,0,0);
  UseView(ItemHistVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,2,"Item Code",ArtCode,false,ArtCode);
  RlColKey(80,80, "File Name",FileName,false,FutArtFile);
  RlCol(160,160, "Trans. No.",TransNr,false);
  RlCol(240,240, "Row",Row,false);
  RlColKey(300,300, "Trans. Date",TransDate,false,TransDate);
  RlCol(400,400, "Qty",Qty,true);
  RlColKey(470,470, "Rem. Qty",RemQty,true,ActiveQty);
  RlCol(540,540, "Location",Location,false);
  RlColKey(600,600, "FIFO Date",FIFODate,false,ArtCodeFD);
//  RlCol(600,600, "Variety",Variety,false);
  RlColKey(680,680, "SerNr",SerNr,false,SerNr);
  RlColKey(740,740, "Source",Source,false,Source);
  RlCol(820,820, "Cost",TotCostPrice,true);
  RlCol(900,900, "Rem Cost",RemCostPrice,true);
  //RlCol(960,960, "Variety",Variety,false);
  //RlCol(1040,1040, "Purge",WillBePurged,false);
  RlCol(1000,1000, "RemCurPrice",RemCostPriceCurncy,false);
  RlCol(1100,1100, "TotCurPrice",TotCostPriceCurncy,false);
  RlCol(1200,1200, "Curncy",CurncyCode,false);
  RlCol(1250,1250, "InFile",InFileName,false);
  RlCol(1300,1300, "InDate",InDate,false);
  RlCol(-1,-1,"",Invalid,true);
  SearchField("Search");
  EndWindow;
end;

window DIDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h1,h2,v,vs;
  WindowBegin("Item Classification",DIDClass,CGview,DIView);
  SetWRect(64,80,540,200);
//  Sizeable(-1,-1,0,0);
  UseView(DIVc);
  vs = 20; h1 = 100; h2 = 260;
  EditField(h1,v=6,40,"Code",Normal,Code,false,0);
  EditField(h1,v+=vs,200,"Name(EN)",Normal,Name,false,0); //Edit***************************Sasha2,16:16 28.11.2014
  EditField(h1,v+=vs,200,"Name(RU)",Normal,Name_RU,false,0); //Edit***************************Sasha2,16:16 28.11.2014
  EditField(h1,v+=vs,200,"Name(AZ)",Normal,Name_AZ,false,0); //Edit***************************Sasha2,16:16 28.11.2014
  if (IsEnterprise) then begin
    EditField(h1,v+=vs,50,"Type",Normal,CType,false,CTypeSClass);
    EditField(h2,v,100,"Category",Normal,CCat,false,0);
    EditField(h1,v+=vs,200,"Classification",Normal,DispGroups,false,DISClass);
    EditField(h1,v+=vs,100,"#Colour#",Normal,colnr,false,SetSClass);
  end;
  EndWindow;
end;

window MarketingDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h1,h2,v,vs,l;
  WindowBegin("Committing visit",MarketingDClass,CGview,-);
  SetWRect(64,80,590,600);
  Sizeable(-1,-1,0,0);
  UseView(MarketingVc);
  vs = 20; h1 = 50; h2 = 260;
  ActiveFieldOnNew("Name");
  EditField(h1,v=16,40,"No.",ViewOnly,SerNr,false,0);
  
  v = 50; 
  ButtonFrame(h1,v,l=160,7,"Age");
  RadioButton(h1,v,0,0,"-",Age);
  RadioButton(h1,v+=16,1,0,"< 20",Age);
  RadioButton(h1,v+=16,2,0,"20-30",Age);
  RadioButton(h1,v+=16,3,0,"30-40",Age);
  RadioButton(h1,v+=16,4,0,"40-50",Age);
  RadioButton(h1,v+=16,5,0,"50-60",Age);
  RadioButton(h1,v+=16,6,0,"> 60",Age);
  
  v = 50; h1 = h1+200;
  ButtonFrame(h1,v,l=160,6,"Gender");
  RadioButton(h1,v,0,0,"-",Gender);
  RadioButton(h1,v+=16,1,0,"Man",Gender);
  RadioButton(h1,v+=16,2,0,"Woman",Gender);
  RadioButton(h1,v+=16,3,0,"Mixed group",Gender);
  RadioButton(h1,v+=16,4,0,"Group of men",Gender);
  RadioButton(h1,v+=16,5,0,"Group of women",Gender);
  
  v = 50; h1 = h1 + 200;
  ButtonFrame(h1,v,l=160,4,"Nationality");
  RadioButton(h1,v,0,0,"-",NationalityRbtn);
  RadioButton(h1,v+=16,1,0,"Azerbaijani",NationalityRbtn);
  RadioButton(h1,v+=16,2,0,"Russian",NationalityRbtn);
  RadioButton(h1,v+=16,3,0,"",NationalityRbtn);
  v = v + 5;
  EditField(h1+30,v-3,120,"",Normal,NationalityTxt,false,0);
  
  v = 160;
  h1 = 100;
  
  EditField(h1,v+=vs,70,"Card ID",Normal,CustCode,false,CUSClass);
  EditField(h1+200,v,230,"Name",Normal,Name,false,0);
  EditField(h1+200,v+=vs,80,"Date",ViewOnly,TransDate,false,PasteCurDate);
  EditField(h1+350,v,80,"Time",ViewOnly,TransTime,false,);
  EditField(h1+200,v+vs,80,"Completed",Normal,SalesMan,false,UserSClass);
  EditField(h1+350,v+vs,80,"Shop",Normal,Location,false,LocationSClass);
  EditField(h1+480,v+vs,80,"L.Mash.",Normal,LocalMachine,false,LocalMachineSClass);
  
  EditField(h1,v,100,"Phone 1",Normal,Phone1,false,0);
  EditField(h1,v+=vs,100,"Phone 2",Normal,Phone2,false,0);
  EditField(h1,v+=vs,-50,"Address",Normal,Address,false,0);
  EditField(h1,v+=vs,120,"e-Mail",Normal,eMail,false,0);
  
  
  
  h1 = 120;
  v = v;
  EditField(h1,v+=vs,-50,"The reason for visiting",Normal,Reason,false,0);
  
  h1 = 100;
  v = 320;
  ButtonFrame(h1,v,l=200,3,"City");
  RadioButton(h1,v,0,0,"-",CityRbtn);
  RadioButton(h1,v+=16,2,0,"Baku",CityRbtn);///  2  
  RadioButton(h1,v+=16,1,0,"Other",CityRbtn);// 1
	v = v + 5;
  EditField(h1+70,v-3,100,"",Normal,CityTxt,false,0);
  
  
  h1 = h1 + 220;
  v = 320;
  ButtonFrame(h1,v,l=190,7,"Source of information");
  RadioButton(h1,v,0,0,"-",ReferenceRbtn);
  RadioButton(h1,v+=16,1,0,"Magazines",ReferenceRbtn);
  RadioButton(h1,v+=16,2,0,"Outdoor (bilboard or video)",ReferenceRbtn);
  RadioButton(h1,v+=16,3,0,"Internet",ReferenceRbtn);
  RadioButton(h1,v+=16,4,0,"Instagram",ReferenceRbtn);
  RadioButton(h1,v+=16,5,0,"Frends",ReferenceRbtn);
  RadioButton(h1,v+=16,6,0,"Others ...",ReferenceRbtn);
	v = v + 5;
  EditField(h1+70,v-3,120,"",Normal,ReferenceTxt,false,0);
  
  //Start edit Victor --------------------- 21.08 
  
  //h1 = h1 + 210;
  v = 460;
  ButtonFrame(h1,v,l=300,3,"Result");
  RadioButton(h1,v,0,0,"-",ResultRbtn);
  RadioButton(h1,v+=16,1,0,"No sales: comment.",ResultRbtn);
  RadioButton(h1,v+=16,2,0,"Sales: invoices",ResultRbtn);
  
  EditField(h1+180,v - vs,100,"",Normal,ResultTxt,false,0);
  EditField(h1+180,v,100,"",Normal,InvNr,false,0);
  
  //End Edit
  
  h1 = 10;
  v = 360;
  StaticText(h1,v+=vs,"Comment",false);
  TextField(h1,v,300,-16,Math,0);
  
  EndWindow;
end;


window MarketingLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Customer Registration",MarketingLClass,CGmlist,-);
  SpawnClass(MarketingDClass);
  SetWRect(20,80,1100,298);
  Sizeable(-1,-1,0,0);
  UseView(MarketingVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,2,"No.",SerNr,false,SerNr);
  RlColKey(50,50,"Date",TransDate,false,TransDate);
  RlCol(150,150,"Time",TransTime,false);
  RlColKey(250,250,"Name",Name,false,Name);
  RlColKey(-150,-150,"Shop",Location,false,Location);
  RlColKey(-75,-75," ",LocalMachine,false,LocalMachine);
  SearchField("Search");
  EndWindow;
end;

window LocationDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,l,v,vm,vs;
  Integer tilenr;
  
  WindowBegin("Location",LocationDClass,CGview,-);
  SetWRect(64,80,570,520);
  UseView(LocationVc);
  v = 10; vs = 20; h = 120; h2 = 340; l = -60;
  if (IsEnterprise) then begin
  Tile(0,50+24,false,"",Code);
  end;
  EditField(h,v,120,"Code",Normal,Code,false,0);
  if (IsEnterprise) then begin
    EditField(h2,v,l,"Group",Normal,Group,false,LocGrSClass);
  end;
  EditField(h,v+=vs,l,"Name",Normal,Name,false,0);
  if (IsEnterprise) then begin
    tilenr = 1;
    TileButton(tilenr,"Address"); tilenr = tilenr + 1;
    TileButton(tilenr,"Warehouse"); tilenr = tilenr + 1;
    tilenr = 1;
    Tile(tilenr,350,false,tilenr,Addr0); tilenr = tilenr + 1;
    EditField(h,v=6,l,"Address",Normal,Addr0,false,0);
  end else begin
    EditField(h,v+=vs,l,"Address",Normal,Addr0,false,0);
  end;
  EditField(h,v+=vs,l,"",Normal,Addr1,false,0);
  EditField(h,v+=vs,l,"",Normal,Addr2,false,0);
  EditField(h,v+=vs,l,"",Normal,Addr3,false,0);
  EditField(h,v+=vs,l,"",Normal,Addr4,false,0);
  EditField(h,v+=vs,l,"Contact",Normal,Contact,false,0);
  EditField(h,v+=vs,l,"Telephone",Normal,Phone,false,0);
  EditField(h,v+=vs,l,"Fax",Normal,Fax,false,0);
  EditField(h,v+=vs,l,"E-mail",Normal,Email,false,0);
  if (IsEnterprise) then begin
    EditField(h,v+=vs,l,"Classification",Normal,Classification,false,LocClSClass);
    EditField(h,v+=vs,100,"Responsible Person",Normal,RespPerson,false,UserSClass);
    EditField(h2,v,l,"Reserv. Access",Normal,ReservLocAccess,false,ReservLocAccessSClass);
  end;
  if (HasModNL) then begin
    EditField(h,v+=vs,100,"#Stock# A/C",Normal,StockAcc,false,AccSClass);
  end;
  if (HasObjects) then begin
    EditField(h2,v,l,"Object",Normal,Objects,false,ObjSClass);
  end;
  if (IsEnterprise) then begin
//  EditField(h,v+=vs,100,"",Normal,PriceList,false,PLDefSClass);
  EditField(h,v+=vs,100,"Purchase Location",Normal,PurLoc,false,LocationSClass);
  EditField(h2,v,l,"Ship-To Account",Normal,ShipToAccount,false,0);
  EditField(h,v+=vs,100,"Via Location",Normal,ThrouLocation,false,LocationSClass); 
  EditField(h2,v,100,"Debtors",Normal,ARAcc,false,AccSClass);// Edit ************************** Monday, 15 September 2014 10:11:05
  //EditField(h2,v+=vs,100," ",Normal,SalesAcc,false,AccSClass);// Edit ************************** Monday, 15 September 2014 10:11:05
      CheckBox(h,vm=(v+=30),0,"Ignore Chronology",IgnoreChronology);
    CheckBox(h,v+=vs,0,"Require Position",RequirePos);
    ButtonFrame(h2,v=vm+10,100,2,"Type");
    RadioButton(h2,v,0,0,"Other",Type);
    RadioButton(h2,v+=16,1,0,"Production",Type); 
  end;
  if (IsEnterprise) then begin
    Tile(tilenr,310,false,tilenr,WHMPalletArea); tilenr = tilenr + 1;
    EditField(h=200,v=6,l=100,"Empty Pallets Area",Normal,WHMPalletArea,false,LocAreaSClass);
    EditField(h,v+=vs,l,"Picking Area",Normal,WHMPickArea,false,LocAreaSClass);
    EditField(h,v+=vs,l,"Position for Goods Receipts",Normal,WHMDefPUPosCode,false,PosSClass);
    EditField(h,v+=vs,l,"Position for Production",Normal,WHMDefProdPosCode,false,PosSClass);
    EditField(h,v+=vs,l,"Wrapping Machine Position",Normal,WHMWraperPosCode,false,PosSClass);
    EditField(h,v+=vs,l,"Delivery Position for Picking",Normal,WHMDeliveryPosCode,false,PosSClass);//the same as WraperPosCode at ethe moment
    EditField(h,v+=vs,l,"Delivery Area",Normal,WHMDeliveryArea,false,LocAreaSClass);
    EditField(h,v+=vs,l,"Express Orders",Normal,WHMExpressOrderClass,false,OrderClassSClass);
    EditField(h,v+=vs,l,"Def. #Supplier#",Normal,WHMDefPUVECode,false,VESClass);
    CheckBox(h,v+=24,0,"Require Position",RequirePos);
    CheckBox(h,v+=16,0,"Start from Highest Position",WHMHighestPosCodeFirst);
    ButtonFrame(h,v+=40,140,3,"Forklift System");
    RadioButton(h,v,0,0,"O_ff",WHMForkLiftSystem);
    RadioButton(h,v+=16,1,0,"On",WHMForkLiftSystem);
    RadioButton(h,v+=16,2,0,"On, Picking Mode Off",WHMForkLiftSystem);
  end;
  EndWindow;
end;

window ResRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vm;
  WindowBegin("Specify Profit & Loss",ResRClass,CGRcW,RcType);
  SetWRect(20,80,527,370);
  PeriodField(h=100,v=6,"Period");
  if (IsEnterprise) then begin
    EditFieldTL(h,v+=20,150,"Budget period",M4UStr,Normal,21,Stext,false,PerSClass);
  end;
  if (HasObjects) then begin
    EditFieldTL(h,v+=20,150,"Object",M4UStr,Normal,60 ,ObjStr,false,ObjSClass);
    EditFieldTL(h,v+=20,50,"Object Type",M4UStr,Normal,5 ,ObjType,false,OTSClass);
    CheckBox(180,v,0,"Including unspecified",flags[2]);
  end;
  if (HasMultiCurrency) then begin
    EditField(h,v+=20,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  end;
  if (HasLanguages) then begin
    EditField(h,v+=20,50,"Language",Normal,Language,false,LangSClass);  
  end;
  if (HasObjects) then begin
    EditFieldTL(h,v+=20,150,"Exclude Object",M4UStr,Normal,60,f6,false,ObjSClass);
  end;
  EditFieldTL(345,v+=25,70,"Rate",M4Val,Normal,0,vals3,false,0);	//Edit----------------------Dima  04.02.2016
  EditFieldTL(345,6,120,"Header",M4Str,Normal,60 ,f1,false,0);
  ButtonFrame(h=30,vm=(v+=41),123,5,"Accounts");
  RadioButton(h,v,0,0,"A_ll",AccSpec);
  RadioButton(h,v+=16,1,0,"Used Only",AccSpec);
  if (IsEnterprise) then begin
    RadioButton(h,v+=16,2,0,"Groups Only",AccSpec);
    RadioButton(h,v+=16,3,0,"Used Groups Only",AccSpec);
    RadioButton(h,v+=16,4,0,"With Balance",AccSpec);
  end;
  EndFrame;
  ButtonFrame(h+=148,v=vm,123,6,"Notation");
  RadioButton(h,v,0,0,"Exact",Notation);
  RadioButton(h,v+=16,4,0,"No Decimals",Notation);
  RadioButton(h,v+=16,1,0,"Thousands",Notation);
  RadioButton(h,v+=16,2,0,"Millions",Notation);
  if (IsEnterprise) then begin
    RadioButton(h,v+=16,3,0,"% _Turnover",Notation);
    CheckBox(h,v+=16,0,"Comparison in %",flags[1]);
  end;
  EndFrame;
  ButtonFrame(h+=148,v=vm,140,2,"Comparison");// Edit ************************** Monday, 13 October 2014 09:57:57
  RadioButton(h,v,0,0,"Accumulated",Comparison);
  RadioButton(h,v+=16,1,0,"Previous _Year",Comparison);
  //RadioButton(h,v+=16,4,0,". ",Comparison);
  //if (IsEnterprise) then begin
  //RadioButton(h,v+=16,2,0,"",Comparison);
  //RadioButton(h,v+=16,3,0,". ",Comparison);
  //end;
  EndFrame;
  //CheckBox(h+100,v-16,0,"Add",flags[6]);//fir internal use only
  if (HasBase2) then begin
    ButtonFrame(h,v+=40,123,2,"Values in");
    RadioButton(h,v,0,0,"Base Currency 1",basecurncy);
    RadioButton(h,v+=16,1,0,"Base Currency 2",basecurncy);
  end;
  if (IsEnterprise) then begin
    CheckBox(h=30,v=270,0,"Including _Simulations",SimVerf);
    CheckBox(h,v+=16,0,"List Transaction No.",flags[4]);
    CheckBox(h,v+=16,0,"No Header",flags[5]);
  end;
  EndWindow;
end;

window CorspRClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,v,vs;
  WindowBegin("Specify Corresponding Accounts",CorspRClass,CGRcW,RcType);
  SetWRect(20,80,500,160);
  vs = 20;
  PeriodField(h=180,v=6,"Period");
  EditFieldTL(h,v+=vs,150,"Main Account",M4UStr,Normal,20,AccStr,false,AccSClass);// Edit ************************** Monday, 13 October 2014 16:59:58
  EditFieldTL(h,v+=vs,150,"Cor. Account",M4UStr,Normal,20,f2,false,AccSClass);// Edit ************************** Monday, 13 October 2014 16:59:59
  CheckBox(h1=200,v+=30,0,"Balances Only",ArtMode);
  CheckBox(h1,v+=16,0,"List Transaction No.",flags[4]);
  EndWindow;
end;

window UserDefRepLinesDClass:2
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h2,v;
  WindowBegin("Line Definition",UserDefRepLinesDClass,CGview,-);
  BrowseButtons(false);
  UseView(UserDefRepLinesVc);
  if (HasLanguages) then begin
  SetWRect(20,80,620,460);
  end else begin
    SetWRect(20,80,620,320);
  end;
  EditField(h=100,v=6,50,"No.",Normal,IdKey,false,0);
  EditField(h2=250,v,150,"Name",ViewOnly,shortname,false,0);
  EditField(h,v+=20,300,"Text",Normal,Comment,false,0);
  if (IsEnterprise) then begin
  EditField(500,v,-40,"Extra Code",Normal,SpecCode,false,0);
  // Edit Start ---------------------------------------------- Edit Start
	//Tuesday, 21 October 2014 11:58:43
	
  ButtonFrame(430,v+=40,200,4,"Type");
  RadioButton(430,v,0,0,"Standart",CustType);
  RadioButton(430,v+=16,1,0,"Balance at beginning of period",CustType);
  RadioButton(430,v+=16,2,0,"First half-year turnover",CustType);
  RadioButton(430,v+=16,3,0,"Second half-year turnover",CustType);
  
	// Edit End ---------------------------------------------- Edit End
	
  end;
  EditField(h,50,300,"Accounts",Normal,Desc,false,AccSClass);
  EditField(h,70,300,"",Normal,Desc2,false,AccSClass);
  EditField(h,90,300,"",Normal,Desc3,false,AccSClass);
  if (IsEnterprise) then begin
    EditField(h,110,80,"Cor. A/C",Normal,CorspAcc,false,AccSClass);
  end;
  ButtonFrame(h=15,v=150,100,4,"Type");
  RadioButton(h,v    ,kRsTypeAccounts,0,"A_ccounts",RsType);
  RadioButton(h,v+=16,kRsTypeSum,0,"Sum",RsType);
  RadioButton(h,v+=16,kRsTypeText,0,"Text",RsType);
  RadioButton(h,v+=16,kRsTypePageBreak,0,"Page break",RsType);
  ButtonFrame(h=150,v=150,100,5,"Account Type");
  RadioButton(h,v    ,0,0,"Asset",AccType);
  RadioButton(h,v+=16,1,0,"Liability",AccType);
  RadioButton(h,v+=16,2,0,"Eq_uity",AccType);
  RadioButton(h,v+=16,3,0,"Income",AccType);
  RadioButton(h,v+=16,4,0,"Expense",AccType);
  ButtonFrame(h=285,v=150,100,3,"Side");
  RadioButton(h,v    ,0,0,"Normal",DCSide);
  RadioButton(h,v+=16,1,0,"Debit",DCSide);
  RadioButton(h,v+=16,2,0,"Credit",DCSide);
  ButtonFrame(h=410,v=150,100,3,"Active/Passive");
  RadioButton(h,v    ,0,0,"Normal",DCSaldo);
  RadioButton(h,v+=16,1,0,"Only Debit",DCSaldo);
  RadioButton(h,v+=16,2,0,"Only Credit",DCSaldo);
  if (HasLanguages) then begin
    MatrixBegin(4,v=256,-32,-20,INTextRowType,99);
    MatCol(1,24,"Language",0,LangCode,false,LangSClass);
    MatCol(1,94,"Text",0,Text,false,0);
    EndMatrix;
  end;
  EndWindow;
end;

window CLCorspDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real v;
  WindowBegin("Corresponding Mode",CLCorspDClass,CGview,CLCorspView);
  SetWRect(64,80,509,150);
  UseView(CLCorspVc);
  EditField(120,v=6,140,"Code",St_i,Code,false,0);
  EditField(120,v+=20,300,"Comment",Normal,Comment,false,0);
  EditField(120,v+=20,80,"A/C",Normal,AccNumber,false,AccSClass);
  EditField(120,v+=20,300,"Objects",Normal,Objects,false,ObjSClass);// Edit ************************** Thursday, 30 October 2014 09:41:58
  EndWindow;
end;

window CLCorspLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Corresponding Modes",CLCorspLClass,CGmlist,CLCorspView);
  SetWRect(64,80,509,298);
  SpawnClass(CLCorspDClass);
  Sizeable(-1,-1,0,0);
  UseView(CLCorspVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,  "Code",Code,false,Code);
  RlColKey(141,141,"Comment",Comment,false,Comment);
  RlCol(300,300,"Objects",Objects,false);// Edit ************************** Thursday, 30 October 2014 09:50:50
  SearchField("Search");
  EndWindow;
end;

window CLCorspSClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Paste Corresponding Mode",CLCorspSClass,CGslist,CLCorspView);
  SetWRect(240,80,950,250);
  Sizeable(-1,-1,0,0);
  UseView(CLCorspVc);
  SpawnClass(CLCorspDClass);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,  "Code",Code,false,Code);
  RlColKey(141,141,"C_omment",Comment,false,Comment);
  RlCol(300,300,"Objects",Objects,false);// Edit ************************** Thursday, 30 October 2014 09:50:54
  SearchField("Search");
  EndWindow;
end;

window AddObjTRVClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v,vs;
  WindowBegin("Specify Add Object to Transactions",AddObjTRVClass,CGMnt,RcType);
  SetWRect(20,80,400,200);
  PeriodField(h=100,v=6,"Period");
  vs=20;
  EditFieldTL(h,v+=vs,200,"Object",M4UStr,Normal,60,f1,false,ObjSClass);
  EditFieldTL(h,v+=vs,200,"Invoice",M4UStr,Normal,60,f2,false,AccSClass);// Edit ************************** Saturday, 1 November 2014 13:01:08
  CheckBox(h,v+=20,0,"Skip all tests",flags[0]);
  EndWindow;
end;

window PODClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,v,vm,vs;
  record CYBlock CYb;
  string 255 label;
  Integer tilenr,flipnr,f;

  vs = 20;
  BlockLoad(CYb);
  WindowBegin("Purchase Order",PODClass,CGview,-);
  SetWRect(20,80,900,460);
  DynamicWindow;// Edit ************************** Monday, 3 November 2014 11:50:49
  Sizeable(-1,-1,0,0);
  UseView(POVc);
  CommunicateButton;
  ActiveFieldOnNew("VECode");    
  Tile(0,74,false,"",VECode);
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"#Supplier#",Normal,VECode,false,VESClass);
  EnterSkip(PayDeal);
  EditField(h=255,v=vm,-40,"Name",Normal,Addr0,false,0);
  if (IsEnterprise) then begin
		//EditField(h,vm=(v+=20),95,"Signers",Normal,OKPersons,false,UserSClass);// Edit ************************** Thursday, 12 September 2013 13:42:23
		EditField(h,vm=(v+=20),95,"Sales Order Nr.",Normal,InvAddr4,false,0);// Edit ************************** Thursday, 12 September 2013 13:42:24
		EditField(h+180,vm,95,"Order Done Date",Normal,OrderDoneDate,false,PasteCurDate);// Edit ************************** Thursday, 12 September 2013 13:42:24
		EditField(h+370,vm,95,"Official Ser.Nr.",Normal,OfficialSerNr,false,0); //Edit----------------------Dima  31.03.2015
		CheckBox(h4=-100,v,0,"OK",OKFlag);
  end else begin
    CheckBox(h4=-100,v+=vs,0,"OK",OKFlag);
  end;
  tilenr = 1;
  TileButton(tilenr,"Terms"); tilenr = tilenr + 1;
  TileButton(tilenr,"Items"); tilenr = tilenr + 1;
  if (HasMultiCurrency or HasBase2) then begin
    TileButton(tilenr,"Currency"); tilenr = tilenr + 1;
  end;
  if (HasModIN) then begin
    TileButton(tilenr,"Del. Terms"); tilenr = tilenr + 1;
  end;
  TileButton(tilenr,"Comment"); tilenr = tilenr + 1;
  TileButton(tilenr,"Ord. Address"); tilenr = tilenr + 1;
  TileButton(tilenr,"Del. Address"); tilenr = tilenr + 1;
  if (IsEnterprise) then begin
    TileButton(tilenr,"Extra Costs"); tilenr = tilenr + 1;
  end;
  tilenr = 1;
  Tile(tilenr,90,false,tilenr,TransDate); tilenr = tilenr + 1;
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -100;
  EditField(h1,vm=(v=6),82,"Date",Normal,TransDate,false,PasteCurDate);
  EditField(h1,v+=vs,25,"Payment Terms",Normal,PayDeal,false,PDSClass);
  if (IsEnterprise) then begin
    EditField(h1,v+=vs,82,"Valid Until",Normal,ValidUntil,false,PasteCurDate);
  end;
  if (HasModIN) then begin
    EditField(h1,v+=vs,82,"Planned Delivery",Normal,PlanShip,false,PasteCurDate);
  end;
  EditField(h2,v=vm,135,"Our Reference",Normal,OurContact,false,0);
  EditField(h2,v+=vs,135,"Attention",Normal,VEContact,false,ContactSClass);
  if (HasObjects) then begin
    EditField(h2,v+=vs,135,"Objects",Normal,Objects,false,ObjSClass);
  end;
  if (HasModIN) then begin
    EditField(h2,v+=vs,135,"Reference",Normal,Reference,false,0);
  end;
  EditField(h3,v=vm,80,"#Salesman#",Normal,SalesMan,false,UserSClass);
  if (HasModTS) then begin
    //EditField(h3,v+=vs,80,"Project",Normal,PRCode,false,PRSClass);
    EditField(h3,v+=vs,80,"Confirmation Date",Normal,OKDate,false,PasteCurDate);// Edit ************************** Monday, 3 November 2014 11:53:05
  end;
  if (IsEnterprise) then begin
    EditField(h3,v+=vs,80,"Purch. Ord. Class",Normal,POClass,false,POrderClassSClass);
    EditField(h3,v+=vs,80,"Order Type",ViewOnly,OrderType,false,0);
  end;
  CheckBox(h4,v=6,0,"Closed",Closed);
  CheckBox(h4,v+=16,0,"Price Incl. #VAT#",InclVAT);
  EnterSkip(Math);
  Tile(tilenr,120,true,tilenr,Math); tilenr = tilenr + 1;
  if (HasMultiCurrency or HasBase2) then begin
    EditField(50,-41,30,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
    EditField(150,-41,30,"Chk. Curncy",Normal,CheckCurncyCode,false,CurncyCodeSClass);// Edit ************************** Wednesday, 10 December 2014 15:59:35
  end;
  if (IsEnterprise) then begin
    EditField(110,-21,70,"Pallets",ViewOnly,TotPalletNr,true,0);
    EditField(260,-41,70,"Freight",Normal,ShipCost,true,0);
    EditField(260,-21,70,"Customs",Normal,CustomsCost,true,0);
  end;
  EditField(410,-41,70,"#VAT#",ViewOnly,Sum3,true,0);
  if (IsEnterprise) then begin
    EditField(410,-21,70,"Ext. Tax",ViewOnly,TAX1Sum,false,0);
  end;
  EditField(-169,-41,118,"Subtotal",ViewOnly,Sum1,true,0);
  EditField(-169,-21,118,"TOTAL",ViewOnly,Sum4,true,0);
//  CheckBox(20,-21,0,"OK",OKFlag);
  v = 24;
  if (HasModIN or HasModPL or HasObjects) then begin
    MatrixBegin(3,v,-50,-44,-,2000);
  end else begin
    MatrixBegin(3,v,-25,-44,-,2000);
  end;
  MatTypedRow(stp);
  Flip(0);
  MatCol(1,28,"Item",0,ArtCode,false,INSClass);
//  MatCol(1,84,"Var",0,VARList,true,VARSClass);
//  MatCol(1,144,"Qty",0,Quant,true,0);
  
  EnterSkip(ArtCode);
//  MatCol(1,194,"Description",0,Spec,false,0);
  flipnr = 1;
  Flip(flipnr); flipnr = flipnr + 1;
  if (HasVarieties) then begin
    MatCol(1,94,"Qty",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(1,94,"Qty",0,Quant,true,0);
  end;
  
  
  MatColTL(1,164,"Unit",0,M4Code,ViewOnly,5,UnitCode,false,UnitSCLass);
  MatCol(1,204,"Description",0,Spec,false,0);
  //if (HasJewelleryInterface) then begin
    MatCol(1,-337,"Item Type",0,ConsgType,false,SetSClass);// Edit ************************** Wednesday, 17 December 2014 12:37:08
  //end;
  MatCol(1,-237,"Unit Price",0,Price,true,0);
  MatCol(1,-151,"%",0,vRebate,true,0);
  MatCol(1,-116,"Sum",0,Sum,true,0);
  if (CYb.UseTaxTemplatesforTaxCalc!=0) then begin
    MatCol(1,-30,"T-Cd",0,TaxTemplateCode,false,TaxTemplateSClass);
  end else begin
    MatCol(1,-30,"#V-Cd#",0,VATCode,false,VATCodeSClass);
  end;
  if (HasObjects) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,164,"Description",0,Spec,false,0);
    if (IsEnterprise) then begin
      MatCol(1,-310,"Purch. A/C",0,CostAcc,false,AccSClass);
    end;
    MatCol(1,-240,"Objects",0,Objects,false,ObjSClass);
    if (IsEnterprise) then begin
      MatCol(1,-170,"#Supp.# Item",0,VEArtCode,false,PISClass);
      MatColTL(1,-100,"#S.# Unit",0,M4Code,ViewOnly,5,VEUnit,false,UnitSCLass);//MatCol(1,-100,"#S.# Unit",0,VEUnit,false,UnitSCLass);
      MatCol(1,-50,"#Supp.# Qty",0,VEQuant,true,0);
    end;
  end;
  if (HasModIN) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,164,"Description",0,Spec,false,0);
    MatCol(1,-330,"Recv. 1",0,Shipd1,true,0);
    MatCol(1,-270,"Recv. 2",0,Shipd2,true,0);
    if (HasModPL) then begin
      MatCol(1,-210,"Invoiced",0,Invd,true,0);
    end;
    if (IsEnterprise) then begin
      MatCol(1,-150,"Pallet No.",0,PalletNr,true,0);
      MatCol(1,-90,"Project",0,PRCode,true,PRSClass);
      MatCol(1,-40,"WS No.",0,WSNr,true,0);
    end;
  end;
  if (IsEnterprise) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,164,"Description",0,Spec,false,0);
    MatCol(1,-400,"#Stock# Type",0,StockType,false,SetSClass);
    MatCol(1,-300,"TREO",0,TREO,false,SetSClass);
    MatCol(1,-200,"Plan. Del.",0,PlanShipRow,true,PasteCurDate);
    //MatCol(1,-100,"Comment",0,Comment,true,0);// Edit ************************** Monday, 3 November 2014 11:53:33
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,164,"Description",0,Spec,false,0);
    MatCol(1,-420,"Fr. Cost",0,ShipCost,true,0);
    MatCol(1,-360,"Customs",0,CustomsCost,true,0);
    label = UserDefined("AccBlock","PUCost1");
    if (blank(label)) then begin label = "Cost 1";end;
    MatCol(1,-300,label,0,RowCost1,true,0);
    label = UserDefined("AccBlock","PUCost2");
    if (blank(label)) then begin label = "Cost 2";end;
    MatCol(1,-240,label,0,RowCost2,true,0);
    label = UserDefined("AccBlock","PUCost3");
    if (blank(label)) then begin label = "Cost 3";end;
    MatCol(1,-180,label,0,RowCost3,true,0);
    label = UserDefined("AccBlock","PUCost4");
    if (blank(label)) then begin label = "Cost 4";end;
    MatCol(1,-120,label,0,RowCost4,true,0);
    label = UserDefined("AccBlock","PUCost5");
    if (blank(label)) then begin label = "Cost 5";end;
    MatCol(1,-60,label,0,RowCost5,true,0);
  end;
  // Edit Start ---------------------------------------------- Edit Start
	//Monday, 3 November 2014 11:54:34
	
  Flip(flipnr); flipnr = flipnr + 1;
  switch(currentcompany)begin
	case 11:
				MatCol(1,194,"Name",0,Spec,false,0);
				if (HasVarieties) then begin
					MatCol(1,-300,"Qty",0,VEQuant,true,MATVARINSClass);
				end else begin
					MatCol(1,-300,"Qty",0,VEQuant,true,0); 
				end;
	
				MatCol(1,-250,"EAN Code",0,EAN13Code,false,0);
				MatCol(1,-170,"Classification",0,xClassification,false,DISClass);
				MatCol(1,-60,"PP #",0,PPNum,true,0);
				
	case 10:
			MatCol(1,194,"Name",0,Spec,false,0);
			MatCol(1,300,"Vendor Code",0,Comment,false,0);
			if (HasVarieties) then begin
				MatCol(1,-300,"Qty",0,VEQuant,true,MATVARINSClass);
			end else begin
				MatCol(1,-300,"Qty",0,VEQuant,true,0); 
			end;
			MatCol(1,-250,"EAN Code",0,EAN13Code,false,0);
			MatCol(1,-170,"Classification",0,xClassification,false,DISClass);
			MatCol(1,-60,"Price",0,Price,true,0);
			
	otherwise begin
			MatCol(1,194,"Name",0,Spec,false,0);
			if (HasVarieties) then begin
				MatCol(1,-300,"Qty",0,VEQuant,true,MATVARINSClass);
			end else begin
				MatCol(1,-300,"Qty",0,VEQuant,true,0); 
			end;

			MatCol(1,-250,"EAN Code",0,EAN13Code,false,0);
			MatCol(1,-170,"Classification",0,xClassification,false,DISClass);
			MatCol(1,-60,"Price",0,Price,true,0);
			
		end;		
	
  end;
  
  switch(currentcompany)begin
	case 10:
				Flip(flipnr); flipnr = flipnr + 1;
				MatCol(1,194,"Name",0,Spec,false,0);
				MatCol(1,-350,"Collection",0,Reference,false,0);
				MatCol(1,-300,"Bracelet/Strap",0,BrcStr,false,0);
				MatCol(1,-240,"Colour of the dial",0,Gender,false,0);
				MatCol(1,-180,"Weight",0,RowWeight,false,0);
				MatCol(1,-120,"Metal",0,Metal,false,0);
				MatCol(1,-60,"Carat",0,MajStoneDet,true,0);
	case 12:
				Flip(flipnr); flipnr = flipnr + 1;
				MatCol(1,194,"Name",0,Spec,false,0);
				MatCol(1,-160,"Size",0,Size,false,0);
				MatCol(1,-100,"Color",0,Colour,false,0);
				
				
  end;
  
  
	// Edit End ---------------------------------------------- Edit End
	
  
  DeleteRowTest;
  InsertRowTest;
  EndMatrix;
  vs = 20;
  v = 18; 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1));
      v = v + vs;
    end;
  end;
  if (HasMultiCurrency or HasBase2) then begin
    Tile(tilenr,70,false,tilenr,FrRate); tilenr = tilenr + 1;
    vs = 20; h = 110; h2 = 295;
    if (HasBase2) then begin
      h1 = h1 + 20;
    end;
    EditField(h1,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
    if (HasMultiCurrency) then begin
      EditField(h2,v,50,"Rate",Normal,FrRate,true,0);
      EditField(h2+65,v,50,":",Normal,ToRateB1,true,0);
      if (HasBase2) then begin
        StaticText(h2+125,v+14,"Base Currency 1",false);
        EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
        EditField(h2+65,v,50,":",Normal,ToRateB2,true,0);
        StaticText(h2+125,v+14,"Base Currency 2",false);
        EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
      end else begin
        StaticText(h2+125,v+14,"Base Currency",false);
      end;
    end else begin
      EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
      EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
    end;
  end;

  if (HasModIN) then begin
    Tile(tilenr,90,false,tilenr,ShipDeal); tilenr = tilenr + 1;
    vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -100;
    EditField(h1,v=6,80,"Delivery Terms",Normal,ShipDeal,false,ShipDealSClass);
    if (IsEnterprise) then begin
      EditField(h1,v+=vs,80,"Delivery Mode",Normal,ShipMode,false,DMSClass);
    end;
    if (HasMultiLocations) then begin
      EditField(h1,v+=vs,80,"Location",Normal,Location,false,LocationSClass);
    end;
    if (IsEnterprise) then begin
      EditField(h1,v+=vs,80,"Branch",ViewOnly,BranchID,false,AllCUSClass);
//  EditField(h2,v=vm,80,"Total Quantity",ViewOnly,TotQty,true,0);
//  EditField(h2,v+=vs,80,"Total Weight",ViewOnly,TotWeight,true,0);
//  EditField(h2,v+=vs,80,"Total Volume",ViewOnly,TotVolume,true,0);
      EditField(h2,v=vm,80,"Serv. Order No.",Normal,SVONr,false,0);
      EditField(h2,v+=vs,80,"Work Order No.",Normal,WONr,false,0);
      EditField(h2,v+=vs,80,"P/O Process No.",Normal,POCQStatNr,true,POCQStatSClass);
      EditField(h2,v+=vs,80,"PO Contract No.",ViewOnly,POCOSerNr,true,0);
      CheckBox(473,v=vm,0,"Invoice Before Goods Receipt",InvBeforePU);
    end;
  end;
  if (IsEnterprise) then begin
    Tile(tilenr,90,false,tilenr,LangCode); tilenr = tilenr + 1;
    EditField(h1,v=6,80,"Discount Matrix",Normal,RebCode,false,RebSClass);
    EditField(h1,v+=vs,80,"Factoring",Normal,VEFactoring,false,VESClass);
    EditField(h1,v+=vs,80,"Order No.",Normal,OrdNr,false,0);
    EditField(h1,v+=vs,-20,"Comment",Normal,Comment,false,0);
    EditField(h2,v=vm,80,"Sales Group",Normal,SalesGroup,false,SalesGroupSClass);
    EditField(h2,v+=vs,80,"Invoice To",Normal,InvoiceToCode,false,VESClass);
    EditField(h2,v+=vs,80,"Purchase Cost",Normal,CostPerUnit,true,0);
    EditField(h3,v=vm,80,"Language",Normal,LangCode,false,LangSClass);
  end else begin
    Tile(tilenr,20,false,tilenr,Comment); tilenr = tilenr + 1;
    EditField(h1,v=6,-20,"Comment",Normal,Comment,false,0);
  end;
  Tile(tilenr,230,false,tilenr,Addr1); tilenr = tilenr + 1;
  label = UserDefined("CUVc","InvAddr0");
  if (blank(label)) then begin label = "Ordering"; end;
  EditField(h=110,v=6,-20,label,Normal,Addr1,false,0);
  label = UserDefined("CUVc","InvAddr1");
  if (blank(label)) then begin label = "Address"; end;
  EditField(h,v+=vs, -20,label,Normal,Addr2,false,0);
  label = UserDefined("CUVc","InvAddr2");
  EditField(h,v+=vs, -20,label,Normal,Addr3,false,0);
  label = UserDefined("CUVc","InvAddr3");
  EditField(h,v+=vs, -20,label,Normal,InvAddr3,false,0);
  label = UserDefined("CUVc","InvAddr4");
  //EditField(h,vm=(v+=vs), -20,label,Normal,InvAddr4,false,0);// Edit ************************** Monday, 3 November 2014 11:57:16
  if (HasApprovals) then begin
    ButtonFrame(h3=h+4,v=(vm+=40),123,6,"Approval Status");
    RadioButton(h3,v,kAcceptanceStateNotRequired,0,"Not Required",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateNotStarted,0,"Not Started",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateNotRequested,0,"Not Requested",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStatePending,0,"Pending",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateApproved,0,"Approved",AcceptanceStatus);
    RadioButton(h3,v+=16,kAcceptanceStateRejected,0,"Rejected",AcceptanceStatus);  
  end;
  if (IsEnterprise) then begin
    //v = VATZoneButtonsLabelsENG(h3=290,v=vm,140,16);// Edit ************************** Saturday, 19 August 2017 11:40:12
    EditField(h2=-170,v=vm,150,"Region",Normal,Region,false,RegionSClass); 
//  EditField(h2,v+=vs,150,"#VAT Reg. No.#",Normal,VATNr,false,0);
//  EditField(h2,v+=vs,150,"Telephone",Normal,Phone,false,0);
//  EditField(h2,v+=vs,150,"Fax",Normal,Fax,false,0);
  end;
  Tile(tilenr,130,false,tilenr,ShipAddr0); tilenr = tilenr + 1;
  EditField(h,v=6,-20,"Delivery",Normal,ShipAddr0,false,0);
  EditField(h,v+=vs,-20,"Address",Normal,ShipAddr1,false,0);
  EditField(h,v+=vs,-20,"",Normal,ShipAddr2,false,0);
  EditField(h,v+=vs,-20,"",Normal,ShipAddr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,DelAddr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,DelAddr4,false,0);
  if (IsEnterprise) then begin
    Tile(tilenr,70,false,tilenr,ShipCost); tilenr = tilenr + 1;
    vs = 20; h2 = 290; h3 = 530;
    label = UserDefined("AccBlock","PUCost1");
    if (blank(label)) then begin label = "Extra Cost 1";end;
    EditField(h1,v=6,70,label,Normal,Cost1,true,0);
    label = UserDefined("AccBlock","PUCost2");
    if (blank(label)) then begin label = "Extra Cost 2";end;
    EditField(h2,v,70,label,Normal,Cost2,true,0);
    label = UserDefined("AccBlock","PUCost3");
    if (blank(label)) then begin label = "Extra Cost 3";end;
    EditField(h1,v+=vs,70,label,Normal,Cost3,true,0);
    label = UserDefined("AccBlock","PUCost4");
    if (blank(label)) then begin label = "Extra Cost 4";end;
    EditField(h2,v,70,label,Normal,Cost4,true,0);
    label = UserDefined("AccBlock","PUCost5");
    if (blank(label)) then begin label = "Extra Cost 5";end;
    EditField(h1,v+=vs,70,label,Normal,Cost5,true,0);
    EnterSkip(TransDate);
    ButtonFrame(h3,v=16,130,2,"Extra Costs Calculation");
    RadioButton(h3,v,0,0,"Value",ExtraCostsCalculation);
    RadioButton(h3,v+=16,1,0,"Weight",ExtraCostsCalculation);
  end;
  if (HasModIN) then begin
    SpecialMenu("Create Goods Receipt",'L',0,"PUFromPODsm");
  end;
  if (IsEnterprise) then begin
    SpecialMenu("Create Shipment Notification",'l',0,"DropSHFromPODsm");
  end;
  if (HasModPL) then begin
    SpecialMenu("Create #Purchase Invoice#",'F',1,"VIFromPODsm");
  end;
  if (HasApprovals) then begin
    SpecialMenu("Send for Approval",' ',6,"POSendforAcceptancePODsm");
    SpecialMenu("Cancel Approval Request",' ',2,"CancelApprovalRequestDsm");
  end;
  if (HasModIN) then begin
    SpecialMenu("Item Status",'I',2,"ItemStatusPODsm");
  end;
  SpecialMenu("Item Search",'',1,"ItemSearchDsm");
  SpecialMenu("Table Search",'f',1,"TableSearchDsm");
  if (HaseMail) then begin
    SpecialMenu("Create e-mail",'m',3,"CreateMailFromPODsm");
  end;
  if (IsEnterprise) then begin
    SpecialMenu("Previous Purchase Prices",' ',4,"POLastPPrsm");
  end;
  SpecialMenu("Purchase Order Status",'r',5,"POStatRnPODsm");
  if (IsEnterprise) then begin
    SpecialMenu("Create Returned Goods",'B',6,"RetPUFromPODsm");
    SpecialMenu("Reservations",' ',6,"POReservPODsm");
    SpecialMenu("Open TAX Matrix",' ',25,"OpenVatMatrixPODsm"); 
  end;
  if(currentcompany==10)then begin
  	SpecialMenu("View calculated prices",' ',25,"ShowRRPPricesDsm"); // Edit ************************** Tuesday, 28 May 2013 10:23:02
  end;
  EndWindow;
end;

window NewINDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  integer tilenr,flipnr,f;
  real h,h1,h2,h3,h4,h5,v,vm,vs;
  string 255 label;
  WindowBegin("New Items",NewINDClass,CGview,-);
  SetWRect(20,80,830,400);//##cc
  Sizeable(-1,-1,-1,0);
  UseView(NewINVc);
  Tile(0,87,false,"",SerNr); 
  v = 6; vs = 20; h = 155; h1 = 300; h2 = 385; h3 = 395; h4 = 285; h5 = 433;
  EditField(h,v, 150,"SerNr",Normal,SerNr,false,0);
  EditField(h2,v,80,"Group",Normal,Group,false,ITSClass);
  EditField(h5+130,v,80,"User",ViewOnly,SalesMan,false,0);
  v=v+vs;
  EditField(h5+130,v,80,"Date",ViewOnly,TransDate,false,PasteCurDate);
  CheckBox(-110,v,0,"Create Item",OKFlag);
  
  tilenr = 1;
  TileButton(tilenr,"Price"); tilenr = tilenr + 1;
	TileButton(tilenr,"Juvel."); tilenr = tilenr + 1; 
  TileButton(tilenr,"Stock"); tilenr = tilenr + 1;
  TileButton(tilenr,"Structure"); tilenr = tilenr + 1;
  TileButton(tilenr,"Acc"); tilenr = tilenr + 1;
  TileButton(tilenr,"Matrix"); tilenr = tilenr + 1;
  tilenr = 1;

  
    Tile(tilenr,209,false,tilenr,Unittext); tilenr = tilenr + 1;
		EditField(h,v=6 ,100,"Unit",Normal,Unittext,false,UnitSClass);
		EditField(h,v+=vs,-240,"Object",Normal,Objects,false,ObjSClass);
		EditField(h,v+=vs,-240,"Classification",Normal,DispGroups,false,DISClass);
		ButtonFrame(h5+150,v=24,130,4,"Item Type");//##cc
		RadioButton(h5+150,v,kItemTypePlain,0,"Free",ItemType);
		RadioButton(h5+150,v+=16,kItemTypeStocked,0,"Stocked",ItemType);
		RadioButton(h5+150,v+=16,kItemTypeStructured,0,"Structure",ItemType);
		RadioButton(h5+150,v+=16,kItemTypeService,0,"Job",ItemType);
  	Tile(tilenr,110,false,tilenr,-); tilenr = tilenr + 1;
		EditField(h,v=6, 140,"Metal",Normal,Metal,false,0); 
		EditField(h,v+=vs, 140,"Weight",Normal,RowWeight,false,0); 
		EditField(h,v+=vs, 140,"Size",Normal,Size,false,0); 
		//EditField(h,v+=vs, 140,"",Normal,Length,false,0); 
		EditField(h,v+=vs, 140,"Reference",Normal,Reference,false,0); 
		v = 6; 
		EditField(h5+50,v, 140,"Major stone",Normal,MajStoneDet,false,0); // Edit ************************** Thursday, 11 April 2013 11:43:09
		EditField(h5+50,v+=vs, 140,"Color",Normal,Colour,false,0); 
    Tile(tilenr,170,false,tilenr,SerNrf);  tilenr = tilenr + 1; // Need to clean this Tile up!
		v = 6;
		vm = v;
		ButtonFrame(h1,v+=14,143,3,"Serial no.");//##cc
		RadioButton(h1,v,0,0,"No",SerNrf);
		RadioButton(h1,v+=16,1,0,"Each",SerNrf);
		RadioButton(h1,v+=16,2,0,"Part",SerNrf);
    Tile(tilenr,170,false,tilenr,Recepy);  tilenr = tilenr + 1;

		EditField(h2,v=6,150,"Bar Code",Normal,BarCode,false,0);
		EditField(h2,v+=vs,150,"EKN Code",Normal,EKNCode,false,0); // i think it is same as Commodity Code
		EditField(h2,v+=vs,150,"PP Code",Normal,CPSCode,false,0);// Edit ************************** Monday, 3 September 2012 09:29:01
		EditField(h,v+=vs,-40,"Alternative code",Normal,AlternativeCode,false,0);
    Tile(tilenr,170,false,tilenr,SalesAcc);  tilenr = tilenr + 1;
		v = 6;
		vm = v;
		
		EditField(h2=530,v=vm,40,"VAT Code",Normal,VATCode,false,VATCodeSClass);
		
		Tile(tilenr,400,true,tilenr,-);  tilenr = tilenr + 1;
		MatrixBegin(3,v+=32,-46,-20,-,1000);
		Flip(0);
		MatCol(1,28,"Item",0,Code,false,INSClass);
		flipnr = 1;
		Flip(flipnr); flipnr = flipnr + 1;
			MatCol(1,130,"Name",0,Name,false,0);
			MatCol(1,360,"Group",0,Group,false,ITSClass);
			MatCol(1,-280,"Unit",0,Unittext,false,UnitSClass);
			//MatCol(1,-240,"",0,ItemType,true,0);
			MatCol(1,-200,"Object",0,Objects,false,ObjSClass);
			MatCol(1,-120,"Classification",0,DispGroups,false,DISClass);
		Flip(flipnr); flipnr = flipnr + 1;
		MatCol(1,100,"Metal",0,Metal,false,0);
		MatCol(1,200,"Weight",0,RowWeight,false,0);
		MatCol(1,300,"Size",0,Size,false,0);
		MatCol(1,350,"Reference",0,Reference,false,0);
		MatCol(1,-220,"Major Stone",0,MajStoneDet,true,0);
		MatCol(1,-80,"Color",0,Colour,false,0);
		Flip(flipnr); flipnr = flipnr + 1;
		MatCol(1,130,"Name",0,Name,false,0);
		MatCol(1,-50,"SerNrf",0,SerNrf,false,0);
		Flip(flipnr); flipnr = flipnr + 1;
		MatCol(1,100,"Bar Code",0,BarCode,false,0);
		MatCol(1,200,"EKN Code",0,EKNCode,false,0);
		MatCol(1,300,"PP Code",0,CPSCode,false,0);
		MatCol(1,400,"Alternative code",0,AlternativeCode,false,0);
		Flip(flipnr); flipnr = flipnr + 1;
		MatCol(1,130,"Name",0,Name,false,0);
		MatCol(1,-160,"Cost",0,LastPurchPrice2,false,0);
		MatCol(1,-80,"Currency",0,LastPurchCurncyCode,false,CurncyCodeSClass);
		EndMatrix;
		vs = 22;
		v = v+1; 
		for (f=1;f<flipnr;f=f+1) begin
			VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1)); 
			v = v + vs;
		end;
		
  EndWindow;
end;

window NewINLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("New Item",NewINLClass,CGmlist,RcType);
  SetWRect(20,80,509,298);
  SpawnClass(NewINDClass);
  Sizeable(-1,-1,0,0);
  UseView(NewINVc);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"SerNr",SerNr,false,SerNr);
  RlColKey(81,81,"Date",TransDate,false,TransDate);
  RlColKey(240,79,"OK",OKFlag,false,OKFlag);
  RlColKey(-150,-150,"User",SalesMan,false,SalesMan);
  SearchField("Search");
  EndWindow;
end;

window ORDClass:2
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,t,v,vm,vs;
  string 255 label;
  WindowBegin("Order",ORDClass,CGview,-);
  SetWRect(20,80,750,460);
  Sizeable(-1,-1,0,0);
  UseView(ORVc);
  ActiveFieldOnNew("CustCode");    
  CommunicateButton;
  Tile(0,74,false,"",CustCode);
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"Customer",Normal,CustCode,false,CUSClass);
  EnterSkip(PayDeal);
  EditField(h=255,v=vm,-40,"Name",Normal,Addr0,false,0);
  EditField(h,vm=(v+=20),135,"Official No.",Normal,OfficialSerNr,false,LegalInvNrSClass);
  CheckBox(h4=-100,v,0,"OK",OKFlag);
//  CheckBox(h+120,vm,0,"Closed",Closed);
//  CheckBox(h+240,vm,0,"Reserved",Reserved);
  TileButton(1,"Terms");
  TileButton(2,"Items");
  TileButton(3,"Currency");
  TileButton(4,"Del. Terms");
  TileButton(5,"Price List");
  TileButton(6,"Inv. Address");
  TileButton(7,"Del. Address");
  Tile(1,110,false,"1",OrdDate);
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -100;
  EditField(h1,vm=(v=6),82,"Date",Normal,OrdDate,false,PasteCurDate);
  EditField(h1,v+=vs,25,"Payment Terms",Normal,PayDeal,false,PDSClass);
  EditField(h1,v+=vs,82,"Planned Delivery",Normal,PlanShip,false,PasteCurDate);
  EditField(h1,v+=vs,82,"#Despatch# Date",Normal,DespatchDate,false,PasteCurDate);
  EditField(h1,v+=vs,82,"#Despatch# Time",Normal,DespatchTime,false,PasteCurTime);
  EditField(h2,v=vm,135,"Our Reference",Normal,OurContact,false,0);
  EditField(h2,v+=vs,135,"Attention",Normal,CustContact,false,ContactSClass);
  EditField(h2,v+=vs,135,"Objects",Normal,Objects,false,ObjSClass);
  EditField(h2,v+=vs,135,"Reference",Normal,RefStr,false,0);
  EditField(h2,v+=vs,135,"Cust. Ord. No.",Normal,CustOrdNr,false,0);
  EditField(h3,v=vm,80,"#Salesman#",Normal,SalesMan,false,UserSClass);
  
  EditField(h3,v+=vs,80,"Confirmation Date",Normal,OKDate,false,PasteCurDate);// Edit ************************** Wednesday, 13 November 2013 16:16:50
  if(currentuser=="SA")then begin
		EditField(h3,v+=vs,80,"Project",Normal,PRCode,false,PRSClass);// Edit ************************** Monday, 13 January 2014 13:06:28
  end;
  
  EditField(h3,v+=vs,80,"Project",Normal,PRCode,false,PRSClass);
  EditField(h3,v+=vs,80,"Order Class",Normal,OrderClass,false,OrderClassSClass);
  EditField(h3,v+=vs,80,"Order Type",Normal,OrderType,false,SetSClass);
  EditField(h3,v+=vs,80,"Sales Contract",Normal,ORCONr,false,ORCOSClass);
  CheckBox(h4,v=6,0,"Closed",Closed);
  CheckBox(h4,v+=16,0,"Reserved",Reserved);
  EnterSkip(Math);
  Tile(2,220,true,"2",Math);
//  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(55,-41,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  if (UserCanAction("ViewCostPrice",true)) then begin
    EditField(150,-41,85,"GP %",Normal,GPProc,true,0);
    EditField(150,-21,85,"Total GP",ViewOnly,TotGP,true,0);
  end;
  EditField(290,-41,70,"TAX2",ViewOnly,TAX2Sum,true,0);
  EditField(290,-21,70,"Ext. Tax",ViewOnly,TAX1Sum,true,0);
  EditField(410,-41,100,"#VAT#",ViewOnly ,Sum3,true,0);
  EditField(410,-21,100,"Base",ViewOnly,BaseSum4,true,0);
  EditField(-150,-41,100,"Subtotal",ViewOnly ,Sum1,true,0);
  EditField(-150,-21,100,"TOTAL",ViewOnly ,Sum4,true,0);
  v = 24;
  MatrixBegin(3,v,-50,-49,-,200);
  MatTypedRow(stp);
  Flip(0);
  MatText(t=9,32,"Subtotal",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatColTL(t,-80,"Sum",0,-1,ViewOnly,0,Sum,true,0);
  MatText(t=17,32,"Header",true);
  MatCol(t,100,"",0,Spec,false,0);
  MatCol(t=1,32,"Item",0,ArtCode,false,INSClass);
//  MatCol(t,94,"Var",0,VARList,true,VARSClass);
//  MatCol(t,144,"Qty",0,Quant,true,0);
  t = 1;
  if (GuiType==kGuiiPhone) then begin
    MatCol(t,144,"Description",0,Spec,false,0);
  end;
  if (HasVarieties) then begin
    MatCol(t,94,"Qty",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(t,94,"Qty",0,Quant,true,0);
  end;
  EnterSkip(ArtCode);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,32,"Item",0,ArtCode,false,INSClass);
//  MatCol(t,94,"Var",0,VARList,true,VARSClass);
//  MatCol(t,144,"Qty",0,Quant,true,0);
  if (HasVarieties) then begin
    MatCol(t,94,"Qty",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(t,94,"Qty",0,Quant,true,0);
  end;
  EnterSkip(ArtCode);
  MatText(t=10,32,"This row and all rows below it will be hidden on printout",false);
  MatText(t=kInvoiceRowTypePerceptionTax,32,"Perception Tax",true);
  MatCol(t,132,"",0,Region,false,0);
  MatCol(t,252,"",0,TAX2Prc,true,0);
  MatCol(t,292,"",0,Sum,true,0);
  MatCol(t,372,"",0,SalesAcc,false,0);
  MatCol(t,452,"",0,Spec,false,0);
  Flip(1);
//  MatCol(t=1,194,"Description",0,Spec,false,0);
  t = 1;
  if (GuiType!=kGuiiPhone) then begin
    MatCol(t,144,"Description",0,Spec,false,0);
  end;
  MatCol(t,-235,"Unit Price",0,Price,true,PLSClass);
  MatCol(t,-135,"%",0,vRebate,true,0);
  MatCol(t,-100,"Sum",0,Sum,true,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  MatCol(t,-235,"Unit Price",0,Price,true,PLSClass);
  MatCol(t,-135,"%",0,vRebate,true,0);
  MatCol(t,-100,"Sum",0,Sum,true,0);
  Flip(2);
  t = 1;
  if (GuiType!=kGuiiPhone) then begin
    MatCol(t,144,"Description",0,Spec,false,0);
  end;
  if (UseTaxTemplatesforTaxCalc) then begin
    MatCol(t,-284,"Cust. Item No.",0,CustArtCode,false,CUINSClass);
    MatCol(t,-224,"A/C",0,SalesAcc,false,AccSClass);
    MatCol(t,-164,"Object",0,Objects,false,ObjSClass);
    MatCol(t,-70,"T-Cd",0,TaxTemplateCode,false,TaxTemplateSClass);
  end else begin
    MatCol(t,-264,"Cust. Item No.",0,CustArtCode,false,CUINSClass);
    MatCol(t,-184,"A/C",0,SalesAcc,false,AccSClass);
    MatCol(t,-124,"Object",0,Objects,false,ObjSClass);
    MatCol(t,-30,"#V-Cd#",0,VATCode,false,VATCodeSClass);
  end;
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  if (UseTaxTemplatesforTaxCalc) then begin
    MatCol(t,-284,"Cust. Item No.",0,CustArtCode,false,CUINSClass);
    MatCol(t,-224,"A/C",0,SalesAcc,false,AccSClass);
    MatCol(t,-164,"Object",0,Objects,false,ObjSClass);
    MatCol(t,-70,"T-Cd",0,TaxTemplateCode,false,TaxTemplateSClass);
  end else begin
    MatCol(t,-264,"Cust. Item No.",0,CustArtCode,false,CUINSClass);
    MatCol(t,-184,"A/C",0,SalesAcc,false,AccSClass);
    MatCol(t,-124,"Object",0,Objects,false,ObjSClass);
    MatCol(t,-30,"#V-Cd#",0,VATCode,false,VATCodeSClass);
  end;
  Flip(3);
  t = 1;
  if (GuiType!=kGuiiPhone) then begin
    MatCol(t,144,"Description",0,Spec,false,0);
  end;
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-245,"Unit Price",0,Price,true,PLSClass);
    MatCol(t,-175,"%",0,vRebate,true,0);
    MatCol(t,-140,"Cost",0,BasePrice,true,0);
    MatCol(t,-70,"GP",0,rowGP,true,0);
  end else begin
    MatCol(t,-235,"Unit Price",0,Price,true,PLSClass);
    MatCol(t,-135,"%",0,vRebate,true,0);
    MatCol(t,-100,"Sum",0,Sum,true,0);
  end;
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  if (UserCanAction("ViewCostPrice",true)) then begin
    MatCol(t,-245,"Unit Price",0,Price,true,PLSClass);
    MatCol(t,-175,"%",0,vRebate,true,0);
    MatCol(t,-140,"Cost",0,BasePrice,true,0);
    MatCol(t,-70,"GP",0,rowGP,true,0);
  end else begin
    MatCol(t,-235,"Unit Price",0,Price,true,PLSClass);
    MatCol(t,-135,"%",0,vRebate,true,0);
    MatCol(t,-100,"Sum",0,Sum,true,0);
  end;
  Flip(4);
  t = 1;
  if (GuiType!=kGuiiPhone) then begin
    MatCol(t,144,"Desc.",0,Spec,false,0);
  end;
  MatCol(t,-300,"#Salesmen#",0,Salesmen,false,UserSClass);
  MatCol(t,-236,"Del. 1",0,Shipd1,true,0);
  MatCol(t,-184,"Del. 2",0,Shipd2,true,0);
  MatCol(t,-132,"Invoiced",0,Invd,true,0);
  MatCol(t,-80,"Recipe",0,Recepy,false,RecSClass);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Desc.",0,Spec,false,0);
  MatCol(t,-290,"Del. 1",0,Shipd1,true,0);
  MatCol(t,-220,"Del. 2",0,Shipd2,true,0);
  MatCol(t,-150,"Invoiced",0,Invd,true,0);
  MatCol(t,-80,"Recipe",0,Recepy,false,RecSClass);
  Flip(5);
  t = 1;
  if (GuiType!=kGuiiPhone) then begin
    MatCol(t,144,"Description",0,Spec,false,0);
  end;
  MatCol(t,-290,"Serial No.",0,SerialNr,false,SerialNrSClass);
  MatCol(t,-150,"Plan. Del.",0,PlanShipRow,true,PasteCurDate);
  MatCol(t,-70,"Price Factor",0,PriceFactor,true,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  MatCol(t,-290,"Serial No.",0,SerialNr,false,SerialNrSClass);
  MatCol(t,-150,"Plan. Del.",0,PlanShipRow,true,PasteCurDate);
  MatCol(t,-70,"Price Factor",0,PriceFactor,true,0);
  Flip(6);
  t = 1;
  if (GuiType!=kGuiiPhone) then begin
    MatCol(t,144,"Description",0,Spec,false,0);
  end;
  MatCol(t,-315,"Delivery Note",0,ShipNote,false,0);
  MatCol(t,-210,"Location",0,Location,false,LocationSClass);
  MatCol(t,-145,"Position",0,Position,true,UsedPosSClass);
  MatCol(t,-90,"Source",0,Source,true,SourceSClass);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  MatCol(t,-315,"Delivery Note",0,ShipNote,false,0);
  MatCol(t,-210,"Location",0,Location,false,LocationSClass);
  MatCol(t,-145,"Position",0,Position,true,UsedPosSClass);
  MatCol(t,-90,"Source",0,Source,true,SourceSClass);
  Flip(7);
  MatCol(t=1,144,"Pick. Date",0,PickingDate,false,PasteCurDate);
  MatCol(t,-390,"Pick. Time",0,PickingTime,false,PasteCurTime);
  MatCol(t,-320,"Inl. Date",0,InloadingDate,true,PasteCurDate);
  MatCol(t,-230,"Inl. Time",0,InloadingTime,true,PasteCurTime);
  MatCol(t,-160,"#Desp.# Date",0,DespatchRowDate,true,PasteCurDate);
  MatCol(t,-70,"#Desp.# Time",0,DespatchRowTime,true,PasteCurTime);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Pick. Date",0,PickingDate,false,PasteCurDate);
  MatCol(t,-390,"Pick. Time",0,PickingTime,false,PasteCurTime);
  MatCol(t,-320,"Inl. Date",0,InloadingDate,true,PasteCurDate);
  MatCol(t,-230,"Inl. Time",0,InloadingTime,true,PasteCurTime);
  MatCol(t,-160,"#Desp.# Date",0,DespatchRowDate,true,PasteCurDate);
  MatCol(t,-70,"#Desp.# Time",0,DespatchRowTime,true,PasteCurTime);
  Flip(8);
  t = 1;
  if (GuiType!=kGuiiPhone) then begin
    MatCol(t,144,"Description",0,Spec,false,0);
  end;
  MatCol(t,-315,"Unit",0,UnitCode,false,UnitSClass);
  MatCol(t,-260,"Unit Qty",0,UnitFactQuant,true,0);
  MatCol(t,-200,"Width",0,UnitXval,true,0);
  MatCol(t,-160,"Height",0,UnitYval,true,0);
  MatCol(t,-120,"Depth",0,UnitZval,true,0);
  MatCol(t,-80,"Unit Pr.of Unit",0,UnitFactPrice,true,0);
  MatCol(t=kInvoiceRowTypeStructuredItemComponent,144,"Description",0,Spec,false,0);
  MatCol(t,-315,"Unit",0,UnitCode,false,UnitSClass);
  MatCol(t,-260,"Unit Qty",0,UnitFactQuant,true,0);
  MatCol(t,-200,"Width",0,UnitXval,true,0);
  MatCol(t,-160,"Height",0,UnitYval,true,0);
  MatCol(t,-120,"Depth",0,UnitZval,true,0);
  MatCol(t,-80,"Unit Pr.of Unit",0,UnitFactPrice,true,0);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,2,"B");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,3,"C");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,4,"D");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,5,"E");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,6,"F");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,7,"G");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,8,"H");
  Tile(3,70,false,"3",FrRate);
  vs = 20;
  EditField(h1,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2,v,50,"Rate",Normal,FrRate,true,0);
  EditField(h2+65,v,50,":",Normal,ToRateB1,true,0);
  StaticText(h2+125,v+12,"Base Currency 1",false);
  EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
  EditField(h2+65,v,50,":",Normal,ToRateB2,true,0);
  StaticText(h2+125,v+12,"Base Currency 2",false);
  EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
  Tile(4,110,false,"4",ShipDeal);
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -100;
  EditField(h1,v=6,80,"Delivery Terms",Normal,ShipDeal,false,ShipDealSClass);
  EditField(h1,v+=vs,80,"Delivery Mode",Normal,ShipMode,false,DMSClass);
  EditField(h1,v+=vs,80,"Route",Normal,Sorting,false,DelRouteSClass);
  EditField(h1,v+=vs,80,"Location",Normal,Location,false,LocationSClass);
  EditField(h1,v+=vs,80,"Branch",ViewOnly,BranchID,false,AllCUSClass);
  EditField(h2,v=vm,80,"Total Quantity",ViewOnly,TotQty,true,0);
  EditField(h2,v+=vs,80,"Total Weight",ViewOnly,TotWeight,true,0);
  EditField(h2,v+=vs,80,"Total Volume",ViewOnly,TotVolume,true,0);
  EditField(h2,v+=vs,80,"Freight",Normal,FrPrice,true,0);
  EditField(h3,v,80,"Freight #V-Cd#",Normal,FrVATCode,true,VATCodeSClass);
  CheckBox(473,v=vm,0,"Invoice Before Delivery",InvBeforeShip);
  Tile(5,130,false,"5",PriceList);
  h3 = 530;
  EditField(h1,v=vm,80,"Price List",Normal,PriceList,false,PLDefSClass);
  EditField(h1,v+=vs,80,"Discount Matrix",ViewOnly,RebCode,false,0); 
//  EditField(h2,v+=vs,80,"Disc %",ViewOnly,DiscPerc,false,0);
//  EditField(h2,v+=vs,80,"Disc Amnt",ViewOnly,DiscSum,false,0);
  EditField(h1,v+=vs,80,"Invoice To",Normal,InvoiceToCode,false,CUSClass);
  EditField(h1,v+=vs,80,"Credit Card",Normal,CreditCard,false,CreditCardSClass);
  EditField(h1,v+=vs,80,"#Authorisation#",Normal,AuthorizationCode,false,0);
  EditField(h1,v+=vs,-20,"Comment",Normal,Comment,false,0);
  EditField(h2,v=vm,80,"Sales Group",Normal,SalesGroup,false,SalesGroupSClass);
  EditField(h2,v+=vs,80,"Language",Normal,LangCode,false,LangSClass);
  EditField(h2,v+=vs,80,"Commission",Normal,Commision,true,0);
  EditField(h2,v+=vs,80,"Total Incl. Com.",ViewOnly,SumIncCom,true,0);
  EditField(h3,v=vm,80,"TREO No.",Normal,TREONr,false,0);
  EditField(h3,v+=vs,80,"TREO Expiry Date",Normal,TREOExpDate,false,PasteCurDate);
  Tile(6,250,false,"6",Addr1);
  label = UserDefined("CUVc","InvAddr0");
  if (blank(label)) then begin label = "Invoice"; end;
  EditField(h=110,v=6,-20,label,Normal,Addr1,false,0);
  label = UserDefined("CUVc","InvAddr1");
  if (blank(label)) then begin label = "Address"; end;
  EditField(h,v+=vs, -20,label,Normal,Addr2,false,0);
  label = UserDefined("CUVc","InvAddr2");
  EditField(h,v+=vs, -20,label,Normal,Addr3,false,0);
  label = UserDefined("CUVc","InvAddr3");
  EditField(h,v+=vs, -20,label,Normal,InvAddr3,false,0);
  label = UserDefined("CUVc","InvAddr4");
  EditField(h,v+=vs, -20,label,Normal,InvAddr4,false,0);
  EditField(h,vm=(v+=vs),80,"Country",Normal,InvCountry,false,CountrySClass);
  ButtonFrame(h3=h+4,v=(vm+=40),123,6,"Approval Status");
  RadioButton(h3,v,kAcceptanceStateNotRequired,0,"Not Required",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateNotStarted,0,"Not Started",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateNotRequested,0,"Not Requested",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStatePending,0,"Pending",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateApproved,0,"Approved",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateRejected,0,"Rejected",AcceptanceStatus);  
  //v = VATZoneButtonsLabelsENG(h3=290,v=vm,140,16);// Edit ************************** Saturday, 19 August 2017 11:40:17
  EditField(h2=-170,v=vm,150,"Region",Normal,Region,false,RegionSClass); 
  EditField(h2,v+=vs,150,"#VAT Reg. No.#",Normal,VATNr,false,0);
  EditField(h2,v+=vs,150,"Telephone",Normal,Phone,false,0);
  EditField(h2,v+=vs,150,"Fax",Normal,Fax,false,0);
  Tile(7,170,false,"7",ShipAddr0);
  EditField(h1,v=6,80,"Address Code",Normal,DelAddrCode,false,DelAddr3SClass);
  EditField(h1,v+=vs,-20,"Delivery",Normal,ShipAddr0,false,0);
  EditField(h1,v+=vs,-20,"Address",Normal,ShipAddr1,false,0);
  EditField(h1,v+=vs,-20,"",Normal,ShipAddr2,false,0);
  EditField(h1,v+=vs,-20,"",Normal,ShipAddr3,false,0);
  EditField(h1,v+=vs,-20,"",Normal,DelAddr3,false,0);
  EditField(h1,v+=vs,-20,"",Normal,DelAddr4,false,0);
  EditField(h1,v+=vs,80,"Country",Normal,DelCountry,false,CountrySClass);
  //EditField(h1+200,v,80,"#VAT Code#",Normal,CustVATCode,false,0);
  EnterSkip(OrdDate);
  //SpecialMenu("Add Header Line",' ',13,"ORAddHeaderLine");
  //SpecialMenu("Add Hidden Line",' ',13,"ORAddHidLine");
  //SpecialMenu("Add Subtotal",' ',14,"SubtotalORDsm");
  //SpecialMenu("Recalculate Discount",' ',11,"RecalcDiscountORDsm");
  //SpecialMenu("Recalculate Weight and Volume",' ',10,"RecalculateWeightORDsm");
  //SpecialMenu("Update Currency Price List Items",' ',7,"UpdatePricesORDsm");
  SpecialMenu("Item Status",'I',2,"ItemStatusORDsm");
  SpecialMenu("Item Search",'f',1,"ItemSearchDsm");
  SpecialMenu("Order Status",'r',5,"ORInfoRnORDsm");
  //SpecialMenu("Previous Sales Prices",' ',12,"ORLastSPrsm");
  //SpecialMenu("Print Internal Order",' ',4,"Or2FormORDsm");
  //SpecialMenu("Reservations",' ',15,"OrderReservORDsm");
  //SpecialMenu("Send for Approval",' ',6,"ORSendforAcceptanceORDsm");
  //SpecialMenu("Cancel Approval Request",' ',2,"CancelApprovalRequestDsm");
  //SpecialMenu("Create Activity",'c',9,"CreateActFromORDsm");
  SpecialMenu("Create Delivery",'L',0,"SHFromORDsm");
  SpecialMenu("Create Down Payment Invoice",'o',3,"DownPayFromORDsm");
  //SpecialMenu("Create E-Mail",'m',11,"CreateMailFromORDsm");
  SpecialMenu("Create Invoice",'F',1,"IVFromORDsm");
  /*if (HasModTS) then begin
    SpecialMenu("Create Project",' ',9,"CreatePRFromORDsm");
    SpecialMenu("Create Project Budget",' ',10,"CreateTBBUFromORDsm");
  end;
  if (GuiType==kGuiiPhone) then begin
    SpecialMenu("Sign",' ',10,"SignORDsm");
  end;*/
  SpecialMenu("Create Returned Goods",'B',6,"RetFromORsm");
  //SpecialMenu("Create #Stock# Movement",' ',8,"StockMovFromORDsm");
  //SpecialMenu("Open TAX Matrix",' ',25,"OpenVatMatrixORDsm"); 
  SpecialMenu("Create Purchase Order",' ',25,"CreatePOfromORDsm"); // Edit ************************** Thursday, 12 September 2013 09:08:18
  SpecialMenu("Purchase Order Status",' ',25,"POfromORstatusDsm"); // Edit ************************** Thursday, 12 September 2013 09:08:18
  SpecialMenu("Order tracker Status",' ',25,"ORTrackstatusDsm"); // Edit ************************** Thursday, 12 September 2013 09:08:18
  SpecialMenu("Calc shipment date",' ',25,"ORDeliverTimeDsm"); // Edit ************************** Thursday, 14 November 2013 13:30:27

  EndWindow;
end;

window ImportPLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
real v;
WindowBegin("Prices Import",ImportPLClass,CGIcW,RcType);
  SetWRect(80,80,400,250);
   StaticText(20,v=20,"Import format:",false);
   StaticText(25,v+=20,"* Price List Code",false);
   StaticText(25,v+=20,"* Item Code",false);
   StaticText(25,v+=20,"* Price",false);
   StaticText(25,v+=20,"* Curncy (if required)",false);
	 StaticText(25,v+=20,"* Serial number (if required)",false);
	 
	 StaticText(20,v+=40,"Import file mast be TAB delimited text",false);
  EndWindow;
end;


window RetDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,v,vm,vs;
  WindowBegin("Goods return from customer",RetDClass,CGview,-);
  SetWRect(20,80,750,460);
  Sizeable(-1,-1,0,0);
  UseView(RetVc);
  ActiveFieldOnNew("CustCode");
  Tile(0,74,false,"",TransDate);
  v = 6; vs = 20;
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"Customer",Normal,CustCode,false,CUSClass);
  EditField(h=275,v=vm,-40,"Name",Normal,CustName,false,0);
  EditField(h,vm=(v+=20),135,"Off. number",Normal,OfficialSerNr,false,LegalInvNrSClass);
//  EditField(h+210,v,82, "Employee",Normal,EMCode,false,UserSClass);
  CheckBox(h4=-100,v,0,"OK",OKFlag);
  TileButton(1,"Deals");
  TileButton(2,"Items");
  TileButton(3,"Currency");
  TileButton(4,"Comment");
  Tile(1,90,false,"1",Location);
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = -110;
  EditField(h1,vm=(v=6),82,"Date",Normal,TransDate,false,PasteCurDate);
  EditField(h1,v+=vs,82,"Location",Normal,Location,false,LocationSClass);
  EditField(h1,v+=vs,82,"Reason",Normal,Reason,false,StandProblemsSClass);
  EditField(h1,v+=vs,82,"Objects",Normal,Objects,false,ObjSClass);
  EditField(h2,v=vm,135,"Order number",ViewOnly,OrdNr,false,0);
  EditField(h2,v+=vs,135,"Shipment number",ViewOnly,SHNr,false,0);
  EditField(h2,v+=vs,135,"Service order ",ViewOnly,SVONr,false,0);
  EditField(h2,v+=vs,135,"Work sheet ",ViewOnly,WSNr,false,0);
  EnterSkip(Math);
  ButtonFrame(h3=h3-70,v=vm+10,140,2,"To decrease quantity");
  RadioButton(h3,v,0,0,"Shipped only",Type);
  RadioButton(h3,v+=16,1,0,"Ordered and shipped",Type);
  CheckBox(h4,v=vm+10,0,"Update #Stock#",UpdStockFlag);
  CheckBox(h4,v+=16,0,"Price Incl.#VAT#",InclVAT);
  CheckBox(h4,v+=16,0,"No #Credit Notes#",Closed);
  Tile(2,79,true,"2",Math);
  v = 24;
  MatrixBegin(4,v,-50,-22,-,199);
  Flip(0);
  MatCol(1,24,"Item",0,ArtCode,false,INSClass);
//  MatCol(1,84,"Var",0,VARList,true,VARSClass);
//  MatCol(1,144,"Qty",0,Quant,true,0);
  MatCol(1,94,"Qty",0,Quant,true,0);
  Flip(1);
//  MatCol(1,194,"Description",0,Spec,false,0);
  MatCol(1,144,"Description",0,Spec,false,0);
  MatCol(1,-228,"Price",0,UPrice,true,0);
  MatCol(1,-160,"Extra Cost",0,Extra,true,0);
  MatCol(1,-80,"Unit Cost",0,CostPrice,true,0);
  Flip(2);
  MatCol(1,134,"Objects",0,Objects,false,ObjSClass);
  MatCol(1,264,"Invoiced",0,Invd,false,0);
  MatColTL(1,-300,"Location",0,M4UStr,ViewOnly,0,Location,false,0);
  MatCol(1,-240,"Cost A/C",0,CostAcc,false,AccSClass); // Edit ************************** Thursday, 22 January 2015 11:25:13
  //MatColTL(1,-240,"Cost A/C",0,M4UStr,Normal,0,CostAcc,false,AccSClass);
  MatCol(1,-180,"Serial No.",0,SerialNr,false,SerialNrSClass);
  MatCol(1,-80,"Best Before",0,BestBefore,false,0);
  Flip(3);
  MatCol(1,144,"Objects",0,Objects,false,ObjSClass);
  MatCol(1,-450,"BuyBack Pr.",0,BBCostPrice,false,0);//##cc
  MatCol(1,-290,"Position",0,PosCode,false,FreePosSClass);//##cc
  MatColTL(1,-240,"Recipe",0,M4Ustr,ViewOnly,0,Recepy,false,0);
  MatCol(1,-180,"Width",0,UnitXval,true,0);
  MatCol(1,-120,"Height",0,UnitYval,true,0);
  MatCol(1,-60,"Depth",0,UnitZval,true,0);
  Flip(4);
  MatCol(1,144,"Description",0,Spec,false,0);
  MatCol(1,-225,"Item Type",0,WSIVType,false,SetSClass);
  MatCol(1,-150,"Main Serial No.",0,MotherNr,false,SerialNrSClass);
  InsertRowTest;
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,2,"B");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,3,"C");
  v=v+ vs; VTab(-35,v,-16,v+vs,ToolFlip,4,"D");
  //  CheckBox(20,-20,0,"OK",OKFlag);
  EditField(110,-20,50,"Total Qty",ViewOnly,SumQuant,true,0);
  Tile(3,70,false,"3",FrRate);
  vs = 20;
  EditField(h1,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
  EditField(h2,v,50,"Rate",Normal,FrRate,true,0);
  EditField(h2+65,v,50,":",Normal,ToRateB1,true,0);
  StaticText(h2+125,v+12,"Base Currency 1",false);
  EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
  EditField(h2+65,v,50,":",Normal,ToRateB2,true,0);
  StaticText(h2+125,v+12,"Base Currency 2",false);
  EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
  Tile(4,30,false,"4",Comment);
  EditField(h1,v=6,-20,"Comment",Normal,Comment,false,0);
  SpecialMenu("Item Search",'',1,"ItemSearchDsm");
  SpecialMenu("Current table lookup",'f',1,"TableSearchDsm");
  SpecialMenu("Table Search",'f',1,"TableSearchDsm"); //Edit----------------Dima  17.12.2014
  SpecialMenu("Open #NL# Transaction",'t',0,"OpenTRFromRet");
  SpecialMenu("Create #Credit Note#",'F',1,"CreditIVFromRetsm");
  SpecialMenu("Quality Control",'u',10,"QualConFromRetDsm");
  EndWindow;
end;



window IntORDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,t,v,vm,vs;
  WindowBegin("Internal Order",IntORDClass,CGview,-);
  SetWRect(20,80,615,350);
  Sizeable(-1,-1,0,0);
  UseView(IntORVc);
  FormName(IntORForm);
  ActiveFieldOnNew("OurUser");      
  h = 100; h2 = 230; h3 = 450; vs = 20;
  Tile(0,50+24,false,"",OurUser);
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"Person",ViewOnly,OurUser,false,UserSClass);
  EnterSkip(PlanShip);
  EditField(h2=250,v=vm,-40,"Name",Normal,Name,false,0);
  EditField(h2,vm=(v+=20),95,"Department",Normal,Department,false,DepSClass);
  CheckBox(h2+120,vm,0,"Closed",Closed);
  TileButton(1,"Terms");
  TileButton(2,"Items");
  TileButton(3,"Del. Address");
  TileButton(4,"Comments");
  Tile(1,70,false,"1",PlanShip);
  vs = 20; h1 = 110; h2 = 290; h3 = 530; h4 = 600;
  EditField(h1,v=6,82,"Date",Normal,TransDate,false,PasteCurDate);
  EditField(h1,v+=vs,82,"Planned Delivery",Normal,PlanShip,false,PasteCurDate);
  EditField(h1,v+=vs,82,"From Location",Normal,FrLocation,false,LocationSClass);
  EditField(h2,v=6,82,"Delivery Terms",Normal,ShipDeal,false,ShipDealSClass);
  EditField(h2,v+=vs,82,"Delivery Mode",Normal,ShipMode,false,DMSClass);
  EditField(h2,v+=vs,82,"To Location",Normal,Location,false,LocationSClass);
  EditField(h3,v=6,82,"Internal Order Class",Normal,IntORClass,false,IntORClassSClass);
  EditField(h3,v+=vs,82,"Language",Normal,LangCode,false,LangSClass);
  EditField(h3,v+=vs,135,"Reference",Normal,Reference,false,0);
//  EditField(h,v+=vs,280,"#Authorised# By",ViewOnly,OKPersons,false,UserSClass);// funcionality removed, no operations menu
  EnterSkip(Math2);
  Tile(2,120,true,"2",Math2);
  EditField(-144,-21,90,"TOTAL",ViewOnly,Total,true,0);
  v = 24;
  MatrixBegin(3,v,-50,-27,-,1000);
  MatOverStrike(ovst);
  Flip(0);
  MatCol(1,24,"Item",0,ArtCode,false,INSClass);
  if (HasVarieties) then begin
    MatCol(1,94,"Qty",0,Quant,true,MATVARINSClass);
  end else begin
    MatCol(1,94,"Qty",0,Quant,true,0);
  end;
  MatCol(1,144,"Treated",0,Shipd1,true,0);
  MatCol(1,194,"Deliv.",0,Shipd2,true,0);
  EnterSkip(ArtCode);
  Flip(1);
  MatCol(1,244,"Description",0,Spec,false,0);
  MatCol(1,-180,"Cost Price",0,Price,true,0);
  MatCol(1,-90,"Total Cost",0,Sum,true,0);
  Flip(2);
  MatCol(t=1,144,"Description",0,Spec,false,0);
  MatCol(t,-304,"Serial No.",0,SerialNr,false,SerialNrSClass);
  MatCol(t,-204,"Cost A/C",0,CostAcc,false,AccSClass);
  MatCol(t,-124,"Objects",0,Objects,false,ObjSClass);
  MatCol(1,-70,"Recipe",0,Recepy,false,RecSClass);
  Flip(3);
  MatCol(t=1,144,"Desc.",0,Spec,false,0);
  MatCol(1,-280,"Treated",0,Shipd1,false,0);
  MatCol(1,-210,"Deliv.",0,Shipd2,false,0);
  MatCol(t,-140,"Sent",0,Sent,true,0);
  MatCol(t,-70,"P/Ord.",0,POOrd,true,0);
  DeleteRowTest;
  EndMatrix;
  vs = 20;
  v = 18; VTab(-35,v,-16,v+vs,ToolFlip,1,"A");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,2,"B");
  v=v+vs;  VTab(-35,v,-16,v+vs,ToolFlip,3,"C");
  Tile(3,170,false,"3",ShipDeal);
  EditField(h,v=6,-20,"Delivery",Normal,ShipAddr0,false,0);
  EditField(h,v+=vs,-20,"Address",Normal,ShipAddr1,false,0);
  EditField(h,v+=vs,-20,"",Normal,ShipAddr2,false,0);
  EditField(h,v+=vs,-20,"",Normal,ShipAddr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,DelAddr3,false,0);
  EditField(h,v+=vs,-20,"",Normal,DelAddr4,false,0);
  EditField(h2=-170,v+=vs,150,"Telephone",Normal,Phone,false,0);
  EditField(h2,v+=vs,150,"Fax",Normal,Fax,false,0);
  Tile(4,120,false,"4",Math); vs = 20;
  StaticText(h-6,v=20,"Comments",true);
  TextField(h,v-5,-170,-10,Math,0);
  ButtonFrame(h3=-150,v=16,123,6,"Approval Status");
  RadioButton(h3,v,kAcceptanceStateNotRequired,0,"Not Required",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateNotStarted,0,"Not Started",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateNotRequested,0,"Not Requested",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStatePending,0,"Pending",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateApproved,0,"Approved",AcceptanceStatus);
  RadioButton(h3,v+=16,kAcceptanceStateRejected,0,"Rejected",AcceptanceStatus);  
  SpecialMenu("Create #Stock# Movement",' ',0,"StockMovFromIntORDsm");
  SpecialMenu("Create #Stock Depreciation#",' ',1,"SDFromIntORDsm");
  SpecialMenu("Create Purchase Order",' ',2,"POFromIntORDsm");
//  SpecialMenu("#Authorise#",' ',3,"AuthorizeIntORDsm");changed to below
  SpecialMenu("Send for Approval",' ',6,"IntORSendforAcceptanceIntORDsm");
  SpecialMenu("Cancel Approval Request",' ',2,"CancelApprovalRequestDsm");
  SpecialMenu("Internal Order Status",'r',5,"IntORStatIntORDsm");
  SpecialMenu("Item Search",'',1,"ItemSearchDsm");
  SpecialMenu("Table Search",'f',1,"TableSearchDsm");  //Edit----------------Dima  17.12.2014
  SpecialMenu("Reservations",' ',15,"IntORReservIntORDsm");
  EndWindow;
end;



window TableSearchIClass:1  // added ************ Dima, 16.12.2014
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
real h,v,vs;
Integer i,mwn;
  WindowBegin("Table search",TableSearchIClass,CGother,RcType);
  SetWRect(3,140,400,250);
  UseView(RcVc);
  Modality(1);
  v=30;
  h=20;
  EditField(h+30,v-10 ,150,"Search",Normal,f1,true,0);// new search field
  ColourPushButton(h+=200,v-10,h+58,v+26,"GoPreviousItem","Prev.",20);
  ColourPushButton(h+=75,v-10,h+58,v+26,"GoNextItem","Next.",2);

  EndWindow;
end;

//Edit***************************Sasha2,10:55 20.03.2015 {
window MyPrintTClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
string 255 tstr;
integer v,i,mtrw,h,vm,heiz;
integer mwn,wn; 
record FormDefVc FDr;
row FormDefVc FDrw;
string 200 formcode;
string 20 winclass,recname,printfunc; 
array Boolean toPrintF;
array LongInt intDocNr;
array string 255 repDescr;

  WindowBegin("Print",MyPrintTClass,CGother,RcType);
	UseView(RcVc);
	DynamicWindow;
	wn = curwindow;
	mwn = MotherWindow(wn);
	winclass = GetWindowClass(mwn);
	if (blank(winclass)) then begin goto L99; end;
	
	switch (winclass) begin 
	 /*case "ORDClass": 
	       FDr.repname = "OrdForm";
	       recname  = "ORVc";
	       printfunc = "PrintDoOrdForm";
	 case "StockMovDClass": 
	       FDr.repname = "StockMovForm";
	       recname  = "StockMovVc";
	       printfunc = "PrintDoStockMovForm";
	 case "SVODClass": 
	       FDr.repname = "SVOForm";
	       recname  = "SVOVc";			
	       printfunc = "PrintDoSVOForm";*/
	 case "IVDClass": 
	       FDr.repname = "InvForm";
	       recname  = "IVVc";
	       printfunc = "PrintDoIVForm";
	 case "IV1DClass": 
	       FDr.repname = "InvForm";
	       recname  = "IVVc";
	       printfunc = "PrintDoIVForm";
	 otherwise 
	       MessageBox(0,"Undefined window class");
	       goto L99;
	end; 
	
	if (ReadFirstMain(FDr,1,true)==false) then begin
		MessageBox(1624, " " & USetStr(1623));
		goto L99;
	end;
	mtrw = matrowcnt(FDr);
	heiz = 80 + 20 + 18 + mtrw*18;
	SetWRect(90,80,500,heiz);
	v=10;
	ButtonFrame(20,20,350,mtrw,"Documents forms");
	h=20;v=20;
	CheckFormsForPrint(FDr.repname,recname,mtrw,toPrintF,intDocNr,repDescr); //Edit***************************Sasha2,11:44 25.11.2015 {
	for(i=0;i<mtrw;i=i+1)begin
		if(toPrintF[i])then begin
			RadioButton(h,v,intDocNr[i],0,repDescr[i],flags[0]);
			v=v+16;
		end;
	end; //Edit***************************Sasha2,11:44 25.11.2015 }
	/*for(i=0;i<mtrw;i=i+1)begin
		matrowget(FDr,i,FDrw);
		formcode = "";
		if(Getformcode(i,FDrw.intdocnr,FDrw.FPCode,FDrw.UserGroup,FDrw.LangCode,FDrw.SerNr,-1,FDrw.PrintGroupCode,"",i+1,recname,formcode))then begin
			RadioButton(h,v,FDrw.intdocnr,0,GetTextForPrint(i,recname),flags[0]);
			v=v+16;
		end;
	end;*/
	v=v+16;
	HalPushButton(h,v,h+100,v+50,printfunc,"Print"); 
L99:;
  EndWindow;
end; //Edit***************************Sasha2,10:55 20.03.2015 }



window POLClass:2
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","*")
begin
  Integer pos;

  WindowBegin("Purchase Orders",POLClass,CGmlist,POView);
  SpawnClass(PODClass);
  SetWRect(20,80,880,298);
  Sizeable(-1,-1,0,0);
  UseView(POVc);
  FormName(PrintPOL);
  RecordList(4,17,-21,-39);
 
    RlColKey(4,4,"No.",SerNr,false,SerNr);
    RlColKey(79,79,"OK",OKFlag,false,OKFlag);
    pos = 111;
    if (HasModIN) then begin
      RlColKey(pos,pos,"GR",PUFlag,false,PUFlag);
      pos = 143;
    end;
    if (HasModPL) then begin
      RlColKey(pos,pos,"Inv.",PIFlag,false,InvFlag);
      pos = 175;
    end;
    RlColKeyTL(pos,pos,"Clsd",M4Mark,Closed,false,Closed);
    pos = pos + 32;
    RlColKey(pos,pos,"Date",TransDate,false,TransDate);
    pos = pos + 80;
    if (HasMultiLocations) then begin
      RlColKey(pos,pos,"Location",Location,false,Location);
      pos = pos + 80;
    end;
    if (IsEnterprise) then begin
      RlColKey(pos,pos,"Reference",Reference,false,Reference);
      pos = pos + 80;
    end;
    RlColKey(pos,pos,"#Supplier#",VECode,false,VECode);
    pos = pos + 60;
    RlColKey(pos,pos,"Name",Addr0,false,Name);
    RlCol(-200,-200,"Official Ser.Nr.",OfficialSerNr,false);	//Edit----------------------Dima  31.03.2015
    if (IsEnterprise) then begin
      RlCol(-120,-120,"Class",POClass,false);
      RlCol(-55,-55,"Total",Sum4,true);
    end else begin
      RlCol(-80,-80,"Total",Sum4,true);
    end;

  if (GUIType!=kGuiiPhone) then begin
    SearchField("Search");
    if (HasLimitedAccess) then begin 
      BrowseSubsetButton(-40,-15);
    end;
    if (GuiType==kGuiMetro) then begin
      RowMenuBegin("");
      RowMenuItem(0,"OK",'G','G',4312,"OKPOLsm");
      RowMenuItem(1,"Close",' ',' ',4300,"ClosePOLsm");
      if (HasModIN) then begin
        RowMenuItem(2,"Create Goods Receipt",' ',' ',4300,"PUFromPOLsm");
      end;
      if (IsEnterprise) then begin
        RowMenuItem(3,"Create Purchase Orders",' ',' ',4300,"POCreatePOLsm");
        RowMenuItem(4,"Purchase Order Status",'r','r',4300,"POStatusORLsm");
      end;
      EndRowMenu;
    end else begin
      SpecialMenu("OK",'G',0,"OKPOLsm");
      SpecialMenu("Close",' ',1,"ClosePOLsm");
      if (HasModIN) then begin
        SpecialMenu("Create Goods Receipt",' ',2,"PUFromPOLsm");  
      end;
      if (IsEnterprise) then begin
        SpecialMenu("Create Purchase Orders",' ',3,"POCreatePOLsm");
        SpecialMenu("Purchase Order Status",'r',4,"POStatusORLsm");
      end;
    end;
  end;
  EndWindow;
end;



window PULClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real pos;

  WindowBegin("Goods Receipts",PULClass,CGmlist,PUView);
  SpawnClass(PUDClass);
  SetWRect(20,80,810,298);
  Sizeable(-1,-1,0,0);
  UseView(PUVc);
  FormName(PrintPUL);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"No.",SerNr,false,SerNr);
  RlColKey(79,79,"OK",OKFlag,false,OKFlag);
  RlColKey(111,111,"Date",TransDate,false,TransDate);
  pos = 191;
  if (HasMultiLocations) then begin
    RlColKey(pos,pos,"Location",Location,false,Location);
    pos = 251;
  end;
  if (HasModPO) then begin
    RlColKey(pos,pos,"PO No.",PONr,false,PONr);
    pos = 331;
  end;
  RlColKey(pos,pos,"#Supplier#",VECode,false,VECode);
  RlColKey(391,391,"Name",VEName,false,VEName);
  RlCol(530,530,"Official Ser.Nr.",OfficialSerNr,false);	//Edit----------------------Dima  31.03.2015
  RlColKey(620,620,"Comment",Comment,false,Comment);
  if (IsEnterprise) then begin
    RlCol(-1,-1,"",Invalid,true);
  end;
  SearchField("Search");
  if (GuiType==kGuiMetro) then begin
    RowMenuBegin("");
    RowMenuItem(0,"OK",'G','G',4312,"PUOKLsm");
    EndRowMenu;
  end else begin
    SpecialMenu("OK",'G',0,"PUOKLsm");
  end;
  EndWindow;
end;


window SHLClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  WindowBegin("Deliveries",SHLClass,CGmlist,SHView);
  SpawnClass(SHDClass);
  SetWRect(20,80,880,298);
  Sizeable(-1,-1,0,0);
  UseView(SHVc);
  FormName(PrintSHL);
  RecordList(4,17,-21,-39);
  RlColKey(4,4,"No.",SerNr,false,SerNr);
  RlColKey(79,79,"OK",OKFlag,false,OKFlag);
  RlColKey(111,111,"Date",ShipDate,false,ShipDate);
  if (HasMultiLocations) then begin
    RlCol(191,191,"Location",Location,false);
    RlColKey(251,251,"Order No.",OrderNr,false,OrderKey);
  end else begin
    RlColKey(191,191,"Order No.",OrderNr,false,OrderKey);
  end;
  RlColKey(331,331,"Customer",CustCode,false,CustCode);
  RlColKey(391,391,"Name",Addr0,false,CustName);
  if (IsEnterprise) then begin
    RlColKey(-260,-260,"Transport No.",TransportNumber,false,TransportNumber);
    RlColKey(-160,-160,"Del. Mode",ShipMode,false,ShipMode);
  end else begin
    RlColKey(476,476,"Comment",Comment,false,Comment);
  end;
  RlCol(-80,-80,"Official Ser.Nr.",OfficialSerNr,false);	//Edit----------------------Dima  31.03.2015
  SearchField("Search");
  if (GuiType==kGuiMetro) then begin
    RowMenuBegin("");
    RowMenuItem(0,"OK",'G','G',4312,"SHOKLsm");
    EndRowMenu;
  end else begin
    SpecialMenu("OK",'G',0,"SHOKLsm");
  end;
  EndWindow;
end;





window RetPUDClass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,h1,h2,h3,h4,v,vm,vs;
  Integer tilenr,f,flipnr;
  
  WindowBegin("Returned Goods to #Supplier#",RetPUDClass,CGview,-);
  SetWRect(20,80,750,460);
  Sizeable(-1,-1,0,0);
  UseView(RetPUVc);
  FormName(RetPurchaseForm);
  Tile(0,74,false,"",SerNr);
  v = 6; vs = 20;
  EditField(75,vm=(v=6),95,"No.",Normal,SerNr,false,TSerSClass);
  EditField(75,v+=20,95,"#Supplier#",ViewOnly,VECode,false,0);
  EditField(h=255,v=vm,-40,"Name",ViewOnly,VEName,false,0);
  EditField(h,vm=(v+=20),135,"Official No.",Normal,OfficialSerNr,false,LegalInvNrSClass);
  CheckBox(h=500,v,0,"Not for reports",NotForReport);		//Edit----------------------Dima  14.04.2015
  v=v+20;
  CheckBox(h4=-100,v=vm,0,"OK",OKFlag);
  tilenr = 1;
  TileButton(tilenr,"Terms"); tilenr = tilenr + 1;
  TileButton(tilenr,"Items"); tilenr = tilenr + 1;
  if (HasMultiCurrency) then begin
    TileButton(tilenr,"Currency"); tilenr = tilenr + 1;
  end;
  TileButton(tilenr,"Address"); tilenr = tilenr + 1;
  TileButton(tilenr,"Freight"); tilenr = tilenr + 1;
  TileButton(tilenr,"Comment"); tilenr = tilenr + 1;
//  TileButton(tilenr,"Extra Costs");
  tilenr = 1;
  Tile(tilenr,70,false,tilenr,TransDate); tilenr = tilenr + 1;
  vs = 20; h1 = 110; h2 = 300; h3 = 530; h4 = -100;
  EditField(h1,vm=(v=6),82,"Date",Normal,TransDate,false,PasteCurDate);
  EditField(h1,v+=vs,82,"Location",Normal,Location,false,LocationSClass);
  if (IsEnterprise) then begin
    EditField(h1,v+=vs,82,"Reason",Normal,Reason,false,StandProblemsSClass);  
  end;
  EditField(h2,v=vm,125, "Purch. Order No.",ViewOnly,PONr,false,0);
  EditField(h2,v+=vs,125,"Route",Normal,Sorting,false,DelRouteSClass);
  ButtonFrame(h3=h3-70,v=16,140,2,"Reduce Quantities");
  RadioButton(h3,v,0,0,"Received Only",Type);
  RadioButton(h3,v+=16,1,0,"Ordered and Received",Type);
  CheckBox(h4,v=vm,0,"Price  Incl. #VAT#",InclVAT);
  EnterSkip(Math);
  Tile(tilenr,79,true,tilenr,Math); tilenr = tilenr + 1;
  v = 24;
  MatrixBegin(4,v,-50,-22,-,199);
  Flip(0);
  if (HasJewelleryInterface) then begin
    MatCol(1,24,"Serial No.",0,SerialNr,false,SerialNrSClass);
    EnterSkip(Quant);
    MatCol(1,130,"Item",0,ArtCode,false,INSClass);
  end else begin
    MatCol(1,24,"Item",0,ArtCode,false,INSClass);
    MatCol(1,120,"Qty",0,Quant,true,0);
  end;
  flipnr = 1;
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,174,"Description",0,Spec,false,0);
  if (HasJewelleryInterface) then begin
    MatCol(1,-280,"Location",0,Location,false,0);
  end;
  MatCol(1,-220,"#Supplier# Item No.",0,VEItemCode,false,0);
  MatCol(1,-80,"Coeff.",0,Coefficient,true,0);
  if (HasModNL or HasObjects) then begin
    Flip(flipnr); flipnr = flipnr + 1;
    MatCol(1,174,"Description",0,Spec,false,0);
    if (HasModNL) then begin
      MatCol(1,-190,"Cost A/C",0,CostAcc,false,0);
      MatCol(1,-130,"Purch. A/C",0,CredAcc,false,0);
    end;
    if (HasObjects) then begin
      MatCol(1,-60,"Objects",0,Objects,false,ObjSClass);
    end;
  end;
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,174,"Description",0,Spec,false,0);
  MatCol(1,-360,"Location",0,Location,false,0);
//  MatColTL(1,-310,"Location",0,M4UStr,Normal,0,Location,false,0);
  MatColTL(1,-300,"GR CostPrice",0,-1,ViewOnly,-1,PUCostPrice,false,0);
  MatColTL(1,-220,"Price Var.",0,-1,ViewOnly,-1,VarianceAmount,false,0);
  MatCol(1,-160,"FIFO",0,FIFO,true,0);
  MatCol(1,-90,"Row FIFO",0,FIFORowVal,true,0);
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,174,"Description",0,Spec,false,0);
  if (IsEnterprise) then begin
    MatCol(1,-300,"Position",0,PosCode,false,PosSClass);
  end;
  if (HasSerialNumbers) then begin
    MatCol(1,-235,"Serial No.",0,SerialNr,false,SerialNrSClass);
  end;
  MatCol(1,-135,"Width",0,UnitXval,true,0);
  MatCol(1,-90,"Height",0,UnitYval,true,0);
  MatCol(1,-45,"Depth",0,UnitZval,true,0);
  Flip(flipnr); flipnr = flipnr + 1;
  MatCol(1,164,"Description",0,Spec,false,0);
  MatCol(1,-260,"GR No.",0,PUNr,false,PUSClass);
  MatCol(1,-190,"GR Row",0,PURow,false,0);
  MatCol(1,-130,"PO No.",0,PONr,false,POSClass);
  MatCol(1,-60,"PO Row",0,OrdRow,false,0);
 
  DeleteRowTest;
  InsertRowTest;
  EndMatrix;
  vs = 20;
  v = 18;/* 28 */ 
  if (flipnr>2) then begin
    for (f=1;f<flipnr;f=f+1) begin
      VTab(-35,v,-16,v+vs,ToolFlip,f,chr(asc("A") + f - 1));
      v = v + vs;
    end;
  end;
  

  EditField(133,-20,60,"Total Qty",ViewOnly,SumQuant,true,0);
//  EditField(-450,-20,70,"Freight",Normal,ShipCost,true,0);
//  EditField(-300,-20,70,"Customs",Normal,CustomsCost,true,0);
  EditField(-130,-20,70,"TOTAL",ViewOnly,SumCostPrice,true,0);
  if (HasMultiCurrency or HasBase2) then begin
    Tile(tilenr,70,false,tilenr,FrRate); tilenr = tilenr + 1;
    h1 = 110; vs = 20;
    if (HasBase2) then begin
      h1 = h1 + 20;
    end;
    EditField(h1,v=6,50,"Currency",Normal,CurncyCode,false,CurncyCodeSClass);
    if (HasMultiCurrency) then begin
      EditField(h2,v,50,"Rate",Normal,FrRate,true,0);
      EditField(h2+65,v,50,":",Normal,ToRateB1,true,0);
      if (HasBase2) then begin
        StaticText(h2+125,v+14,"Base Currency 1",false);
        EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
        EditField(h2+65,v,50,":",Normal,ToRateB2,true,0);
        StaticText(h2+125,v+14,"Base Currency 2",false);
        EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
      end else begin
        StaticText(h2+125,v+14,"Base Currency",false);
      end;
    end else begin
      EditField(h1,v+=vs,50,"Base Currency 1",Normal,BaseRate1,true,0);
      EditField(h1,v+=vs,50,"Base Currency 2",Normal,BaseRate2,true,0);
    end;
  end;
  Tile(tilenr,130,false,tilenr,DelAddr0); tilenr = tilenr + 1;
  EditField(h1,v=6,80,"Address Code",Normal,DelAddrCode,false,DelAddr3SClass);
  EditField(h1,v+=vs,-20,"Delivery",Normal,DelAddr0,false,0);
  EditField(h1,v+=vs,-20,"Address",Normal,DelAddr1,false,0);
  EditField(h1,v+=vs,-20,"",Normal,DelAddr2,false,0);
  EditField(h1,v+=vs,-20,"",Normal,DelAddr3,false,0);
  EditField(h1,v+=vs,-20,"",Normal,DelAddr4,false,0);
  Tile(tilenr,130,false,tilenr,FreightCode); tilenr = tilenr + 1;
  EditField(h1,v=6,80,"Freight Company",Normal,FreightCode,false,FreightCompanySClass);
  EditField(h1,v+=vs,-20,"Name",Normal,FreightCompany,false,0);
  EditField(h1,v+=vs,-20,"#Reg. No.#",Normal,FreightCompanyRegNr,false,0);
  EditField(h1,v+=vs,-20,"Truck Information",Normal,TruckInfo,false,0);
  EditField(h1,v+=vs,-20,"Driver",Normal,Driver,false,0);
  EditField(h1,v+=vs,-20,"CMR",Normal,CMRText,false,0); // International transporting number
  Tile(tilenr,30,false,tilenr,Comment); tilenr = tilenr + 1;
  EditField(h1,v=6,-20,"Comment",Normal,Comment,false,0);
 
  SpecialMenu("Create #Credit Note#",'F',0,"CredVIFromRetPUDsm");
  if (HasModNL) then begin
    SpecialMenu("Open #NL# Transaction",'t',1,"OpenTRFromRetPU");
  end;
  if (IsEnterprise) then begin
    SpecialMenu("Quality Control",'u',10,"QualConFromRetPUDsm");
  end;
  EndWindow;
end;

window NPTSNewCUFieldsTCLass:1
  wtag("language","ENG"), wtag("product","*"), wtag("productcode","*"), wtag("device","computer")
begin
  real h,v;
  WindowBegin("Fields to create a new client",NPTSNewCUFieldsTCLass,CGHbl,HBlRecType);
  SetBlid(NPTSNewCUFieldsBlock);
  SetWRect(20,80,420,400);
  h = 8; v = 20;
  MatrixBegin(h,v,-25,-1,-,99);
//  MatColTL(1,24,"Field Name",0,M4AppCode,Normal,-1,FieldName,false,SetSClass);

  MatCol(1,24,"Fields name",0,FieldName,false,0);
  MatCol(1,104,"Type",0,EditState,false,SetSClass);
  MatCol(1,200,"Comment",0,FieldComment,false,0);
  EndMatrix;
  EndWindow;
end;
