//server-only
external procedure FindNLAccBal(string,string,string,Integer,Date,Date,Integer,Integer,Boolean,string,Integer,string,string,var val);
external procedure YcToStr(Integer,var string);
external function Boolean CorspTRTest(record TRVc,record AccVc,Integer,var val,var val);
external procedure ReadCorspTRRowSums(record TRVc,record AccVc,record AccVc,var val,var val,string);
external procedure GetObjs(string,string,var string);
external procedure GetFullCurncyRate(var string,Date,var val,var val,var val,var val,var val);
external function string 200 ValToMyString(val,integer);
external function boolean CompanyIsJWLikeCompany(Integer);
external function Integer InString2(string,string);
external function val AbsoluteVal(val);
external procedure LogProcTime(string,longint);

SetLangMode(LangRussian,"RUS",0);


function boolean CompanyIsJWLikeCompany1(integer compnr)
begin
	BOOLEAN res;
	
	res = CompanyIsJWLikeCompany(compnr);
	
	//if(currentuser=="SA1")then begin
		res = true;
	//end;
	
	CompanyIsJWLikeCompany1 = res;
	
return;
end;

function integer CurncyCount()
begin

	CurncyCount = 5;
return;
end;

function string 10 CurncyStr(integer i)
begin
	array string 10 crncy;
	
	crncy[0] = "AZN";
	crncy[1] = "USD";
	crncy[2] = "EUR";
	crncy[3] = "GBP";
	crncy[4] = "CHF";

	CurncyStr = crncy[i];
return;
end;


procedure OutMyString(integer p1,integer p2,val str,boolean alight)
begin
	if(str!=0)then begin
		outstring(p1,p2,str,alight);
	end else begin
		outstring(p1,p2,"",alight);
	end;
  return;
end;


procedure PrintHeaderStartPeriod50(var vector val v, record RcVc RepSpec)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	f = false;
	if ((v["BeginBalance50USD"]!=0) or (v["BeginBalance50EUR"]!=0) or (v["BeginBalance50GBP"]!=0) or (v["BeginBalance50CHF"]!=0) or (v["BeginBalance50AZN"]!=0)) then begin
		
		For(i=0;i<CurncyCount;i=i+1) begin
			indname = "BeginBalance50" & CurncyStr(i);
	  	if (v[indname]!=0) then begin
				StartFormat(15);
					if (!f) then begin
						OutString(0,0,"",false);
						OutString(15,0,"Наличная касса (50 счет):",false);
						f = true;
					end else begin
						OutString(0,0,"",false);
						OutString(15,0,"",false);
					end;
					OutString(60,0,v[indname],false);
					OutString(90,0,CurncyStr(i),false);
				EndFormat;
			end;
		end; 
		if (f) then begin
			Gray_Divider(25,120);
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(25,0,"Сумма в осн. вал.",false);
				OutString(60,0,v["BeginBalance50"],false);
				OutString(90,0,"AZN",false);
				if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
					OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
					OutMyString(160,0,v["BeginBalance50"]/RepSpec.vals0,false);
				end;
			EndFormat;
			Gray_Divider(25,120);
			StartFormat(15);
			EndFormat;
		end;
	end;

return;
end;

procedure PrintHeaderStartPeriod5152(var vector val v, record RcVc RepSpec)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	f = false;
	
	For(i=0;i<CurncyCount;i=i+1) begin
		if (v["BeginBalance52" & CurncyStr(i)]!=0 or v["BeginBalance51" & CurncyStr(i)]!=0) then begin
			StartFormat(15);
				if (!f) then begin
					OutString(0,0,"",false);
					OutString(15,0,"Банк локальный (51+52):",false);
					f = true;
				end else begin
					OutString(0,0,"",false);
					OutString(15,0,"",false);
				end;
				OutString(60,0,v["BeginBalance52" & CurncyStr(i)] + v["BeginBalance51" & CurncyStr(i)],false);
				OutString(90,0,CurncyStr(i),false);
			EndFormat;
		end;
	end; 

	if (f) then begin
		Gray_Divider(25,120);
		StartFormat(15);
			OutString(0,0,"",false);
			OutString(25,0,"Сумма в осн. вал.",false);
			OutString(60,0,v["BeginBalance52"] + v["BeginBalance51"],false);
			OutString(90,0,"AZN",false);
			if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
				OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
				OutMyString(160,0,(v["BeginBalance52"] + v["BeginBalance51"])/RepSpec.vals0,false);
			end;
		EndFormat;
		Gray_Divider(25,120);
		StartFormat(15);
		EndFormat;
	end;

return;
end;


procedure PrintHeaderStartPeriod52(var vector val v, record RcVc RepSpec)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
	  if(v["Balance52" & CurncyStr(i)]!=0)then begin
	  	f=true;
	  end;
	end; 
	if (f) then begin
		f = false;
		For(i=0;i<CurncyCount;i=i+1) begin
			if (v["Balance52" & CurncyStr(i)]!=0) then begin
				StartFormat(15);
					if (!f) then begin
						OutString(0,0,"",false);
						OutString(15,0,"Остаток по расчетному счету в валюте:",false);
						f = true;
					end else begin
						OutString(0,0,"",false);
						OutString(15,0,"",false);
					end;
					OutString(60,0,v["Balance52" & CurncyStr(i)],false);
					OutString(90,0,CurncyStr(i),false);
				EndFormat;
			end;
		end; 

		if (f) then begin
			tempBal = 0;
			FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
      v["BeginBalance52"] = tempBal;
      tempBal = 0;
			FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
      v["BeginBalance52"] = v["BeginBalance52"] + tempBal;
					Gray_Divider(25,120);
					StartFormat(15);
						OutString(0,0,"",false);
						OutString(25,0,"Сумма в осн. вал.",false);
						OutString(60,0,v["BeginBalance52"],false);
						OutString(90,0,"AZN",false);
						if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
							OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
							OutMyString(160,0,v["BeginBalance52"]/RepSpec.vals0,false);
						end;
					EndFormat;
					Gray_Divider(25,120);
					StartFormat(15);
					EndFormat;
					v["BeginBalance50n51n53"] = v["BeginBalance50n51n53"] + v["BeginBalance52"];
				end;
			end;

return;
end;

procedure PrintHeaderStartPeriodID(var vector val v, record RcVc RepSpec)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
	  if(v["BeginBalance59/2" & CurncyStr(i)]!=0)then begin
	  	f=true;
	  end;
	end; 
	if (f) then begin
		f = false;
		For(i=0;i<CurncyCount;i=i+1) begin
			if (v["BeginBalance59/2" & CurncyStr(i)]!=0) then begin
				StartFormat(15);
					if (!f) then begin
						OutString(0,0,"",false);
						OutString(15,0,"ID счет (59/2):",false);
						f = true;
					end else begin
						OutString(0,0,"",false);
						OutString(15,0,"",false);
					end;
					OutString(60,0,v["BeginBalance59/2" & CurncyStr(i)],false);
					OutString(90,0,CurncyStr(i),false);
				EndFormat;
			end;			
		end;
		if (f) then begin
			tempBal = 0;
			FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
			v["BeginBalance59/2"] = tempBal;
			Gray_Divider(25,120);
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(25,0,"Сумма в осн. вал.",false);
				OutString(60,0,v["BeginBalance59/2"],false);
				OutString(90,0,"AZN",false);
				if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
					OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
					OutMyString(160,0,v["BeginBalance59/2"]/RepSpec.vals0,false);
				end;
			EndFormat;
			Gray_Divider(25,120);
			StartFormat(15);
			EndFormat;
			v["BeginBalance50n51n53"] = v["BeginBalance50n51n53"] + v["BeginBalance59/2"];
		end;
	end;

return;
end;


procedure PrintHeaderStartPeriodInOffice(var vector val v, record RcVc RepSpec)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
	  if(v["BeginBalance59/2" & CurncyStr(i)]!=0)then begin
	  	f=true;
	  end;
	end; 
	
	f = true; 
	For(i=0;i<CurncyCount;i=i+1) begin
	  if(v["BeginBalance53" & CurncyStr(i)]!=0)then begin
	  	StartFormat(15);
				OutString(0,0,"",false);
				if(f)then begin
					OutString(15,0,"Деньги в офисе (53):",false);
				end else begin
					OutString(15,0,"",false);
				end;
				OutString(60,0,v["BeginBalance53" & CurncyStr(i)],false);
				OutString(90,0,CurncyStr(i),false);
			EndFormat;
			f=false;
	  end;
	end; 

	StartFormat(15);
		OutString(0,0,"",false);
		OutString(25,0,"Сумма в осн. вал.",false);
		OutString(60,0,v["BeginBalance53"],false);
		OutString(90,0,"AZN",false);
		
		if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
			OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
			OutMyString(160,0,v["BeginBalance53"]/RepSpec.vals0,false);
		end;
	EndFormat;
	StartFormat(15);
	EndFormat;

return;
end;

procedure PrintHeaderStartPeriodByCurSt(var vector val v, record RcVc RepSpec)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
	  if(v["BeginBalance59/2" & CurncyStr(i)]!=0)then begin
	  	f=true;
	  end;
	end;
	
	if ((v["BeginBalance50"]+v["BeginBalance51"]+v["BeginBalance52"]+v["BeginBalance53"]+v["BeginBalance59/2"])!=0) then begin
			StartFormat(15);
				OutString(0,0,"Общий остаток на " & RepSpec.sStartDate & " по валютам:",false);
				OutString(15,0,"",false);
				OutString(60,0,"",false);
				OutString(90,0,"",false);
			EndFormat;
			
		For(i=0;i<CurncyCount;i=i+1) begin
			if((v["BeginBalance50" & CurncyStr(i)] + v["BeginBalance51" & CurncyStr(i)] + v["BeginBalance52" & CurncyStr(i)] + v["BeginBalance53" & CurncyStr(i)] + v["BeginBalance59/2" & CurncyStr(i)])!=0)then begin
				StartFormat(15);
					OutString(0,0,"",false);
					OutString(15,0,"",false);
					OutString(60,0,v["BeginBalance50" & CurncyStr(i)] + v["BeginBalance51" & CurncyStr(i)] + v["BeginBalance52" & CurncyStr(i)] + v["BeginBalance53" & CurncyStr(i)] + v["BeginBalance59/2" & CurncyStr(i)],false);
					OutString(90,0,CurncyStr(i),false);
				EndFormat;
			end;
		end;	
		if((v["BeginBalance50"]+v["BeginBalance51"]+v["BeginBalance52"]+v["BeginBalance53"]+v["BeginBalance59/2"])!=0)then begin
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(15,0,"Сумма в осн. валюте",false);
				OutString(60,0,v["BeginBalance50"]+v["BeginBalance51"]+v["BeginBalance52"]+v["BeginBalance53"]+v["BeginBalance59/2"],false);
				OutString(90,0,"AZN",false);
			EndFormat;
		end;
		StartFormat(15);
		EndFormat;
	end;

return;
end;

procedure PrintHeaderStartPeriodMainAcc(var vector val v, record RcVc RepSpec)
begin
	boolean f;
	val tempbal;
	
	StartFormat(15);
		OutString(0,0,"",false);
		OutString(15,0,"Остаток общего счета",false);
		OutString(60,0,v["BeginBalance50n53USD"]+v["BeginBalance59/2USD"],false);
		OutString(90,0,"USD",false);
		if (currentcompany==1) then begin
			OutString(110,0,"ID счет",false);
		end;
	EndFormat;
	StartFormat(15);
		OutString(0,0,"",false);
		OutString(15,0,"",false);
		OutString(60,0,v["BeginBalance50n53EUR"]+v["BeginBalance59/2EUR"],false);
		OutString(90,0,"EUR",false);
		if (currentcompany==1) then begin
			OutString(110,0,"ID счет",false);
		end;
	EndFormat;
	StartFormat(15);
		OutString(0,0,"",false);
		OutString(15,0,"",false);
		OutString(60,0,v["BeginBalance50n53AZN"],false);
		OutString(90,0,"AZN",false);
	EndFormat;
	StartFormat(15);
		OutString(0,0,"",false);
		OutString(15,0,"",false);
		OutString(60,0,v["BeginBalance51"],false);
		OutString(90,0,"AZN банк",false);
	EndFormat;
	//Edit-------------------Vitalii 18:02 17.07.2017
	if (v["Balance52USD"]!=0) then begin
		StartFormat(15);
			OutString(0,0,"",false);
			OutString(15,0,"",false);
			OutString(60,0,v["Balance52USD"],false);
			OutString(90,0,"USD банк",false);
		EndFormat;
	end;
	if (v["Balance52GBP"]!=0) then begin
		StartFormat(15);
			OutString(0,0,"",false);
			OutString(15,0,"",false);
			OutString(60,0,v["Balance52GBP"],false);
			OutString(90,0,"GBP банк",false);
		EndFormat;
	end;
	if (v["Balance52CHF"]!=0) then begin
		StartFormat(15);
			OutString(0,0,"",false);
			OutString(15,0,"",false);
			OutString(60,0,v["Balance52CHF"],false);
			OutString(90,0,"CHF банк",false);
		EndFormat;
	end;
	if (v["Balance52EUR"]!=0) then begin
		StartFormat(15);
			OutString(0,0,"",false);
			OutString(15,0,"",false);
			OutString(60,0,v["Balance52EUR"],false);
			OutString(90,0,"EUR банк",false);
		EndFormat;
	end;
	if (v["Balance52AZN"]!=0) then begin
		StartFormat(15);
			OutString(0,0,"",false);
			OutString(15,0,"",false);
			OutString(60,0,v["Balance52AZN"],false);
			OutString(90,0,"AZN банк",false);
		EndFormat;
	end;
	
	Gray_Divider(25,120);
	StartFormat(15);
		OutString(0,0,"",false);
		OutString(25,0,"Сумма в осн. вал.",false);
		OutString(60,0,v["BeginBalance50n51n53"],false);
		OutString(90,0,"AZN",false);
		if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
			OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
			OutMyString(160,0,v["BeginBalance50n51n53"]/RepSpec.vals0,false);
		end;
	EndFormat;

return;
end;


procedure PrintFooterEndPeriodByCurncy(var vector val v, record RcVc RepSpec,boolean cretivef,array integer tab)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	StartFormat(15);
	EndFormat;
	StartFormat(15);
		OutString(tab[10],0,"",false);
		OutString(tab[20],0,"К сдаче по валютам",false);
	EndFormat;
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
		if(v["SaldoEndPeriod50" & CurncyStr(i)]!=0)then begin
			StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[20],0,"",false);
				OutString(tab[40],0,v["SaldoEndPeriod50" & CurncyStr(i)],false);
				OutString(tab[50],0,CurncyStr(i),false);
			EndFormat;
		end;
	end;
	/*if (!cretivef) or (v["SaldoEndPeriod51"] != 0) then begin
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"",false);
			OutString(tab[40],0,v["SaldoEndPeriod51"],false);
			OutString(tab[50],0,"AZN банк",false);
		EndFormat;
	end;*/

return;
end;


procedure PrintFooterEndPeriodKassa50(var vector val v, record RcVc RepSpec,boolean cretivef,array integer tab)
begin
	boolean f;
	val tempbal;
	integer i;
	string 50 indname;
	
	StartFormat(15);
	EndFormat;
	
	For(i=0;i<CurncyCount;i=i+1) begin
		if(v["SaldoEndPeriod50" & CurncyStr(i)]!=0)then begin
			StartFormat(15);
				OutString(tab[10],0,"",false);
				if(f)then begin
					OutString(tab[20],0,"",false);
				end else begin
					OutString(tab[20],0,"Наличная касса (50)",false);
					f = true;
				end;
				OutString(tab[40],0,v["SaldoEndPeriod50" & CurncyStr(i)],false);
				OutString(tab[50],0,CurncyStr(i),false);
			EndFormat;
		end;
	end;
	
	Gray_Divider(25,120);
	StartFormat(15);
		OutString(0,0,"",false);
		OutString(tab[20],0,"Сумма в осн. вал.",false);
		OutString(tab[40],0,v["SaldoEndPeriod50"],false);
		OutString(tab[50],0,"AZN",false);
		if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
			OutString(tab[60],0,"В USD по курсу: " & RepSpec.vals0,false);
			OutMyString(tab[70],0,v["SaldoEndPeriod50"]/RepSpec.vals0,false);
		end;
	EndFormat;
	
	StartFormat(15);
		OutString(tab[10],0,"",false);
		OutString(tab[20],0,"Курсовая",false);
		OutString(tab[40],0,v["kursovaya50"],false);
		OutString(tab[50],0,"AZN",false);
		if(RepSpec.vals0!=0)then begin
			OutMyString(tab[60],0,(v["kursovaya50"])/RepSpec.vals0,false);
		end;
	EndFormat;
	startformat(15);
	endformat;

return;
end;


procedure PrintFooterEndPeriodBank5152(var vector val v, record RcVc RepSpec,boolean cretivef,array integer tab)
begin
	boolean f;
	val tempbal;
	integer i;
	
	StartFormat(15);
	EndFormat;

	For(i=0;i<CurncyCount;i=i+1) begin
		if(v["SaldoEndPeriod51" & CurncyStr(i)]!=0 or v["SaldoEndPeriod52" & CurncyStr(i)]!=0)then begin
			StartFormat(15);
				OutString(tab[10],0,"",false);
				if(f)then begin
					OutString(tab[20],0,"",false);
				end else begin
					OutString(tab[20],0,"Банк локальный (51+52)",false);
					f = true;
				end;
				OutString(tab[40],0,v["SaldoEndPeriod51" & CurncyStr(i)]+v["SaldoEndPeriod52" & CurncyStr(i)],false);
				OutString(tab[50],0,CurncyStr(i),false);
			EndFormat;
		end;
	end;
		
	Gray_Divider(25,120);
	StartFormat(15);
		OutString(0,0,"",false);
		OutString(tab[20],0,"Сумма в осн. вал.",false);
		OutString(tab[40],0,v["SaldoEndPeriod51"]+v["SaldoEndPeriod52"],false);
		OutString(tab[50],0,"AZN",false);
		if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
			OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
			OutMyString(tab[60],0,(v["SaldoEndPeriod51"]+v["SaldoEndPeriod52"])/RepSpec.vals0,false);
		end;
	EndFormat;
	
	StartFormat(15);
		OutString(tab[10],0,"",false);
		OutString(tab[20],0,"Курсовая",false);
		OutString(tab[40],0,v["kursovaya51"]+v["kursovaya52"],false);
		OutString(tab[50],0,"AZN",false);
		if(RepSpec.vals0!=0)then begin
			OutMyString(tab[60],0,(v["kursovaya51"]+v["kursovaya52"])/RepSpec.vals0,false);
		end;
	EndFormat;
	startformat(15);
	endformat;

return;
end;

procedure PrintFooterEndPeriodMoneyInOffice(var vector val v, record RcVc RepSpec,boolean cretivef,array integer tab)
begin
	boolean f;
	val tempbal;
	integer i;
		
	For(i=0;i<CurncyCount;i=i+1) begin
		if(v["SaldoEndPeriod53" & CurncyStr(i)]!=0)then begin
			StartFormat(15);
				OutString(tab[10],0,"",false);
				if(f)then begin
					OutString(tab[20],0,"",false);
				end else begin
					OutString(tab[20],0,"Деньги в офисе (53):",false);
					f = true;
				end;
				OutString(tab[40],0,v["SaldoEndPeriod53" & CurncyStr(i)],false);
				OutString(tab[50],0,CurncyStr(i),false);
			EndFormat;
		end;
	end;
	Gray_Divider(tab[30],90);
	StartFormat(15);
		OutString(tab[10],0,"",false);
		OutString(tab[30],0,"Сумма в осн. вал.",false);
		OutString(tab[40],0,v["SaldoEndPeriod53"],false);
		OutString(tab[50],0,"AZN",false);
		if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
			OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
			OutMyString(160,0,(v["SaldoEndPeriod53"])/RepSpec.vals0,false);
		end;
	EndFormat;
	Gray_Divider(tab[30],90);
	StartFormat(15);
		OutString(tab[10],0,"",false);
		OutString(tab[30],0,"Курсовая",false);
		OutString(tab[40],0,v["kursovaya53"],false);
		OutString(tab[50],0,"AZN",false);
		if(RepSpec.vals0!=0)then begin
			OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
			OutMyString(160,0,(v["kursovaya53"])/RepSpec.vals0,false);
		end;
	EndFormat;
	Gray_Divider(tab[30],90);
	StartFormat(15);
	EndFormat;

return;
end;


procedure PrintFooterEndPeriodMainCurByCurncy(var vector val v, record RcVc RepSpec,boolean cretivef,array integer tab)
begin
	boolean f;
	val tempbal;
	integer i;
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
		if(v["Balance52" & CurncyStr(i)]!=0)then begin
			f = true;
		end;
	end;
	
	if (f) then begin
		f = false;
		
		For(i=0;i<CurncyCount;i=i+1) begin
			StartFormat(15);
				OutString(tab[10],0,"",false);
				if(f)then begin
					OutString(tab[20],0,"",false);
				end else begin
					OutString(tab[20],0,"Остаток по расчетному счету в валюте:",false);
					f = true;
				end;
				OutString(tab[40],0,v["Balance52" & CurncyStr(i)],false);
				OutString(tab[50],0,CurncyStr(i),false);
			EndFormat;
		end;
		
		
		if (f) then begin
			Gray_Divider(tab[30],90);
			StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[30],0,"Сумма в осн. вал.",false);
				OutString(tab[40],0,v["SaldoEndPeriod52"],false);
				OutString(tab[50],0,"AZN",false);
				if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
					OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
					OutMyString(160,0,v["SaldoEndPeriod52"]/RepSpec.vals0,false);
				end;
			EndFormat;
			Gray_Divider(tab[30],90);
			StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[30],0,"Курсовая",false);
				OutString(tab[40],0,v["kursovaya52"],false);
				OutString(tab[50],0,"AZN",false);
				if(RepSpec.vals0!=0)then begin
					OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
					OutMyString(160,0,(v["kursovaya52"])/RepSpec.vals0,false);
				end;
			EndFormat;
			Gray_Divider(tab[30],90);
			StartFormat(15);
			EndFormat;
		end;
	end;

return;
end;


procedure PrintFooterEndPeriodEndOnIDAcc(var vector val v, record RcVc RepSpec,boolean cretivef,array integer tab)
begin
	boolean f;
	val tempbal;
	integer i;
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
		if(v["Balance59/2" & CurncyStr(i)]!=0 or v["kursovaya59/2"]!=0)then begin
			f = true;
		end;
	end;
	
	
	if (f) then begin
		f = false;
		For(i=0;i<CurncyCount;i=i+1) begin
			if (v["Balance59/2" & CurncyStr(i)]!=0) then begin
				StartFormat(15);
					OutString(tab[10],0,"",false);
					if(f)then begin
						OutString(tab[20],0,"",false);
					end else begin
						OutString(tab[20],0,"ID счет (59/2):",false);
						f = true;
					end;
					OutString(tab[40],0,v["Balance59/2" & CurncyStr(i)],false);
					OutString(tab[50],0,CurncyStr(i),false);
				EndFormat;
			end;
		end;
		
	if(v["kursovaya59/2"]!=0 and !f)then begin
		f = true;
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"ID счет (59/2):",false);
			OutString(tab[40],0,"",false);
			OutString(tab[50],0,"",false);
		EndFormat;
	end;
		
		if (f) then begin
			Gray_Divider(tab[30],90);
			StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[30],0,"Сумма в осн. вал.",false);
				OutString(tab[40],0,v["SaldoEndPeriod59/2"],false);
				OutString(tab[50],0,"AZN",false);
				if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
					OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
					OutMyString(160,0,v["SaldoEndPeriod59/2"]/RepSpec.vals0,false);
				end;
			EndFormat;
			Gray_Divider(tab[30],90);
			StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[30],0,"Курсовая",false);
				OutString(tab[40],0,v["kursovaya59/2"],false);
				OutString(tab[50],0,"AZN",false);
				if(RepSpec.vals0!=0)then begin
					OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
					OutMyString(160,0,(v["kursovaya59/2"])/RepSpec.vals0,false);
				end;
			EndFormat;
		end;
		StartFormat(15);
		EndFormat;
	end;

return;
end;


procedure PrintFooterEndPeriodEndMainAcc(var vector val v, record RcVc RepSpec,boolean cretivef,array integer tab,boolean jewlf,boolean njewlf)
begin
	boolean f;
	val tempbal;
	integer i;
	
	f = false;
	For(i=0;i<CurncyCount;i=i+1) begin
		if((v["SaldoEndPeriod50n53" & CurncyStr(i)] + v["Balance59/2" & CurncyStr(i)] + v["Balance52" & CurncyStr(i)] + v["SaldoEndPeriod51" & CurncyStr(i)])!=0)then begin
			StartFormat(15);
				OutString(tab[10],0,"",false);
				if(f)then begin
					OutString(tab[20],0,"",false);
				end else begin
					OutString(tab[20],0,"Остаток общего счета",false);
					f = true;
				end;
				OutString(tab[40],0,v["SaldoEndPeriod50n53" & CurncyStr(i)] + v["Balance59/2" & CurncyStr(i)] + v["Balance52" & CurncyStr(i)] + v["SaldoEndPeriod51" & CurncyStr(i)],false);
				OutString(tab[50],0,CurncyStr(i),false);
				if (currentcompany==1) then begin
					OutString(tab[60],0,"ID счет",false);
				end;
			EndFormat;
		end;
	end;
	/*StartFormat(15);
		OutString(tab[10],0,"",false);
		OutString(tab[20],0,"",false);
		OutString(tab[40],0,v["SaldoEndPeriod51"],false);
		OutString(tab[50],0,"AZN банк",false);
	EndFormat;*/
	
	Gray_Divider(tab[30],90);
	StartFormat(15);
		OutString(tab[10],0,"",false);
		OutString(tab[30],0,"Сумма в осн. вал.",false);
		if (jewlf or (njewlf and RepSpec.sStartDate>=StringToDate("1/1/2018"))) and (!cretivef) then begin
			OutString(tab[40],0,v["SaldoEndPeriod50n51"] + v["SaldoEndPeriod53"] + v["SaldoEndPeriod59/2"],false);
			OutString(tab[50],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
				OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
				OutMyString(160,0,(v["SaldoEndPeriod50n51"] + v["SaldoEndPeriod53"] + v["SaldoEndPeriod59/2"])/RepSpec.vals0,false);
			end;
		end else begin
			OutString(tab[40],0,v["SaldoEndPeriod50n51"],false);
			OutString(tab[50],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
				OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
				OutMyString(160,0,(v["SaldoEndPeriod50n51"])/RepSpec.vals0,false);
			end;
		end;
	EndFormat;
	

return;
end;


global
procedure DirectorWeekRn(record RcVc RepSpec)
begin
  record MainVc mainr;
	record TRVc TRr;
	row TRVc TRrw,TR2rw;
  
  record DWTRVc DWTRr,DWTR2r;
  row DWTRVc DWTRrw,DWTR2rw;
  
	record ObjVc Objr;
	record IVVc IVr;
	record IPVc IPr;
	record CLInVc CLInr;
	row CLInVc CLInrw;
	record CLOutVc CLOutr;
	row CLOutVc CLOutrw;
	record CurncyCodeVc CCr;
	record AccVc Accr50,Accr58,Accr59,Accr591,Accr592,Accr4403,Accr51,Accr512,Accr52,Accr522,Accr8403,Accr76,Accr7505,Accr53,Accr601,Accr54,Accr60,Accr64;
	array string 5 CurList;
	longint i,j,k,l,rwcnt,rwcnt2,curi,ci;
	boolean TrHs,testf,done,f;
	Date tempDate;
  vector val v;
  val fr,to1EUR,to1USD,to1GBP,to1CHF,to2,br1,br2,tempBal,corspcredval,corspdebval;
	string 20 store,store2,bank,bank2;
	array integer tab,headtab;
  array boolean tabprintf;
	integer step;
	string 5 tempStr;
	string 200 tempComm;
	boolean jewlf,njewlf,cretivef,prihodprntdf,rashodprntdf,ksdacheprntdf,flag51,chsig,bankconv;
  roundmode rnd;
  val tempval;
  record CompaniesBlock Compb;
  row CompaniesBlock Comprw;
  longint curtick;
	
	i = 0;
	j = 0;
	k = 0;
	l = 0;
	rwcnt = 0;
	rwcnt2 = 0;
	curi = 0;
	ci = 0;
	
	curtick = getcurtick();
  
  rnd = DefaultCurRoundoff;
  rnd.decimals = 0;
  rnd.step = kRoundingStepNone;
  rnd.mode = kRoundingModeHalfDown;
  
	v["BeginBalance50"] = 0;
	v["BeginBalance51"] = 0;
	v["BeginBalance53"] = 0;
	v["BeginBalance59/2"] = 0;
	v["BeginBalance59/2EUR"] = 0;
	v["BeginBalance59/2USD"] = 0;
	v["BeginBalance59/2CHF"] = 0;
	v["BeginBalance50n51"] = 0;
	v["BeginBalance50n51n53"] = 0;
	v["BeginBalance50AZN"] = 0;
	v["BeginBalance50USD"] = 0;
	v["BeginBalance50EUR"] = 0;
	v["BeginBalance53AZN"] = 0;
	v["BeginBalance53USD"] = 0;
	v["BeginBalance53EUR"] = 0;
	tempBal = 0;
	v["BalItem1"] = 0;
	v["BalItem2"] = 0;
	v["SaldoEndPeriod53"] = 0;
	v["SaldoEndPeriod59/2"] = 0;
	v["SaldoEndPeriod59/2EUR"] = 0;
	v["SaldoEndPeriod59/2USD"] = 0;
	v["SaldoEndPeriod59/2CHF"] = 0;
	v["SaldoEndPeriod53AZN"] = 0;
	v["SaldoEndPeriod53USD"] = 0;
	v["SaldoEndPeriod53EUR"] = 0;
	v["SaldoEndPeriod50n51"] = 0;
	v["SaldoEndPeriod51"] = 0;
	v["SaldoEndPeriod50USD"] = 0;
	v["SaldoEndPeriod50EUR"] = 0;
	v["SaldoEndPeriod50AZN"] = 0;
	corspdebval = blankval;
	corspcredval = blankval;
	v["handed53"] = 0;
	v["kursovaya"] = 0;
	v["kommissia"] = 0;
	v["convtotal1"] = 0;
	v["convtotal2"] = 0;
	v["convtotal3"] = 0;
	v["convtotal4"] = 0;
	v["convtotal5"] = 0;
	
  v["AZN52Deb"] = 0;
  v["EUR52Deb"] = 0;
  v["USD52Deb"] = 0;
  v["GBP52Deb"] = 0;
  v["CHF52Deb"] = 0;
  
  v["AZN52Conv"] = 0;
  v["EUR52Conv"] = 0;
  v["USD52Conv"] = 0;
  v["GBP52Conv"] = 0;
  v["CHF52Conv"] = 0;
  
  v["AZN52Cred"] = 0;
  v["EUR52Cred"] = 0;
  v["USD52Cred"] = 0;
  v["GBP52Cred"] = 0;
  v["CHF52Cred"] = 0;
  
  v["EUR59/2Deb"] = 0;
  v["USD59/2Deb"] = 0;
  v["CHF59/2Deb"] = 0;
  
  v["EUR59/2Conv"] = 0;
  v["USD59/2Conv"] = 0;
  v["CHF59/2Conv"] = 0;
  
  v["EUR59/2Cred"] = 0;
  v["USD59/2Cred"] = 0;
  v["CHF59/2Cred"] = 0;
  
  prihodprntdf = false;
  rashodprntdf = false;
  ksdacheprntdf = false;
	if (CompanyIsJWLikeCompany1(CurrentCompany)) then begin
	  jewlf = true;
    njewlf = false;
	end else begin
	  jewlf = false;
    njewlf = true;
	end;
  if (CurrentCompany==9) then begin
    cretivef = true;
    if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
      cretivef = false;//Edit-------------------Vitalii 10:57 12.03.2018
    end;
  end else begin
    cretivef = false;
  end;
	curi = 0;
	while(loopmain(CCr,1,true)) begin
		CurList[curi] = CCr.CurncyCode;
		curi = curi + 1;
	end;
	
	Accr50.AccNumber = "50";
	ReadFirstMain(Accr50,1,true);
	Accr51.AccNumber = "51";
	ReadFirstMain(Accr51,1,true);
	Accr512.AccNumber = "51/2";
	ReadFirstMain(Accr512,1,true);
  Accr52.AccNumber = "52";
	ReadFirstMain(Accr52,1,true);
	Accr522.AccNumber = "52/2";
	ReadFirstMain(Accr522,1,true);
	Accr58.AccNumber = "58";
	ReadFirstMain(Accr58,1,true);
  Accr59.AccNumber = "59";
	ReadFirstMain(Accr59,1,true);
  Accr591.AccNumber = "59/1";
	ReadFirstMain(Accr591,1,true);
  Accr592.AccNumber = "59/2";
	ReadFirstMain(Accr592,1,true);
	Accr4403.AccNumber = "44/03";
	ReadFirstMain(Accr4403,1,true);
	Accr8403.AccNumber = "84/03";
	ReadFirstMain(Accr8403,1,true);
	Accr76.AccNumber = "76";
	ReadFirstMain(Accr76,1,true);
	Accr7505.AccNumber = "75/05";
	ReadFirstMain(Accr7505,1,true);
	Accr53.AccNumber = "53";
	ReadFirstMain(Accr53,1,true);
	Accr601.AccNumber = "60/1";
	ReadFirstMain(Accr601,1,true);
	Accr60.AccNumber = "60";
	ReadFirstMain(Accr60,1,true);
	Accr64.AccNumber = "64";
	ReadFirstMain(Accr64,1,true);
	
	Accr54.AccNumber = "54";
	ReadFirstMain(Accr54,1,true);
    
	mainr.AccNumber = "50";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "50") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
				if (mainr.TransDate == TRr.TransDate) and (left(TRr.Comment,len(USetStr(35148)))!=USetStr(35148)) then begin
        	rwcnt = MatRowCnt(TRr);
					switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
          for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						done = false;
						if ((TRrw.AccNumber == "50") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLInr,TRrw.RowNr,CLInrw);
												DWTRrw.ExtraComment = CLINrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and ((AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurDebVal)) or (AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects) and (TRrw.Objects==CLInr.Objects))) then begin
													DWTRrw.ExtraComment = CLInrw.Comment;
													//CLInrw.Comment = "";
													matrowput(CLInr,k,CLInrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLOutr,TRrw.RowNr,CLOutrw);
												DWTRrw.ExtraComment = CLOutrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects) and (TRrw.Objects==CLOutr.Objects)))) then begin
													DWTRrw.ExtraComment = CLOutrw.Comment;
													//CLOutrw.Comment = "";
													matrowput(CLOutr,k,CLOutrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
                case 300:
                  DWTRrw.Comment = "300." & TRr.Number;
                  DWTRrw.ExtraComment = TRr.Comment;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							
							
							// Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64

							
							if(TRrw.DebVal>0)then begin// Edit ************************** BPI Ukraine - KramarAlexandr - Thursday, 10 January 2019 14:31:15
              	chsig = false;
              	
              	testf = CorspTRTest(TRr,Accr60,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              	testf = CorspTRTest(TRr,Accr64,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              
              end;
							
							// Выше Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64
							
							DWTRrw.ReconDate = mainr.TransDate;	//в столбик Дата
							DWTRrw.Curncy = TRrw.Curncy;			//валюта
							DWTRrw.CurDebVal = TRrw.CurDebVal;	//в столбики Поступления AZN/EUR/USD
							DWTRrw.CurCredVal = TRrw.CurCredVal;	//в столбики Расходы AZN/EUR/USD
							DWTRrw.DebVal = TRrw.DebVal;			//в столбик Поступления В осн. валюте
							DWTRrw.CredVal = TRrw.CredVal;		//в столбик Расходы В осн. валюте
							if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
								DWTRrw.CurDebVal = - TRrw.CurCredVal;
								DWTRrw.CurCredVal = - TRrw.CurDebVal;
								DWTRrw.DebVal = - TRrw.CredVal;
								DWTRrw.CredVal = - TRrw.DebVal;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr58,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "58") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.CurCredVal = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.CurCredVal = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    DWTRrw.MyVal1 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.CurDebVal = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr59,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.CurCredVal = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.CurCredVal = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    DWTRrw.MyVal1 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.CurDebVal = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr591,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59/1") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.CurCredVal = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.CurCredVal = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    DWTRrw.MyVal1 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.CurDebVal = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
              if(TRr.TransDate>=stringtodate("01/01/2018"))then begin
								corspdebval = blankval;
								corspcredval = blankval;
								testf = CorspTRTest(TRr,Accr592,i,corspdebval,corspcredval);
								if testf then begin
									for (k=0;k<rwcnt;k=k+1) begin
										MatRowGet(TRr,k,TR2rw);
										if ((TR2rw.AccNumber == "59/2") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
											if(TRrw.CredVal!=0)then begin
												DWTRrw.MyVal1 = -TRrw.CurCredVal;
												DWTRrw.MyVal2 = -TRrw.CredVal;
											end else begin
												DWTRrw.MyVal1 = TRrw.CurDebVal;
												DWTRrw.MyVal2 = TRrw.DebVal;
											end;
											DWTRrw.CurDebVal = blankval;
											DWTRrw.DebVal = blankval;
											DWTRrw.CurCredVal = blankval;
											DWTRrw.CredVal = blankval;
										end;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 11:01:28
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								GetObjs("STORE",TRrw.Objects,store);
								for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if (TR2rw.AccNumber == "50") and (TR2rw.ovst <> 1) then begin 
										if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
											store2 = "";
											GetObjs("STORE",TR2rw.Objects,store2);
											if ((store == store2) and nonblank(store) and nonblank(store2)) or (blank(store) and blank(store2)) then begin
												if (TRrw.CredVal!=0) then begin
													DWTRrw.MyVal1 = -TRrw.CurCredVal;
													DWTRrw.MyVal2 = -TRrw.CredVal;
												end else begin
													DWTRrw.MyVal1 = TRrw.CurDebVal;
													DWTRrw.MyVal2 = TRrw.DebVal;
												end;
												DWTRrw.CurDebVal = blankval;
												DWTRrw.DebVal = blankval;
												DWTRrw.CurCredVal = blankval;
												DWTRrw.CredVal = blankval;
											end else begin
												if (TRrw.DebVal!=0) then begin
													TRrw.CredVal = -TRrw.DebVal;
													TRrw.DebVal = blankval;
													TRrw.CurCredVal = -TRrw.CurDebVal;
													TRrw.CurDebVal = blankval;
												end;
												DWTRrw.CurDebVal = TRrw.CurDebVal;
												DWTRrw.CurCredVal = TRrw.CurCredVal;
												DWTRrw.DebVal = TRrw.DebVal;
												DWTRrw.CredVal = TRrw.CredVal;
											end;
										end else begin
											if i != k then begin
												if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
													testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
													if testf then begin
														if (TRrw.CredVal!=0) then begin
															DWTRrw.MyVal1 = -TRrw.CurCredVal;
															DWTRrw.MyVal2 = -TRrw.CredVal;
														end else begin
															DWTRrw.MyVal1 = TRrw.CurDebVal;
															DWTRrw.MyVal2 = TRrw.DebVal;
														end;
														DWTRrw.CurDebVal = blankval;
														DWTRrw.DebVal = blankval;
														DWTRrw.CurCredVal = blankval;
														DWTRrw.CredVal = blankval;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
														
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr512,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya"] = v["kursovaya"] - corspdebval + corspcredval;
								v["kursovaya50"] = v["kursovaya50"] - corspdebval + corspcredval;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							testf = CorspTRTest(TRr,Accr522,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
							testf = CorspTRTest(TRr,Accr7505,i,corspdebval,corspcredval);
							if (testf) then begin
								if (TRrw.DebVal!=0) then begin
									TRrw.CredVal = -TRrw.DebVal;
									TRrw.DebVal = blankval;
									TRrw.CurCredVal = -TRrw.CurDebVal;
									TRrw.CurDebVal = blankval;
									DWTRrw.CurDebVal = TRrw.CurDebVal;
									DWTRrw.CurCredVal = TRrw.CurCredVal;
									DWTRrw.DebVal = TRrw.DebVal;
									DWTRrw.CredVal = TRrw.CredVal;
								end;
							end;
							testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								v["handed53"] = v["handed53"] + TRrw.CredVal;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              
              corspdebval = blankval;
							corspcredval = blankval;
              testf = CorspTRTest(TRr,Accr54,i,corspdebval,corspcredval);
							if(testf)then begin
                DWTRrw.CurDebVal = blankval;
                DWTRrw.CurCredVal = TRrw.CurCredVal - TRrw.CurDebVal;
                DWTRrw.DebVal = blankval;
                DWTRrw.CredVal = TRrw.CredVal - TRrw.DebVal;
                DWTRrw.ExtraComment = "Commission ID Group";//TRrw.Comment;
                DWTRrw.Comment = "";
                v["kommissia"] = v["kommissia"] - TRrw.DebVal + TRrw.CredVal;
                
               
								For(ci=0;ci<matrowcnt(DWTRr);ci=ci+1) begin
									matrowget(DWTRr,ci,DWTR2rw);
									if(DWTR2rw.ReconDate==DWTRrw.ReconDate and DWTR2rw.ExtraComment=="Commission ID Group")then begin
										DWTR2rw.CurCredVal = DWTR2rw.CurCredVal + DWTRrw.CurCredVal;
										DWTR2rw.CredVal = DWTR2rw.CredVal + DWTRrw.CredVal;
										matrowput(DWTRr,ci,DWTR2rw);
										done = true;
									end;
								end; 								
								;
              end;
              
              
							if (!done) then begin
								if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and (nonblank(TRrw.DebVal) and (DWTRrw.ExtraComment!="Commission ID Group"))) then begin
									MatRowPut(DWTR2r,l,DWTRrw);
									l = l + 1;
								end else begin
									MatRowPut(DWTRr,j,DWTRrw);
									j = j + 1;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.CurDebVal = blankval;
							DWTRrw.CurCredVal = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal1 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
              Clearrow(DWTRr,DWTRrw,1);
						end;
					end;
				end;
			end;
		end;
	end;
	ResetLoop(mainr);
	mainr.AccNumber = "51";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "51") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;	
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
				if (mainr.TransDate == TRr.TransDate) and (left(TRr.Comment,len(USetStr(35148)))!=USetStr(35148)) then begin
					rwcnt = MatRowCnt(TRr);
          switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
					for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						if ((TRrw.AccNumber == "51") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							flag51 = true;
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLInr,TRrw.RowNr,CLInrw);
												DWTRrw.ExtraComment = CLINrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and ((AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurDebVal)) or (AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects) and (TRrw.Objects==CLInr.Objects))) then begin
													DWTRrw.ExtraComment = CLInrw.Comment;
													//CLInrw.Comment = "";
													matrowput(CLInr,k,CLInrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLOutr,TRrw.RowNr,CLOutrw);
												DWTRrw.ExtraComment = CLOutrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects) and (TRrw.Objects==CLOutr.Objects)))) then begin
													DWTRrw.ExtraComment = CLOutrw.Comment;
													//CLOutrw.Comment = "";
													matrowput(CLOutr,k,CLOutrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								case 300:
                  DWTRrw.Comment = "300." & TRr.Number;
                  DWTRrw.ExtraComment = TRr.Comment;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							
							
							// Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64

							
							if(TRrw.DebVal>0)then begin// Edit ************************** BPI Ukraine - KramarAlexandr - Thursday, 10 January 2019 14:31:15
              	chsig = false;
              	
              	testf = CorspTRTest(TRr,Accr60,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              	testf = CorspTRTest(TRr,Accr64,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              
              end;
							
							// Выше Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64
							
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = "TER";				//валюта
							DWTRrw.CurDebVal = TRrw.DebVal;		//в столбики Поступления AZN банк
							DWTRrw.CurCredVal = TRrw.CredVal;		//в столбики Расходы AZN банк
							DWTRrw.DebVal = TRrw.DebVal;
							DWTRrw.CredVal = TRrw.CredVal;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 11:15 16.02.2016
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval);
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								bank = "";
								bankconv = false;
								GetObjs("STORE",TRrw.Objects,store);
								GetObjs("BANK",TRrw.Objects,bank);
								if(nonblank(bank))then begin
									bankconv = true;
								end;
								if (nonblank(store) or bankconv) then begin
									for (k=0;k<rwcnt;k=k+1) begin
										MatRowGet(TRr,k,TR2rw);
										if (TR2rw.AccNumber == "51") and (TR2rw.ovst <> 1) then begin 
											if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
												store2 = "";
												bank2 = "";
												GetObjs("STORE",TR2rw.Objects,store2);
												GetObjs("BANK",TR2rw.Objects,bank2);
												if(nonblank(bank2) and bankconv)then begin
													bankconv = true;
												end else begin
													bankconv = false;
												end;
												if (store==store2 or bankconv) then begin
													if (TRrw.CredVal!=0) then begin
														DWTRrw.MyVal1 = -TRrw.CredVal;
														DWTRrw.MyVal2 = -TRrw.CredVal;
													end else begin
														DWTRrw.MyVal1 = TRrw.DebVal;
														DWTRrw.MyVal2 = TRrw.DebVal;
													end;
													DWTRrw.CurDebVal = blankval;
													DWTRrw.DebVal = blankval;
													DWTRrw.CurCredVal = blankval;
													DWTRrw.CredVal = blankval;
												end else begin
													if (TRrw.DebVal!=0) then begin
														TRrw.CredVal = -TRrw.DebVal;
														TRrw.DebVal = blankval;
														TRrw.CurCredVal = -TRrw.DebVal;
														TRrw.CurDebVal = blankval;
													end;
													DWTRrw.CurDebVal = TRrw.DebVal;
													DWTRrw.CurCredVal = TRrw.CredVal;
													DWTRrw.DebVal = TRrw.DebVal;
													DWTRrw.CredVal = TRrw.CredVal;
												end;
											end else begin
												if i != k then begin
													if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
														testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
														if testf then begin
															if (TRrw.CredVal!=0) then begin
																DWTRrw.MyVal1 = -TRrw.CurCredVal;
																DWTRrw.MyVal2 = -TRrw.CredVal;
															end else begin
																DWTRrw.MyVal1 = TRrw.CurDebVal;
																DWTRrw.MyVal2 = TRrw.DebVal;
															end;
															DWTRrw.CurDebVal = blankval;
															DWTRrw.DebVal = blankval;
															DWTRrw.CurCredVal = blankval;
															DWTRrw.CredVal = blankval;
														end;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
              
              testf = CorspTRTest(TRr,Accr512,i,corspdebval,corspcredval);
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								flag51 = false;
							end;
              
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr522,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							
              
              testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);//Edit-------------------Vitalii 11:07 12.03.2018
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
              /*testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya"] = v["kursovaya"] - corspdebval + corspcredval;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;*/
							
              corspdebval = blankval;
							corspcredval = blankval;
              testf = CorspTRTest(TRr,Accr54,i,corspdebval,corspcredval);
							if testf then begin
                DWTRrw.CurDebVal = TRrw.CurDebVal;
                DWTRrw.CurCredVal = TRrw.CurCredVal;
                DWTRrw.DebVal = TRrw.DebVal;
                DWTRrw.CredVal = TRrw.CredVal;
                DWTRrw.ExtraComment = TRrw.Comment;
              end;
              
              if(flag51)then begin
								if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
									MatRowPut(DWTR2r,l,DWTRrw);
									l = l + 1;
								end else begin
									MatRowPut(DWTRr,j,DWTRrw);
									j = j + 1;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.CurDebVal = blankval;
							DWTRrw.CurCredVal = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal1 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
              DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
              Clearrow(DWTRr,DWTRrw,1);
						end;
					end;
				end;
			end;
		end;
	end;
	
	ResetLoop(mainr);
	mainr.AccNumber = "51/2";
	mainr.TransDate = RepSpec.sStartDate;
	
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "51/2") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;	
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
				if (mainr.TransDate == TRr.TransDate) and (left(TRr.Comment,len(USetStr(35148)))!=USetStr(35148)) then begin
					rwcnt = MatRowCnt(TRr);
          switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
					for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						if ((TRrw.AccNumber == "51/2") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							
							flag51 = true;
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLInr,TRrw.RowNr,CLInrw);
												DWTRrw.ExtraComment = CLINrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and ((AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurDebVal)) or (AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects) and (TRrw.Objects==CLInr.Objects))) then begin
													DWTRrw.ExtraComment = CLInrw.Comment;
													//CLInrw.Comment = "";
													matrowput(CLInr,k,CLInrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLOutr,TRrw.RowNr,CLOutrw);
												DWTRrw.ExtraComment = CLOutrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects) and (TRrw.Objects==CLOutr.Objects)))) then begin
													DWTRrw.ExtraComment = CLOutrw.Comment;
													//CLOutrw.Comment = "";
													matrowput(CLOutr,k,CLOutrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								case 300:
                  DWTRrw.Comment = "300." & TRr.Number;
                  DWTRrw.ExtraComment = TRr.Comment;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							
							// Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64

							
							if(TRrw.DebVal>0)then begin// Edit ************************** BPI Ukraine - KramarAlexandr - Thursday, 10 January 2019 14:31:15
              	chsig = false;
              	
              	testf = CorspTRTest(TRr,Accr60,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              	testf = CorspTRTest(TRr,Accr64,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              
              end;
							
							// Выше Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64
							
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = "TER";				//валюта
							DWTRrw.CurDebVal = TRrw.DebVal;		//в столбики Поступления AZN банк
							DWTRrw.CurCredVal = TRrw.CredVal;		//в столбики Расходы AZN банк
							DWTRrw.DebVal = TRrw.DebVal;
							DWTRrw.CredVal = TRrw.CredVal;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 11:15 16.02.2016
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr512,i,corspdebval,corspcredval);
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								bank = "";
								bankconv = false;
								GetObjs("STORE",TRrw.Objects,store);
								GetObjs("BANK",TRrw.Objects,bank);
								if(nonblank(bank))then begin
									bankconv = true;
								end;
								if (nonblank(store) or bankconv) then begin
									for (k=0;k<rwcnt;k=k+1) begin
										MatRowGet(TRr,k,TR2rw);
										if (TR2rw.AccNumber == "51/2") and (TR2rw.ovst <> 1) then begin 
											if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
												store2 = "";
												bank2 = "";
												GetObjs("STORE",TR2rw.Objects,store2);
												GetObjs("BANK",TR2rw.Objects,bank2);
												if(nonblank(bank2) and bankconv)then begin
													bankconv = true;
												end else begin
													bankconv = false;
												end;
												if (store==store2 or bankconv) then begin
													if (TRrw.CredVal!=0) then begin
														DWTRrw.MyVal1 = -TRrw.CredVal;
														DWTRrw.MyVal2 = -TRrw.CredVal;
													end else begin
														DWTRrw.MyVal1 = TRrw.DebVal;
														DWTRrw.MyVal2 = TRrw.DebVal;
													end;
													DWTRrw.CurDebVal = blankval;
													DWTRrw.DebVal = blankval;
													DWTRrw.CurCredVal = blankval;
													DWTRrw.CredVal = blankval;
												end else begin
													if (TRrw.DebVal!=0) then begin
														TRrw.CredVal = -TRrw.DebVal;
														TRrw.DebVal = blankval;
														TRrw.CurCredVal = -TRrw.DebVal;
														TRrw.CurDebVal = blankval;
													end;
													DWTRrw.CurDebVal = TRrw.DebVal;
													DWTRrw.CurCredVal = TRrw.CredVal;
													DWTRrw.DebVal = TRrw.DebVal;
													DWTRrw.CredVal = TRrw.CredVal;
												end;
											end else begin
												if i != k then begin
													if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
														testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
														if testf then begin
															if (TRrw.CredVal!=0) then begin
																DWTRrw.MyVal1 = -TRrw.CurCredVal;
																DWTRrw.MyVal2 = -TRrw.CredVal;
															end else begin
																DWTRrw.MyVal1 = TRrw.CurDebVal;
																DWTRrw.MyVal2 = TRrw.DebVal;
															end;
															DWTRrw.CurDebVal = blankval;
															DWTRrw.DebVal = blankval;
															DWTRrw.CurCredVal = blankval;
															DWTRrw.CredVal = blankval;
														end;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval);
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								flag51 = false;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr522,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);//Edit-------------------Vitalii 11:07 12.03.2018
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
              testf = CorspTRTest(TRr,Accr54,i,corspdebval,corspcredval);
							if testf then begin
                DWTRrw.CurDebVal = TRrw.CurDebVal;
                DWTRrw.CurCredVal = TRrw.CurCredVal;
                DWTRrw.DebVal = TRrw.DebVal;
                DWTRrw.CredVal = TRrw.CredVal;
                DWTRrw.ExtraComment = TRrw.Comment;
              end;
              
              if(flag51)then begin
								if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
									MatRowPut(DWTR2r,l,DWTRrw);
									l = l + 1;
								end else begin
									MatRowPut(DWTRr,j,DWTRrw);
									j = j + 1;
								end;
							end;
														
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.CurDebVal = blankval;
							DWTRrw.CurCredVal = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal1 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
              DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
              Clearrow(DWTRr,DWTRrw,1);
						end;
					end;
				end;
			end;
		end;
	end;
	
  ResetLoop(mainr);
  mainr.AccNumber = "52";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "52") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
      	if (mainr.TransDate == TRr.TransDate) and (left(TRr.Comment,len(USetStr(35148)))!=USetStr(35148)) then begin
					rwcnt = MatRowCnt(TRr);
					switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
          for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						done = false;
						if ((TRrw.AccNumber == "52") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLInr,TRrw.RowNr,CLInrw);
												DWTRrw.ExtraComment = CLINrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and ((AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurDebVal)) or (AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects) and (TRrw.Objects==CLInr.Objects))) then begin
													DWTRrw.ExtraComment = CLInrw.Comment;
													//CLInrw.Comment = "";
													matrowput(CLInr,k,CLInrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLOutr,TRrw.RowNr,CLOutrw);
												DWTRrw.ExtraComment = CLOutrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects) and (TRrw.Objects==CLOutr.Objects)))) then begin
													DWTRrw.ExtraComment = CLOutrw.Comment;
													//CLOutrw.Comment = "";
													matrowput(CLOutr,k,CLOutrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								case 300:
                  DWTRrw.Comment = "300." & TRr.Number;
                  DWTRrw.ExtraComment = TRr.Comment;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							
							// Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64

							
							if(TRrw.DebVal>0)then begin// Edit ************************** BPI Ukraine - KramarAlexandr - Thursday, 10 January 2019 14:31:15
              	chsig = false;
              	
              	testf = CorspTRTest(TRr,Accr60,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              	testf = CorspTRTest(TRr,Accr64,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              
              end;
							
							// Выше Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64
							
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = TRrw.Curncy & "52";
							DWTRrw.MyVal7 = TRrw.CurDebVal;
              if (!setinset("7",DWTRrw.TFromCode)) then begin
                DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
              end;
							DWTRrw.MyVal9 = TRrw.CurCredVal;
              if (!setinset("9",DWTRrw.TFromCode)) then begin
                DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
              end;
							DWTRrw.DebVal = TRrw.DebVal;
							DWTRrw.CredVal = TRrw.CredVal;
							if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
								DWTRrw.MyVal7 = - TRrw.CurCredVal;
                if (!setinset("7",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                end;
								DWTRrw.MyVal9 = - TRrw.CurDebVal;
                if (!setinset("9",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                end;
								DWTRrw.DebVal = - TRrw.CredVal;
								DWTRrw.CredVal = - TRrw.DebVal;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr58,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "58") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr59,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr591,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59/1") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 11:01:28
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								bank = "";
								bankconv = false;
								GetObjs("STORE",TRrw.Objects,store);
								GetObjs("BANK",TRrw.Objects,bank);
								if(nonblank(bank))then begin
									bankconv = true;
								end;
								for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if (TR2rw.AccNumber == "52") and (TR2rw.ovst <> 1) then begin 
										if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
											store2 = "";
											bank2 = "";
											GetObjs("STORE",TR2rw.Objects,store2);
											GetObjs("BANK",TR2rw.Objects,bank2);
											if(nonblank(bank2) and bankconv)then begin
												bankconv = true;
											end else begin
												bankconv = false;
											end;
											if ((store == store2) and nonblank(store) and nonblank(store2)) or (blank(store) and blank(store2) or bankconv) then begin
												if (TRrw.CredVal!=0) then begin
													DWTRrw.MyVal8 = -TRrw.CurCredVal;
													DWTRrw.MyVal2 = -TRrw.CredVal;
												end else begin
													DWTRrw.MyVal8 = TRrw.CurDebVal;
													DWTRrw.MyVal2 = TRrw.DebVal;
												end;
                        if (!setinset("8",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                        end;
												DWTRrw.MyVal7 = blankval;
												DWTRrw.DebVal = blankval;
												DWTRrw.MyVal9 = blankval;
												DWTRrw.CredVal = blankval;
											end else begin
												if (TRrw.DebVal!=0) then begin
													TRrw.CredVal = -TRrw.DebVal;
													TRrw.DebVal = blankval;
													TRrw.MyVal9 = -TRrw.CurDebVal;
													TRrw.MyVal7 = blankval;
												end;
												DWTRrw.MyVal7 = TRrw.CurDebVal;
                        if (!setinset("7",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                        end;
												DWTRrw.MyVal9 = TRrw.CurCredVal;
                        if (!setinset("9",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                        end;
												DWTRrw.DebVal = TRrw.DebVal;
												DWTRrw.CredVal = TRrw.CredVal;
											end;
										end else begin
											if i != k then begin
												if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
													testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
													if testf then begin
														if (TRrw.CredVal!=0) then begin
															DWTRrw.MyVal8 = -TRrw.CurCredVal;
															DWTRrw.MyVal2 = -TRrw.CredVal;
														end else begin
															DWTRrw.MyVal8 = TRrw.CurDebVal;
															DWTRrw.MyVal2 = TRrw.DebVal;
														end;
                            if (!setinset("8",DWTRrw.TFromCode)) then begin
                              DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                            end;
                            DWTRrw.MyVal7 = blankval;
														DWTRrw.DebVal = blankval;
														DWTRrw.MyVal9 = blankval;
														DWTRrw.CredVal = blankval;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
							
							flag51 = true;
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr522,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 11:01:28
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								flag51 = false;
							end;
							
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr512,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							if(TRr.TransDate>=stringtodate("01/01/2018"))then begin
								testf = CorspTRTest(TRr,Accr592,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
								if testf then begin
									if(TRrw.CredVal!=0)then begin
										DWTRrw.MyVal8 = -TRrw.CurCredVal;
										DWTRrw.MyVal2 = -TRrw.CredVal;
									end else begin
										DWTRrw.MyVal8 = TRrw.CurDebVal;
										DWTRrw.MyVal2 = TRrw.DebVal;
									end;
									if (!setinset("8",DWTRrw.TFromCode)) then begin
										DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
									end;
									DWTRrw.MyVal7 = blankval;
									DWTRrw.DebVal = blankval;
									DWTRrw.MyVal9 = blankval;
									DWTRrw.CredVal = blankval;
								end;
							end;
							
              testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
              	if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya52"] = v["kursovaya52"] - corspdebval + corspcredval;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              							
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
							testf = CorspTRTest(TRr,Accr7505,i,corspdebval,corspcredval);
							if (testf) then begin
								if (TRrw.DebVal!=0) then begin
									TRrw.CredVal = -TRrw.DebVal;
									TRrw.DebVal = blankval;
									TRrw.MyVal9 = -TRrw.CurDebVal;
									TRrw.MyVal7 = blankval;
									DWTRrw.MyVal7 = TRrw.CurDebVal;
                  if (!setinset("7",DWTRrw.TFromCode)) then begin
                    DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                  end;
									DWTRrw.MyVal9 = TRrw.CurCredVal;
                  if (!setinset("9",DWTRrw.TFromCode)) then begin
                    DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                  end;
									DWTRrw.DebVal = TRrw.DebVal;
									DWTRrw.CredVal = TRrw.CredVal;
								end;
							end;
							testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
								v["handed53"] = v["handed53"] + TRrw.CredVal;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							if(flag51)then begin
								if (!done) then begin
									if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
										MatRowPut(DWTR2r,l,DWTRrw);
										l = l + 1;
									end else begin
										MatRowPut(DWTRr,j,DWTRrw);
										j = j + 1;
									end;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.MyVal7 = blankval;
							DWTRrw.MyVal9 = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal8 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
              Clearrow(DWTRr,DWTRrw,1);
						end;
					end;
				end;
			end;
		end;
	end;
	
	
	ResetLoop(mainr);
  mainr.AccNumber = "52/2";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "52/2") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
      	if (mainr.TransDate == TRr.TransDate) and (left(TRr.Comment,len(USetStr(35148)))!=USetStr(35148)) then begin
					rwcnt = MatRowCnt(TRr);
					switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
          for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						done = false;
						if ((TRrw.AccNumber == "52/2") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLInr,TRrw.RowNr,CLInrw);
												DWTRrw.ExtraComment = CLINrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and ((AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurDebVal)) or (AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects) and (TRrw.Objects==CLInr.Objects))) then begin
													DWTRrw.ExtraComment = CLInrw.Comment;
													//CLInrw.Comment = "";
													matrowput(CLInr,k,CLInrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLOutr,TRrw.RowNr,CLOutrw);
												DWTRrw.ExtraComment = CLOutrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects) and (TRrw.Objects==CLOutr.Objects)))) then begin
													DWTRrw.ExtraComment = CLOutrw.Comment;
													//CLOutrw.Comment = "";
													matrowput(CLOutr,k,CLOutrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								case 300:
                  DWTRrw.Comment = "300." & TRr.Number;
                  DWTRrw.ExtraComment = TRr.Comment;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							
							// Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64

							
							if(TRrw.DebVal>0)then begin// Edit ************************** BPI Ukraine - KramarAlexandr - Thursday, 10 January 2019 14:31:15
              	chsig = false;
              	
              	testf = CorspTRTest(TRr,Accr60,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              	testf = CorspTRTest(TRr,Accr64,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              
              end;
							
							// Выше Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64
							
							
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = TRrw.Curncy & "52";
							DWTRrw.MyVal7 = TRrw.CurDebVal;
              if (!setinset("7",DWTRrw.TFromCode)) then begin
                DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
              end;
							DWTRrw.MyVal9 = TRrw.CurCredVal;
              if (!setinset("9",DWTRrw.TFromCode)) then begin
                DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
              end;
							DWTRrw.DebVal = TRrw.DebVal;
							DWTRrw.CredVal = TRrw.CredVal;
							if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
								DWTRrw.MyVal7 = - TRrw.CurCredVal;
                if (!setinset("7",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                end;
								DWTRrw.MyVal9 = - TRrw.CurDebVal;
                if (!setinset("9",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                end;
								DWTRrw.DebVal = - TRrw.CredVal;
								DWTRrw.CredVal = - TRrw.DebVal;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr58,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "58") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr59,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr591,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59/1") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr522,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 11:01:28
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								bank = "";
								bankconv = false;
								GetObjs("STORE",TRrw.Objects,store);
								GetObjs("BANK",TRrw.Objects,bank);
								if(nonblank(bank))then begin
									bankconv = true;
								end;
								for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if (TR2rw.AccNumber == "52/2") and (TR2rw.ovst <> 1) then begin 
										if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
											store2 = "";
											bank2 = "";
											GetObjs("STORE",TR2rw.Objects,store2);
											GetObjs("BANK",TR2rw.Objects,bank2);
											if(nonblank(bank2) and bankconv)then begin
												bankconv = true;
											end else begin
												bankconv = false;
											end;
											if ((store == store2) and nonblank(store) and nonblank(store2)) or (blank(store) and blank(store2) or bankconv) then begin
												if (TRrw.CredVal!=0) then begin
													DWTRrw.MyVal8 = -TRrw.CurCredVal;
													DWTRrw.MyVal2 = -TRrw.CredVal;
												end else begin
													DWTRrw.MyVal8 = TRrw.CurDebVal;
													DWTRrw.MyVal2 = TRrw.DebVal;
												end;
                        if (!setinset("8",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                        end;
												DWTRrw.MyVal7 = blankval;
												DWTRrw.DebVal = blankval;
												DWTRrw.MyVal9 = blankval;
												DWTRrw.CredVal = blankval;
											end else begin
												if (TRrw.DebVal!=0) then begin
													TRrw.CredVal = -TRrw.DebVal;
													TRrw.DebVal = blankval;
													TRrw.MyVal9 = -TRrw.CurDebVal;
													TRrw.MyVal7 = blankval;
												end;
												DWTRrw.MyVal7 = TRrw.CurDebVal;
                        if (!setinset("7",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                        end;
												DWTRrw.MyVal9 = TRrw.CurCredVal;
                        if (!setinset("9",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                        end;
												DWTRrw.DebVal = TRrw.DebVal;
												DWTRrw.CredVal = TRrw.CredVal;
											end;
										end else begin
											if i != k then begin
												if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
													testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
													if testf then begin
														if (TRrw.CredVal!=0) then begin
															DWTRrw.MyVal8 = -TRrw.CurCredVal;
															DWTRrw.MyVal2 = -TRrw.CredVal;
														end else begin
															DWTRrw.MyVal8 = TRrw.CurDebVal;
															DWTRrw.MyVal2 = TRrw.DebVal;
														end;
                            if (!setinset("8",DWTRrw.TFromCode)) then begin
                              DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                            end;
                            DWTRrw.MyVal7 = blankval;
														DWTRrw.DebVal = blankval;
														DWTRrw.MyVal9 = blankval;
														DWTRrw.CredVal = blankval;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
							
							flag51 = true;
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 11:01:28
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								flag51 = false;
							end;
							
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr512,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							if(TRr.TransDate>=stringtodate("01/01/2018"))then begin
								testf = CorspTRTest(TRr,Accr592,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
								if testf then begin
									if(TRrw.CredVal!=0)then begin
										DWTRrw.MyVal8 = -TRrw.CurCredVal;
										DWTRrw.MyVal2 = -TRrw.CredVal;
									end else begin
										DWTRrw.MyVal8 = TRrw.CurDebVal;
										DWTRrw.MyVal2 = TRrw.DebVal;
									end;
									if (!setinset("8",DWTRrw.TFromCode)) then begin
										DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
									end;
									DWTRrw.MyVal7 = blankval;
									DWTRrw.DebVal = blankval;
									DWTRrw.MyVal9 = blankval;
									DWTRrw.CredVal = blankval;
								end;
							end;
							
              testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
              	if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya52"] = v["kursovaya52"] - corspdebval + corspcredval;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              							
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
							testf = CorspTRTest(TRr,Accr7505,i,corspdebval,corspcredval);
							if (testf) then begin
								if (TRrw.DebVal!=0) then begin
									TRrw.CredVal = -TRrw.DebVal;
									TRrw.DebVal = blankval;
									TRrw.MyVal9 = -TRrw.CurDebVal;
									TRrw.MyVal7 = blankval;
									DWTRrw.MyVal7 = TRrw.CurDebVal;
                  if (!setinset("7",DWTRrw.TFromCode)) then begin
                    DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                  end;
									DWTRrw.MyVal9 = TRrw.CurCredVal;
                  if (!setinset("9",DWTRrw.TFromCode)) then begin
                    DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                  end;
									DWTRrw.DebVal = TRrw.DebVal;
									DWTRrw.CredVal = TRrw.CredVal;
								end;
							end;
							testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
								v["handed53"] = v["handed53"] + TRrw.CredVal;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							if(flag51)then begin
								if (!done) then begin
									if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
										MatRowPut(DWTR2r,l,DWTRrw);
										l = l + 1;
									end else begin
										MatRowPut(DWTRr,j,DWTRrw);
										j = j + 1;
									end;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.MyVal7 = blankval;
							DWTRrw.MyVal9 = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal8 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
              Clearrow(DWTRr,DWTRrw,1);
						end;
					end;
				end;
			end;
		end;
	end;
	
	
  if (RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef) then begin
    ResetLoop(mainr);
    mainr.AccNumber = "53";
    mainr.TransDate = RepSpec.sStartDate;
    TrHs = true;
    while (LoopMain(mainr,2,TrHs)) begin
      if ((mainr.AccNumber != "53") or (mainr.TransDate > RepSpec.sEndDate))  then begin
        TrHs = false;
      end;
      if (TrHs) then begin
        TRr.Number = mainr.TransNr;
        TRr.IntYc = mainr.IntYc;
        if (ReadFirstMain(TRr,2,true)) then begin
          if (mainr.TransDate == TRr.TransDate) and (left(TRr.Comment,len(USetStr(35148)))!=USetStr(35148)) then begin
            rwcnt = MatRowCnt(TRr);
            switch (TRr.IntYc) begin
              case IVYc:
                IVr.SerNr = TRr.Number;
                if (ReadFirstMain(IVr,1,true)) then begin
                  f = true;
                end else begin
                  f = false;
                end;
              case IPYc:
                IPr.SerNr = TRr.Number;
                if (ReadFirstMain(IPr,1,true)) then begin
                  f = true;
                end else begin
                  f = false;
                end;
              case CLInYc:
                CLInr.SerNr = TRr.Number;
                if (ReadFirstMain(CLInr,1,true)) then begin
                  f = true;
                end else begin
                  f = false;
                end;
              case CLOutYc:
                CLOutr.SerNr = TRr.Number;
                if (ReadFirstMain(CLOutr,1,true)) then begin
                  f = true;
                end else begin
                  f = false;
                end;
            end;
            for (i=0;i<rwcnt;i=i+1) begin
              MatRowGet(TRr,i,TRrw);
              done = false;
              if ((TRrw.AccNumber == "53") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
                switch (TRr.IntYc) begin
                  case IVYc:
                    if (f) then begin
                      DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
                      DWTRrw.ExtraComment = TRr.Comment;
                    end;
                  case IPYc:
                    if (f) then begin
                      DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
                      DWTRrw.ExtraComment = TRr.Comment;
                    end;
                  case CLInYc:
                    if (f) then begin
                      DWTRrw.Comment = "ПКО." & CLInr.SerNr;
                      rwcnt2 = MatRowCnt(CLInr);
                      for (k=0;k<rwcnt2;k=k+1) begin
                        MatRowGet(CLInr,k,CLInrw);
                        if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
													MatRowGet(CLInr,TRrw.RowNr,CLInrw);
													DWTRrw.ExtraComment = CLINrw.Comment;
													k = rwcnt2;
												end else begin
													if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and ((AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurDebVal)) or (AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects) and (TRrw.Objects==CLInr.Objects))) then begin
														DWTRrw.ExtraComment = CLInrw.Comment;
														//CLInrw.Comment = "";
														matrowput(CLInr,k,CLInrw);
														k = rwcnt2;
													end;
                        end;
                      end;
                      if blank(DWTRrw.ExtraComment) then begin
                        DWTRrw.ExtraComment = CLInr.CorspComment;
                      end;
                    end;
                  case CLOutYc:
                    if (f) then begin
                      DWTRrw.Comment = "РКО." & CLOutr.SerNr;
                      rwcnt2 = MatRowCnt(CLOutr);
                      for (k=0;k<rwcnt2;k=k+1) begin
                        MatRowGet(CLOutr,k,CLOutrw);
                        if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
													MatRowGet(CLOutr,TRrw.RowNr,CLOutrw);
													DWTRrw.ExtraComment = CLOutrw.Comment;
													k = rwcnt2;
												end else begin
													if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects) and (TRrw.Objects==CLOutr.Objects)))) then begin
														DWTRrw.ExtraComment = CLOutrw.Comment;
														CLOutrw.Comment = "";
														matrowput(CLOutr,k,CLOutrw);
														k = rwcnt2;
													end;
                        end;
                      end;
                      if blank(DWTRrw.ExtraComment) then begin
                        DWTRrw.ExtraComment = CLOutr.CorspComment;
                      end;
                    end;
                  case 300:
                  DWTRrw.Comment = "300." & TRr.Number;
                  DWTRrw.ExtraComment = TRr.Comment;
								otherwise
                    YcToStr(TRr.IntYc,tempStr);
                    DWTRrw.Comment = tempStr & "." & TRr.Number;
                    DWTRrw.ExtraComment = TRr.Comment;
                end;
                
                // Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64

							
							if(TRrw.DebVal>0)then begin// Edit ************************** BPI Ukraine - KramarAlexandr - Thursday, 10 January 2019 14:31:15
              	chsig = false;
              	
              	testf = CorspTRTest(TRr,Accr60,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              	testf = CorspTRTest(TRr,Accr64,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              
              end;
							
							// Выше Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64
                
                DWTRrw.ReconDate = mainr.TransDate;
                DWTRrw.Curncy = TRrw.Curncy;				//валюта
                DWTRrw.MyVal16 = TRrw.CurDebVal;		//в столбики Поступления AZN 
                DWTRrw.MyVal17 = TRrw.CurCredVal;		//в столбики Расходы AZN 
                DWTRrw.DebVal = TRrw.DebVal;        //в столбики Поступления AZN осн
                DWTRrw.CredVal = TRrw.CredVal;      //в столбики Расходы AZN осн
                if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
                  DWTRrw.MyVal16 = - TRrw.CurCredVal;
                  DWTRrw.MyVal17 = - TRrw.CurDebVal;
                  DWTRrw.DebVal = - TRrw.CredVal;
                  DWTRrw.CredVal = - TRrw.DebVal;
                end;
                
                corspdebval = blankval;
                corspcredval = blankval;
                testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);
                if testf then begin
                  if(TRrw.CredVal!=0)then begin
                    DWTRrw.MyVal18 = -TRrw.CurCredVal;
                    DWTRrw.MyVal2 = -TRrw.CredVal;
                  end else begin
                    DWTRrw.MyVal18 = TRrw.CurDebVal;
                    DWTRrw.MyVal2 = TRrw.DebVal;
                  end;
                  DWTRrw.TFromFileName = "53";
                  DWTRrw.MyVal16 = blankval;
                  DWTRrw.DebVal = blankval;
                  DWTRrw.MyVal17 = blankval;
                  DWTRrw.CredVal = blankval;
                end;
                corspdebval = blankval;
                corspcredval = blankval;
                testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr512,i,corspdebval,corspcredval);
                if testf then begin
                  if(TRrw.CredVal!=0)then begin
                    DWTRrw.MyVal18 = -TRrw.CurCredVal;
                    DWTRrw.MyVal2 = -TRrw.CredVal;
                  end else begin
                    DWTRrw.MyVal18 = TRrw.CurDebVal;
                    DWTRrw.MyVal2 = TRrw.DebVal;
                  end;
                  DWTRrw.TFromFileName = "53";
                  DWTRrw.MyVal16 = blankval;
                  DWTRrw.DebVal = blankval;
                  DWTRrw.MyVal17 = blankval;
                  DWTRrw.CredVal = blankval;
                end;
                corspdebval = blankval;
                corspcredval = blankval;
                testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr522,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
                if testf then begin
                  if(TRrw.CredVal!=0)then begin
                    DWTRrw.MyVal18 = -TRrw.CurCredVal;
                    DWTRrw.MyVal2 = -TRrw.CredVal;
                  end else begin
                    DWTRrw.MyVal18 = TRrw.CurDebVal;
                    DWTRrw.MyVal2 = TRrw.DebVal;
                  end;
                  DWTRrw.TFromFileName = "53";
                  DWTRrw.MyVal16 = blankval;
                  DWTRrw.DebVal = blankval;
                  DWTRrw.MyVal17 = blankval;
                  DWTRrw.CredVal = blankval;
                end;
                
                if(TRr.TransDate>=stringtodate("01/01/2018"))then begin
									corspdebval = blankval;
									corspcredval = blankval;
									testf = CorspTRTest(TRr,Accr592,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
									if testf then begin
										if(TRrw.CredVal!=0)then begin
											DWTRrw.MyVal18 = -TRrw.CurCredVal;
											DWTRrw.MyVal2 = -TRrw.CredVal;
										end else begin
											DWTRrw.MyVal18 = TRrw.CurDebVal;
											DWTRrw.MyVal2 = TRrw.DebVal;
										end;
										DWTRrw.TFromFileName = "53";
										DWTRrw.MyVal16 = blankval;
										DWTRrw.DebVal = blankval;
										DWTRrw.MyVal17 = blankval;
										DWTRrw.CredVal = blankval;
									end;
                end;
                
                corspdebval = blankval;
                corspcredval = blankval;
                testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
                if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
                  store = "";
                  GetObjs("STORE",TRrw.Objects,store);
                  if(blank(TRrw.Objects))then begin
                  	store = "BLANK";
                  end;
                  if nonblank(store) then begin
                    for (k=0;k<rwcnt;k=k+1) begin
                      MatRowGet(TRr,k,TR2rw);
                      if (TR2rw.AccNumber == "53") and (TR2rw.ovst <> 1) then begin 
                        if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
                          store2 = "";
                          GetObjs("STORE",TR2rw.Objects,store2);
                          if(blank(TR2rw.Objects))then begin
														store2 = "BLANK";
													end;
                          if (store == store2) then begin
                            if (TRrw.CredVal!=0) then begin
                              DWTRrw.MyVal18 = -TRrw.CurCredVal;
                              DWTRrw.MyVal2 = -TRrw.CredVal;
                            end else begin
                              DWTRrw.MyVal18 = TRrw.CurDebVal;
                              DWTRrw.MyVal2 = TRrw.DebVal;
                            end;
                            DWTRrw.TFromFileName = "53";
                            DWTRrw.MyVal16 = blankval;
                            DWTRrw.DebVal = blankval;
                            DWTRrw.MyVal17 = blankval;
                            DWTRrw.CredVal = blankval;
                          end else begin
                            DWTRrw.MyVal16 = TRrw.DebVal;
                            DWTRrw.MyVal17 = TRrw.CredVal;
                            DWTRrw.DebVal = TRrw.DebVal;
                            DWTRrw.CredVal = TRrw.CredVal;
                            if (TRrw.DebVal!=0) then begin
                              TRrw.CredVal = -TRrw.DebVal;
                              TRrw.DebVal = blankval;
                              TRrw.CurCredVal = -TRrw.DebVal;
                              TRrw.CurDebVal = blankval;
                            end;
                          end;
                        end else begin
                          if i != k then begin
                            if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
                              testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
                              if testf then begin
                                if (TRrw.CredVal!=0) then begin
                                  DWTRrw.MyVal18 = -TRrw.CurCredVal;
                                  DWTRrw.MyVal2 = -TRrw.CredVal;
                                end else begin
                                  DWTRrw.MyVal18 = TRrw.CurDebVal;
                                  DWTRrw.MyVal2 = TRrw.DebVal;
                                end;
                                DWTRrw.TFromFileName = "53";
                                DWTRrw.MyVal16 = blankval;
                                DWTRrw.DebVal = blankval;
                                DWTRrw.MyVal17 = blankval;
                                DWTRrw.CredVal = blankval;
                              end;
                            end;
                          end;
                        end;
                      end;
                    end;
                  end else begin
                    if (currentcompany==9) then begin
                      if (TRrw.CredVal!=0) then begin
                        DWTRrw.MyVal18 = -TRrw.CredVal;
                        DWTRrw.MyVal2 = -TRrw.CredVal;
                      end else begin
                        DWTRrw.MyVal18 = TRrw.DebVal;
                        DWTRrw.MyVal2 = TRrw.DebVal;
                      end;
                      DWTRrw.TFromFileName = "53";
                      DWTRrw.MyVal16 = blankval;
                      DWTRrw.DebVal = blankval;
                      DWTRrw.MyVal17 = blankval;
                      DWTRrw.CredVal = blankval;
                    end;
                  end;
                end;
                corspdebval = blankval;
                corspcredval = blankval;
                testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);
                if testf then begin
                  if(TRrw.CredVal!=0)then begin
                    DWTRrw.MyVal18 = -TRrw.CurCredVal;
                    DWTRrw.MyVal2 = -TRrw.CredVal;
                  end else begin
                    DWTRrw.MyVal18 = TRrw.CurDebVal;
                    DWTRrw.MyVal2 = TRrw.DebVal;
                  end;
                  DWTRrw.TFromFileName = "53";
                  DWTRrw.MyVal3 = - corspdebval + corspcredval;
                  DWTRrw.MyVal16 = blankval;
                  DWTRrw.DebVal = blankval;
                  DWTRrw.MyVal17 = blankval;
                  DWTRrw.CredVal = blankval;
                  v["kursovaya53"] = v["kursovaya53"] - corspdebval + corspcredval;
                end;
                
                if (!done) then begin
                  if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
                    MatRowPut(DWTR2r,l,DWTRrw);
                    l = l + 1;
                  end else begin
                    MatRowPut(DWTRr,j,DWTRrw);
                    j = j + 1;
                  end;
                end;
                DWTRrw.ReconDate = "";
                DWTRrw.Curncy = "";
                DWTRrw.CurDebVal = blankval;
                DWTRrw.CurCredVal = blankval;
                DWTRrw.DebVal = blankval;
                DWTRrw.CredVal = blankval;
                DWTRrw.MyVal16 = blankval;
                DWTRrw.MyVal17 = blankval;
                DWTRrw.MyVal18 = blankval;
                DWTRrw.MyVal2 = blankval;
                DWTRrw.MyVal3 = blankval;
                DWTRrw.Comment = "";
                DWTRrw.ExtraComment = "";
                DWTRrw.TFromFileName = "";
                Clearrow(DWTRr,DWTRrw,1);
              end;
            end;
          end;
        end;
      end;
    end;
  end;
  
  resetloop(mainr);
  mainr.AccNumber = "59/2";
	mainr.TransDate = RepSpec.sStartDate;
	
	TrHs = true;
	if(mainr.TransDate<stringtodate("01/01/2018"))then begin
		if(RepSpec.sEndDate>=stringtodate("01/01/2018"))then begin
			mainr.TransDate=stringtodate("01/01/2018");
		end else begin
			TrHs = false;
		end;
	end;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "59/2") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
				if (mainr.TransDate == TRr.TransDate) and (left(TRr.Comment,len(USetStr(35148)))!=USetStr(35148)) then begin
					rwcnt = MatRowCnt(TRr);
					switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
          
          for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						done = false;
						if ((TRrw.AccNumber == "59/2") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLInr,TRrw.RowNr,CLInrw);
												DWTRrw.ExtraComment = CLINrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and ((AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurDebVal)) or (AbsoluteVal(CLInrw.Sum) == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects) and (TRrw.Objects==CLInr.Objects))) then begin
													DWTRrw.ExtraComment = CLInrw.Comment;
													//CLInrw.Comment = "";
													matrowput(CLInr,k,CLInrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if(TRrw.RowNr>0 and TRrw.RowNr<999)then begin 
												MatRowGet(CLOutr,TRrw.RowNr,CLOutrw);
												DWTRrw.ExtraComment = CLOutrw.Comment;
												k = rwcnt2;
											end else begin
												if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects) and (TRrw.Objects==CLOutr.Objects)))) then begin
													DWTRrw.ExtraComment = CLOutrw.Comment;
													//CLOutrw.Comment = "";
													matrowput(CLOutr,k,CLOutrw);
													k = rwcnt2;
												end;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
                case 300:
                  DWTRrw.Comment = "300." & TRr.Number;
                  DWTRrw.ExtraComment = TRr.Comment;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							
							// Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64

							
							if(TRrw.DebVal>0)then begin// Edit ************************** BPI Ukraine - KramarAlexandr - Thursday, 10 January 2019 14:31:15
              	chsig = false;
              	
              	testf = CorspTRTest(TRr,Accr60,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              	testf = CorspTRTest(TRr,Accr64,i,corspdebval,corspcredval);
								if(testf and chsig==false)then begin
									tempval = blankval;
              		tempval = TRrw.CredVal;
              		TRrw.CredVal = -TRrw.DebVal;
              		TRrw.DebVal = -tempval;
              		tempval = blankval;
              		tempval = TRrw.CurCredVal;
              		TRrw.CurCredVal = -TRrw.CurDebVal;
              		TRrw.CurDebVal = -tempval;
              		chsig = true;
              	end;
              
              end;
							
							// Выше Меняем местами дебит с кредитом + "-" по 50 счету если 50 корреспондрует с 60 или 64
							
							
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = TRrw.Curncy;				//валюта
							DWTRrw.MyVal42 = TRrw.CurDebVal;		//в столбики Поступления AZN 
							DWTRrw.MyVal44 = TRrw.CurCredVal;		//в столбики Расходы AZN 
							DWTRrw.DebVal = TRrw.DebVal;        //в столбики Поступления AZN осн
							DWTRrw.CredVal = TRrw.CredVal;      //в столбики Расходы AZN осн
							if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
								DWTRrw.MyVal42 = - TRrw.CurCredVal;
								DWTRrw.MyVal44 = - TRrw.CurDebVal;
								DWTRrw.DebVal = - TRrw.CredVal;
								DWTRrw.CredVal = - TRrw.DebVal;
							end;
							
							
							
							//************************************************************************** конвертация begin
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr592,i,corspdebval,corspcredval);
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								GetObjs("STORE",TRrw.Objects,store);
								if(blank(TRrw.Objects))then begin
									store = "BLANK";
								end;
								if nonblank(store) then begin
									for (k=0;k<rwcnt;k=k+1) begin
										MatRowGet(TRr,k,TR2rw);
										if (TR2rw.AccNumber == "59/2") and (TR2rw.ovst <> 1) then begin 
											if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
												store2 = "";
												GetObjs("STORE",TR2rw.Objects,store2);
												if(blank(TR2rw.Objects))then begin
													store2 = "BLANK";
												end;
												if (store == store2) then begin
													if (TRrw.CredVal!=0) then begin
														DWTRrw.MyVal18 = -TRrw.CurCredVal;
														DWTRrw.MyVal2 = -TRrw.CredVal;
													end else begin
														DWTRrw.MyVal18 = TRrw.CurDebVal;
														DWTRrw.MyVal2 = TRrw.DebVal;
													end;
													DWTRrw.TFromFileName = "59/2";
													DWTRrw.MyVal42 = blankval;
													DWTRrw.DebVal = blankval;
													DWTRrw.MyVal44 = blankval;
													DWTRrw.CredVal = blankval;
												end else begin
													DWTRrw.MyVal42 = TRrw.DebVal;
													DWTRrw.MyVal44 = TRrw.CredVal;
													DWTRrw.DebVal = TRrw.DebVal;
													DWTRrw.CredVal = TRrw.CredVal;
													if (TRrw.DebVal!=0) then begin
														TRrw.CredVal = -TRrw.DebVal;
														TRrw.DebVal = blankval;
														TRrw.CurCredVal = -TRrw.DebVal;
														TRrw.CurDebVal = blankval;
													end;
												end;
											end else begin
												if i != k then begin
													if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
														testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
														if testf then begin
															if (TRrw.CredVal!=0) then begin
																DWTRrw.MyVal18 = -TRrw.CurCredVal;
																DWTRrw.MyVal2 = -TRrw.CredVal;
															end else begin
																DWTRrw.MyVal18 = TRrw.CurDebVal;
																DWTRrw.MyVal2 = TRrw.DebVal;
															end;
															DWTRrw.TFromFileName = "59/2";
															DWTRrw.MyVal42 = blankval;
															DWTRrw.DebVal = blankval;
															DWTRrw.MyVal44 = blankval;
															DWTRrw.CredVal = blankval;
														end;
													end;
												end;
											end;
										end;
									end;
								end else begin
									if (currentcompany==9) then begin
										if (TRrw.CredVal!=0) then begin
											DWTRrw.MyVal18 = -TRrw.CredVal;
											DWTRrw.MyVal2 = -TRrw.CredVal;
										end else begin
											DWTRrw.MyVal18 = TRrw.DebVal;
											DWTRrw.MyVal2 = TRrw.DebVal;
										end;
										DWTRrw.TFromFileName = "59/2";
										DWTRrw.MyVal42 = blankval;
										DWTRrw.DebVal = blankval;
										DWTRrw.MyVal44 = blankval;
										DWTRrw.CredVal = blankval;
									end;
								end;
							end;
							
							//************************************************************************** конвертация end
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval) or CorspTRTest(TRr,Accr522,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal43 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal43 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.TFromFileName = "59/2";
								DWTRrw.DebVal = blankval;
								DWTRrw.CredVal = blankval;
								DWTRrw.MyVal42 = blankval;
								DWTRrw.MyVal44 = blankval;
							end;	
							
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal43 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal43 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.TFromFileName = "59/2";
								DWTRrw.DebVal = blankval;
								DWTRrw.CredVal = blankval;
								DWTRrw.MyVal42 = blankval;
								DWTRrw.MyVal44 = blankval;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal43 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal43 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.TFromFileName = "59/2";
								DWTRrw.DebVal = blankval;
								DWTRrw.CredVal = blankval;
								DWTRrw.MyVal42 = blankval;
								DWTRrw.MyVal44 = blankval;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal43 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal43 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.TFromFileName = "59/2";
								DWTRrw.MyVal3 = - corspdebval + corspcredval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CredVal = blankval;
								DWTRrw.MyVal42 = blankval;
								DWTRrw.MyVal44 = blankval;
								v["kursovaya59/2"] = v["kursovaya59/2"] - corspdebval + corspcredval;
							end;						
							
							if (!done) then begin
								if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
									MatRowPut(DWTR2r,l,DWTRrw);
									l = l + 1;
								end else begin
									MatRowPut(DWTRr,j,DWTRrw);
									j = j + 1;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal42 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal43 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal44 = blankval;
							DWTRrw.MyVal2 = blankval;
							DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
              Clearrow(DWTRr,DWTRrw,1);
						end;
					end;
				end;
			end;
		end;
  end;
  
	rwcnt = MatRowCnt(DWTRr);
	for (i=0;i<rwcnt;i=i+1) begin
		MatRowGet(DWTRr,i,DWTRrw);
		if (right(DWTRrw.Curncy,2)=="52") then begin
      f = true;
    end else begin
      f = false;
    end;
    DWTRrw.Curncy = left(DWTRrw.Curncy,3);
		MatRowPut(DWTRr,i,DWTRrw);
    switch (DWTRrw.Curncy) begin
      case "TER":
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[20] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[130] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[250] = true; end;
      case "AZN":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[30] = true; end;
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[60] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[140] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[170] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[260] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[290] = true; end;
        if (DWTRrw.MyVal16!=blankval) then begin tabprintf[90] = true; end;
        if (DWTRrw.MyVal18!=blankval) then begin tabprintf[200] = true; end;
        if (DWTRrw.MyVal17!=blankval) then begin tabprintf[320] = true; end;
      case "EUR":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[40] = true; end;
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[70] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[150] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[180] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[270] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[300] = true; end;
        if (DWTRrw.MyVal16!=blankval) then begin tabprintf[100] = true; end;
        if (DWTRrw.MyVal18!=blankval) then begin tabprintf[210] = true; end;
        if (DWTRrw.MyVal17!=blankval) then begin tabprintf[330] = true; end;
        if (DWTRrw.MyVal42!=blankval) then begin tabprintf[111] = true; end;
        if (DWTRrw.MyVal43!=blankval) then begin tabprintf[221] = true; end;
        if (DWTRrw.MyVal44!=blankval) then begin tabprintf[341] = true; end;
      case "USD":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[50] = true; end;
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[80] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[160] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[190] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[280] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[310] = true; end;
        if (DWTRrw.MyVal16!=blankval) then begin tabprintf[110] = true; end;
        if (DWTRrw.MyVal18!=blankval) then begin tabprintf[220] = true; end;
        if (DWTRrw.MyVal17!=blankval) then begin tabprintf[340] = true; end;
        if (DWTRrw.MyVal42!=blankval) then begin tabprintf[112] = true; end;
        if (DWTRrw.MyVal43!=blankval) then begin tabprintf[222] = true; end;
        if (DWTRrw.MyVal44!=blankval) then begin tabprintf[342] = true; end;
      case "GBP":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[51] = true; end;
        //if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[80] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[161] = true; end;
        //if (DWTRrw.MyVal1!=blankval) then begin tabprintf[190] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[281] = true; end;
        //if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[310] = true; end;
        //if (DWTRrw.MyVal16!=blankval) then begin tabprintf[110] = true; end;
        //if (DWTRrw.MyVal18!=blankval) then begin tabprintf[220] = true; end;
        //if (DWTRrw.MyVal17!=blankval) then begin tabprintf[340] = true; end;
      case "CHF":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[52] = true; end;
        //if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[80] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[162] = true; end;
        //if (DWTRrw.MyVal1!=blankval) then begin tabprintf[190] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[282] = true; end;
        //if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[310] = true; end;
        //if (DWTRrw.MyVal16!=blankval) then begin tabprintf[110] = true; end;
        //if (DWTRrw.MyVal18!=blankval) then begin tabprintf[220] = true; end;
        //if (DWTRrw.MyVal17!=blankval) then begin tabprintf[340] = true; end;
        if (DWTRrw.MyVal42!=blankval) then begin tabprintf[113] = true; end;
        if (DWTRrw.MyVal43!=blankval) then begin tabprintf[223] = true; end;
        if (DWTRrw.MyVal44!=blankval) then begin tabprintf[343] = true; end;
    end;
    if (DWTRrw.DebVal!=blankval) then begin tabprintf[120] = true; end;
    if (DWTRrw.MyVal2!=blankval) then begin tabprintf[230] = true; end;
    if (DWTRrw.MyVal3!=blankval) then begin tabprintf[240] = true; end;
    if (DWTRrw.CredVal!=blankval) then begin tabprintf[350] = true; end;
	end;
	if (RepSpec.ArtMode == 1) then begin
		rwcnt2 = MatRowCnt(DWTR2r);
		for (i=0;i<rwcnt2;i=i+1) begin
			MatRowGet(DWTR2r,i,DWTRrw);
			if (right(DWTRrw.Curncy,2)=="52") then begin
        f = true;
      end else begin
        f = false;
      end;
      DWTRrw.Curncy = left(DWTRrw.Curncy,3);
			MatRowPut(DWTR2r,i,DWTRrw);
      if (f) then begin
        switch (DWTRrw.Curncy) begin
          case "AZN":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[30] = true; end;
          case "EUR":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[40] = true; end;
          case "USD":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[50] = true; end;
          case "GBP":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[51] = true; end;
          case "CHF":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[52] = true; end;
        end;
      end;
      switch (DWTRrw.Curncy) begin
        case "TER":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[20] = true; end;
        case "AZN":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[60] = true; end;
          if (DWTRrw.MyVal16!=blankval) then begin tabprintf[90] = true; end;
        case "EUR":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[70] = true; end;
          if (DWTRrw.MyVal16!=blankval) then begin tabprintf[100] = true; end;
        case "USD":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[80] = true; end;
          if (DWTRrw.MyVal16!=blankval) then begin tabprintf[110] = true; end;
      end;
      if (DWTRrw.DebVal!=blankval) then begin tabprintf[120] = true; end;
      if (f) then begin
        switch (DWTRrw.Curncy) begin
          case "AZN":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[140] = true; end;
          case "EUR":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[150] = true; end;
          case "USD":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[160] = true; end;
          case "GBP":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[161] = true; end;
          case "CHF":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[162] = true; end;
        end;
      end;
      switch (DWTRrw.Curncy) begin
        case "TER":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[130] = true; end;
        case "AZN":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[170] = true; end;
          if (DWTRrw.MyVal18!=blankval) then begin tabprintf[200] = true; end;
        case "EUR":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[180] = true; end;
          if (DWTRrw.MyVal18!=blankval) then begin tabprintf[210] = true; end;
        case "USD":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[190] = true; end;
          if (DWTRrw.MyVal18!=blankval) then begin tabprintf[220] = true; end;
      end;
      if (DWTRrw.MyVal2!=blankval) then begin tabprintf[230] = true; end;
      if (DWTRrw.MyVal3!=blankval) then begin tabprintf[240] = true; end;
		end;
		rwcnt2 = MatRowCnt(DWTR2r);
		for (j=0;j<rwcnt2-1;j=j+1) begin
			for (i=0;i<rwcnt2-1;i=i+1) begin
				MatRowGet(DWTR2r,i,DWTRrw);
				MatRowGet(DWTR2r,i+1,DWTR2rw);
				if (DWTRrw.ReconDate > DWTR2rw.ReconDate) then begin
					MatRowPut(DWTR2r,i,DWTR2rw);
					MatRowPut(DWTR2r,i+1,DWTRrw);
				end;
			end;
		end;
		for (i=0;i<rwcnt2;i=i+1) begin
			MatRowGet(DWTR2r,i,DWTRrw);
      DWTRrw.MyVal6 = DWTRrw.MyVal3;
			switch (DWTRrw.Curncy) begin
				case "TER":
					DWTRrw.NomVal = DWTRrw.CurDebVal;
          DWTRrw.MyVal5 = DWTRrw.MyVal1;
          DWTRrw.MyVal1 = 0;
          DWTRrw.CurDebVal = 0;
				case "AZN":
					DWTRrw.CredVal2 = DWTRrw.CurDebVal;
          DWTRrw.MyVal1 = DWTRrw.MyVal1;
          DWTRrw.MyVal10 = DWTRrw.MyVal7;
          DWTRrw.MyVal13 = DWTRrw.MyVal8;
          if (!setinset("13",DWTRrw.TFromCode)) then begin
            DWTRrw.TFromCode = DWTRrw.TFromCode & "13,";
          end;
          DWTRrw.MyVal7 = 0;
          if (!setinset("7",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"7");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.MyVal8 = 0;
          if (!setinset("8",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"8");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.CurDebVal = 0;
				case "EUR":
					DWTRrw.DebVal2 = DWTRrw.CurDebVal;
          DWTRrw.MyVal11 = DWTRrw.MyVal7;
          DWTRrw.MyVal3 = DWTRrw.MyVal1;
          DWTRrw.MyVal14 = DWTRrw.MyVal8;
          DWTRrw.MyVal1 = 0;
          DWTRrw.MyVal7 = 0;
          if (!setinset("7",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"7");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.MyVal8 = 0;
          if (!setinset("8",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"8");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.CurDebVal = 0;
				case "USD":
					if(currentuser=="SA1")then begin
						logtext(0,"DWTRrw.MyVal8 " & DWTRrw.MyVal8);
					end;
					DWTRrw.Qty = DWTRrw.CurDebVal;
          DWTRrw.MyVal4 = DWTRrw.MyVal1;
          DWTRrw.MyVal12 = DWTRrw.MyVal7;
          DWTRrw.MyVal15 = DWTRrw.MyVal8;
          DWTRrw.MyVal1 = 0;
          DWTRrw.MyVal7 = 0;
          if (!setinset("7",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"7");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.MyVal8 = 0;
          if (!setinset("8",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"8");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.CurDebVal = 0;
			end;
			MatRowPut(DWTR2r,i,DWTRrw);
		end;
		for (j=0;j<rwcnt2-1;j=j+1) begin
			MatRowGet(DWTR2r,j,DWTRrw);
			for (i=j + 1;i<rwcnt2;i=i+1) begin
				MatRowGet(DWTR2r,i,DWTR2rw);
				if (DWTRrw.ReconDate == DWTR2rw.ReconDate) then begin
					DWTRrw.CredVal2 = DWTRrw.CredVal2 + DWTR2rw.CredVal2;
					DWTRrw.DebVal2 = DWTRrw.DebVal2 + DWTR2rw.DebVal2;
					DWTRrw.Qty = DWTRrw.Qty + DWTR2rw.Qty;
					DWTRrw.NomVal = DWTRrw.NomVal + DWTR2rw.NomVal;
					DWTRrw.DebVal = DWTRrw.DebVal + DWTR2rw.DebVal;
					DWTRrw.MyVal1 = DWTRrw.MyVal1 + DWTR2rw.MyVal1;
          DWTRrw.MyVal2 = DWTRrw.MyVal2 + DWTR2rw.MyVal2;
					DWTRrw.MyVal3 = DWTRrw.MyVal3 + DWTR2rw.MyVal3;
          DWTRrw.MyVal4 = DWTRrw.MyVal4 + DWTR2rw.MyVal4;
					DWTRrw.MyVal5 = DWTRrw.MyVal5 + DWTR2rw.MyVal5;
          DWTRrw.MyVal10 = DWTRrw.MyVal10 + DWTR2rw.MyVal10;
          DWTRrw.MyVal11 = DWTRrw.MyVal11 + DWTR2rw.MyVal11;
          DWTRrw.MyVal12 = DWTRrw.MyVal12 + DWTR2rw.MyVal12;
          DWTRrw.MyVal13 = DWTRrw.MyVal13 + DWTR2rw.MyVal13;
          DWTRrw.MyVal14 = DWTRrw.MyVal14 + DWTR2rw.MyVal14;
          DWTRrw.MyVal15 = DWTRrw.MyVal15 + DWTR2rw.MyVal15;
          DWTRrw.MyVal16 = DWTRrw.MyVal16 + DWTR2rw.MyVal16;
          DWTRrw.MyVal17 = DWTRrw.MyVal17 + DWTR2rw.MyVal17;
          DWTRrw.MyVal18 = DWTRrw.MyVal18 + DWTR2rw.MyVal18;
          MatRowPut(DWTR2r,j,DWTRrw);
					MatRowDelete(DWTR2r,i);
					i = i - 1;
					rwcnt2 = rwcnt2 - 1;
				end;
			end;
		end;
		rwcnt = MatRowCnt(DWTRr);
		for (i=0;i<rwcnt2;i=i+1) begin
			MatRowGet(DWTR2r,i,DWTRrw);
      Clearrow(DWTRr,DWTR2rw,1);
			DWTR2rw.NomVal = DWTRrw.NomVal;
      DWTR2rw.MyVal10 = DWTRrw.MyVal10;
      DWTR2rw.MyVal11 = DWTRrw.MyVal11;
      DWTR2rw.MyVal12 = DWTRrw.MyVal12;
			DWTR2rw.CredVal2 = DWTRrw.CredVal2;
			DWTR2rw.DebVal2 = DWTRrw.DebVal2;
			DWTR2rw.Qty = DWTRrw.Qty;
			DWTR2rw.DebVal = DWTRrw.DebVal;
      DWTR2rw.MyVal5 = DWTRrw.MyVal5;
      DWTR2rw.MyVal13 = DWTRrw.MyVal13;
      DWTR2rw.MyVal14 = DWTRrw.MyVal14;
      DWTR2rw.MyVal15 = DWTRrw.MyVal15;
      DWTR2rw.MyVal1 = DWTRrw.MyVal1;
      DWTR2rw.MyVal3 = DWTRrw.MyVal3;
      DWTR2rw.MyVal4 = DWTRrw.MyVal4;
      DWTR2rw.MyVal2 = DWTRrw.MyVal2;
      DWTR2rw.MyVal16 = DWTRrw.MyVal16;
      DWTR2rw.MyVal17 = DWTRrw.MyVal17;
      DWTR2rw.MyVal18 = DWTRrw.MyVal18;
			DWTR2rw.Comment = "СЧ/КЛ.";
			DWTR2rw.ReconDate = DWTRrw.ReconDate;
			DWTR2rw.Curncy = "IVV";
			MatRowPut(DWTRr,rwcnt + i,DWTR2rw);
		end;
	end;
	rwcnt = MatRowCnt(DWTRr);
	for (j=0;j<rwcnt-1;j=j+1) begin
		for (i=0;i<rwcnt-1;i=i+1) begin
			MatRowGet(DWTRr,i,DWTRrw);
			MatRowGet(DWTRr,i+1,DWTR2rw);
			if (DWTRrw.ReconDate > DWTR2rw.ReconDate) then begin
				MatRowPut(DWTRr,i,DWTR2rw);
				MatRowPut(DWTRr,i+1,DWTRrw);
			end;
		end;
	end;
  v["AZNTermDeb"] = 0;
	v["AZNTermCred"] = 0;
	v["AZNDeb"] = 0;
	v["AZNCred"] = 0;
	v["EURDeb"] = 0;
	v["EURCred"] = 0;
	v["USDDeb"] = 0;
	v["USDCred"] = 0;
	v["GBPDeb"] = 0;
	v["CHFDeb"] = 0;
	v["GBPCred"] = 0;
	v["CHFCred"] = 0;
	v["BaseDeb"] = 0;
	v["BaseCred"] = 0;
	
  tabprintf[10] = true;
  tabprintf[360] = true;
  tabprintf[370] = true;
  /*if ((CurrentCompany==1) or (CurrentCompany==2) or (CurrentCompany==4) or (CurrentCompany==5) or // Edit ************************** BPI Ukraine - KramarAlexandr - 04, 30 05 2019 y. at 4:47:03 PM
      (CurrentCompany==6) or (CurrentCompany==7) or (CurrentCompany==8) or (CurrentCompany==11) or
      (CurrentCompany==12) or (CurrentCompany==16) or (CurrentCompany==25)) then begin
    tabprintf[120] = false;
    tabprintf[230] = false;
    tabprintf[240] = false;
    tabprintf[350] = false;
  end;*/
  j = 0;
  for (i=10;i<=370;i=i+1) begin
    if (tabprintf[i]) then begin j = j + 1; end;
  end;
  step = Round((480/(j+1)),rnd);
  tab[10]  = 0;
  j = 1;
  for (i=20;i<=370;i=i+1) begin
    if (tabprintf[i]) then begin
      tab[i] = tab[j] + step;
      j = i;
    end;
  end;
	
	StartReportNoHeaderJob("Еженедельный отчет директоров");
		StartFormat(15);
			OutString(0,0,"",false);
			if nonblank(RepSpec.ObjStr) then begin
				Objr.Code = RepSpec.ObjStr;
				ReadFirstMain(Objr,1,true);
				OutString(15,0,Objr.Code & " " & Objr.Comment,false);
			end else begin
				blockload(Compb);
				matrowget(Compb,currentcompany-1,Comprw);
				OutString(15,0,Comprw.CompName,false);
			end;
			OutString(120,0,"",false);
			OutString(130,0,"",false);
			OutString(140,0,"",false);
			OutString(150,0,"",false);
			OutString(265,0,RepSpec.sStartDate & " : " & RepSpec.sEndDate,false);
		EndFormat;
		StartFormat(15);
		EndFormat;
		
		
		//========================================== BeginBalance51
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="USD" then begin
				FindNLAccBal("51",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51USD"] = v["BeginBalance51USD"] + tempBal;
				FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51USD"] = v["BeginBalance51USD"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="CHF" then begin
				FindNLAccBal("51",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51CHF"] = v["BeginBalance51CHF"] + tempBal;
				FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51CHF"] = v["BeginBalance51CHF"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="GBP" then begin
				FindNLAccBal("51",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51GBP"] = v["BeginBalance51GBP"] + tempBal;
				FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51GBP"] = v["BeginBalance51GBP"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="EUR" then begin
				FindNLAccBal("51",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51EUR"] = v["BeginBalance51EUR"] + tempBal;
				FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51EUR"] = v["BeginBalance51EUR"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="AZN" then begin
				FindNLAccBal("51",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51AZN"] = v["BeginBalance51AZN"] + tempBal;
				FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance51AZN"] = v["BeginBalance51AZN"] + tempBal;
			end;
		end;
		
    tempBal = 0;
		FindNLAccBal("51",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
    v["BeginBalance51"] = tempBal;
    FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
    v["BeginBalance51"] = v["BeginBalance51"] + tempBal;
    v["BeginBalance51/2"] = v["BeginBalance51/2"] + tempBal;
    
    tempBal = 0;
    FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,"",0,"","",tempBal);
    v["SaldoEndPeriod51/2"] = tempBal;
    //========================================== BeginBalance50
    
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="USD" then begin
				FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance50USD"] = v["BeginBalance50USD"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="EUR" then begin
				FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance50EUR"] = v["BeginBalance50EUR"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="AZN" then begin
				FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance50AZN"] = v["BeginBalance50AZN"] + tempBal;
			end;
		end;
    tempBal = 0;
		FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
    v["BeginBalance50"] = tempBal;
		
		//========================================== BeginBalance53
		if(RepSpec.sEndDate>=stringtodate("01/01/2018") or CompanyIsJWLikeCompany1(currentcompany))then begin
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="USD" then begin
					FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["BeginBalance53USD"] = v["BeginBalance53USD"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="CHF" then begin
					FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["BeginBalance53CHF"] = v["BeginBalance53CHF"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="EUR" then begin
					FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["BeginBalance53EUR"] = v["BeginBalance53EUR"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="AZN" then begin
					FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["BeginBalance53AZN"] = v["BeginBalance53AZN"] + tempBal;
				end;
			end;
			tempBal = 0;
			FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
			v["BeginBalance53"] = tempBal;
    end;
    //========================================== BeginBalance59/2
    
    if(RepSpec.sStartDate>=StringToDate("1/1/2018"))then begin
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="USD" then begin
					FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["BeginBalance59/2USD"] = v["BeginBalance59/2USD"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="CHF" then begin
					FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["BeginBalance59/2CHF"] = v["BeginBalance59/2CHF"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="EUR" then begin
					FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["BeginBalance59/2EUR"] = v["BeginBalance59/2EUR"] + tempBal;
				end;
			end;
		
			tempBal = 0;
			FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
			v["BeginBalance59/2"] = tempBal;
    end;
    
		v["BeginBalance50n51"] = v["BeginBalance50"] + v["BeginBalance51"];
		v["BeginBalance50n51n53"] = v["BeginBalance50n51"];
    v["BeginBalance50n53USD"] = v["BeginBalance50USD"];
    v["BeginBalance50n53EUR"] = v["BeginBalance50EUR"];
    v["BeginBalance50n53AZN"] = v["BeginBalance50AZN"];
    if (jewlf or (njewlf and RepSpec.sStartDate>=StringToDate("1/1/2018"))) and (!cretivef) then begin
      v["BeginBalance50n51n53"] = v["BeginBalance50n51n53"] + v["BeginBalance53"];
      v["BeginBalance50n53USD"] = v["BeginBalance50n53USD"] + v["BeginBalance53USD"];
      v["BeginBalance50n53EUR"] = v["BeginBalance50n53EUR"] + v["BeginBalance53EUR"];
      v["BeginBalance50n53AZN"] = v["BeginBalance50n53AZN"] + v["BeginBalance53AZN"];
      
    end;
   /// v["BeginBalance50n51n53"] = v["BeginBalance50n51n53"] + v["BeginBalance59/2"];
   
   //Хеадер Остаток На
      
   
		StartFormat(15);
		if (!cretivef) then begin
		//Остаток на...
			OutString(0,0,"Остаток на " & RepSpec.sStartDate & ":",false);
			EndFormat;	
			
			//******************************************		Balance52
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="USD" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52USD"] = v["Balance52USD"] + tempBal;
					v["BeginBalance52USD"] = v["BeginBalance52USD"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52USD"] = v["Balance52USD"] + tempBal;
					v["BeginBalance52USD"] = v["BeginBalance52USD"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="GBP" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52GBP"] = v["Balance52GBP"] + tempBal;
					v["BeginBalance52GBP"] = v["BeginBalance52GBP"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52GBP"] = v["Balance52GBP"] + tempBal;
					v["BeginBalance52GBP"] = v["BeginBalance52GBP"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="CHF" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52CHF"] = v["Balance52CHF"] + tempBal;
					v["BeginBalance52CHF"] = v["BeginBalance52CHF"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52CHF"] = v["Balance52CHF"] + tempBal;
					v["BeginBalance52CHF"] = v["BeginBalance52CHF"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="EUR" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52EUR"] = v["Balance52EUR"] + tempBal;
					v["BeginBalance52EUR"] = v["BeginBalance52EUR"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52EUR"] = v["Balance52EUR"] + tempBal;
					v["BeginBalance52EUR"] = v["BeginBalance52EUR"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="AZN" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52AZN"] = v["Balance52AZN"] + tempBal;
					v["BeginBalance52AZN"] = v["BeginBalance52AZN"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52AZN"] = v["Balance52AZN"] + tempBal;
					v["BeginBalance52AZN"] = v["BeginBalance52AZN"] + tempBal;
				end;
			end;
			tempBal = 0;
			FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
			v["Balance52"] = tempBal;
			v["BeginBalance52"] = tempBal;
			FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
			v["Balance52"] = v["Balance52"] + tempBal;
			v["BeginBalance52"] = v["BeginBalance52"] + tempBal;
			
			PrintHeaderStartPeriod50(v,RepSpec);//Остаток по расчетному счету в валюте: --Наличная касса (50 счет)
			PrintHeaderStartPeriod5152(v,RepSpec);//Банк локальный в валюте: --Банк локальный (51+52 счета)
			//PrintHeaderStartPeriod52(v,RepSpec);//Остаток по расчетному счету в валюте:
			if(RepSpec.sStartDate>=StringToDate("1/1/2018"))then begin
				PrintHeaderStartPeriodID(v,RepSpec);//ID счет:59/2--ID счет (59/2 счет)
			end;
			//PrintHeaderStartPeriodMainAcc(v,RepSpec); //Остаток общего счета
			if (jewlf or (njewlf and RepSpec.sStartDate>=StringToDate("1/1/2018"))) and (!cretivef) then begin
				PrintHeaderStartPeriodInOffice(v,RepSpec); //Деньги в офисе--Деньги в офисе (53 счет)
			end;
			PrintHeaderStartPeriodByCurSt(v,RepSpec);// Остаток на ... по валютам:
		//Остаток на... по валютам
			
		end else begin
			if ((v["BeginBalance50AZN"]!=0) or (v["BeginBalance51"]!=0)) then begin
				StartFormat(15);
					OutString(0,0,"Остаток на " & RepSpec.sStartDate & " по валютам:",false);
				EndFormat;
				if (v["BeginBalance50AZN"]!=0) then begin
					StartFormat(15);
						OutString(0,0,"",false);
						OutString(15,0,"",false);
						OutString(60,0,v["BeginBalance50AZN"],false);
						OutString(90,0,"AZN",false);
					EndFormat;
				end;
				if (v["BeginBalance51"]!=0) then begin
					StartFormat(15);
						OutString(0,0,"",false);
						OutString(15,0,"",false);
						OutString(60,0,v["BeginBalance51"],false);
						OutString(90,0,"AZN банк",false);
					EndFormat;
				end;
				StartFormat(15);
				EndFormat;
			end;
		end;
		Black_Divider(0,1);
	//Шапка таблицы
  /*tab[10]  -              Дата
    tab[20]  - Поступления:       AZN банк
    tab[30]  - Поступления:       AZN банк
    tab[40]  - Поступления:       EUR банк
    tab[50]  - Поступления:       USD банк
    tab[51]  - Поступления:       GBP банк// Edit ************************** BPI Ukraine - KramarAlexandr - Monday, 3 September 2018 13:02:47
    tab[52]  - Поступления:       CHF банк// Edit ************************** BPI Ukraine - KramarAlexandr - Monday, 3 September 2018 13:02:47
    tab[60]  - Поступления:       AZN
    tab[70]  - Поступления:       EUR
    tab[80]  - Поступления:       USD
    tab[90]  - Поступления:       AZN офис
    tab[100] - Поступления:       EUR офис
    tab[110] - Поступления:       USD офис
    tab[111] - Поступления:       EUR ID
    tab[112] - Поступления:       USD ID
    tab[113] - Поступления:       CHF ID
    tab[120] - Поступления:       В осн. валюте
    tab[130] - Конвертация/банк:  AZN банк
    tab[140] - Конвертация/банк:  AZN банк
    tab[150] - Конвертация/банк:  EUR банк
    tab[160] - Конвертация/банк:  USD банк
    tab[161] - Конвертация/банк:  GBP банк// Edit ************************** BPI Ukraine - KramarAlexandr - Monday, 3 September 2018 13:03:04
    tab[162] - Конвертация/банк:  CHF банк// Edit ************************** BPI Ukraine - KramarAlexandr - Monday, 3 September 2018 13:03:04
    tab[170] - Конвертация/банк:  AZN
    tab[180] - Конвертация/банк:  EUR
    tab[190] - Конвертация/банк:  USD
    tab[200] - Конвертация/банк:  AZN офис
    tab[210] - Конвертация/банк:  EUR офис
    tab[220] - Конвертация/банк:  USD офис
    tab[221] - Конвертация/банк:  EUR ID
    tab[222] - Конвертация/банк:  USD ID
    tab[223] - Конвертация/банк:  CHF ID
    tab[230] - Конвертация/банк:  В осн. валюте
    tab[240] -              Курсовая
    tab[250] - Расходы:           AZN банк
    tab[260] - Расходы:           AZN банк
    tab[270] - Расходы:           EUR банк
    tab[280] - Расходы:           USD банк
    tab[281] - Расходы:           GBP банк// Edit ************************** BPI Ukraine - KramarAlexandr - Monday, 3 September 2018 13:07:23
    tab[282] - Расходы:           CHF банк// Edit ************************** BPI Ukraine - KramarAlexandr - Monday, 3 September 2018 13:07:23
    tab[290] - Расходы:           AZN
    tab[300] - Расходы:           EUR
    tab[310] - Расходы:           USD
    tab[320] - Расходы:           AZN офис
    tab[330] - Расходы:           EUR офис
    tab[340] - Расходы:           USD офис
    tab[341] - Расходы:       		EUR ID
    tab[342] - Расходы:       		USD ID
    tab[343] - Расходы:       		CHF ID
    tab[350] - Расходы:           В осн. валюте
    tab[360] - Примечание:        Докум.
    tab[370] - Примечание:        Коммент.
    
    headtab[10] - Поступления
    headtab[20] - Конвертация/банк
    headtab[30] - Расходы
    headtab[40] - Примечание
    headtab[50],headtab[60]  - Divider Поступления
    headtab[70],headtab[80]  - Divider Конвертация/банк
    headtab[90],headtab[100] - Divider Расходы*/
//---------------------------------------------------------------------------------------------------------------------------------------------
    StartFormat(15);
      OutString(tab[10],0,"Дата",false);
      j = 0;
      k = 0;
      f = false;
      for (i=2;i<13;i=i+1) begin
        if (tabprintf[i]) then begin
          f = true;
          i = 130;
        end;
      end;
      if (f) then begin
        for (i=20;i<130;i=i+1) begin
          if (tabprintf[i]) then begin
            k = i;
            i = 130;
          end;
        end;
        for (i=130;i<380;i=i+1) begin
          if (tabprintf[i]) then begin
            j = i;
            i = 380;
          end;
        end;
        headtab[10] = tab[k] + (tab[j]-tab[k])/2;
        headtab[50] = tab[k];
        headtab[60] = tab[j] - 3;
        if (RepSpec.Media==mtExcel) then begin
          j = 0;
          for (i=20;i<130;i=i+1) begin
            if (tabprintf[i]) then begin
              j = j + 1;
            end;
          end;
          for (i=0;i<Round((j-1)/2,rnd);i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
        OutStringCut(headtab[10]-12,headtab[10]+12,0,"Поступления",true,0);
        if (RepSpec.Media==mtExcel) then begin
          for (i=0;i<(j-1-Round((j-1)/2,rnd));i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
      end;
        //OutStringCut(integer x, integer y,
        //			   integer und, string str,
        //			   boolean bool, integer ovst)
        //x    - начальная координата ячейки, в которую печатается
        //y    - конечная координата ячейки
        //und  - подчеркивание: 0 - нет / !=0 - да
        //str  - строка для вывода
        //bool - перенос ?
        //ovst - зачеркивание: 0-нет / !=0-да
      j = 0;
      k = 0;
      f = false;
      for (i=130;i<240;i=i+1) begin
        if (tabprintf[i]) then begin
          f = true;
          i = 240;
        end;
      end;
      if (f) then begin
        for (i=130;i<240;i=i+1) begin
          if (tabprintf[i]) then begin
            k = i;
            i = 240;
          end;
        end;
        for (i=240;i<370;i=i+1) begin
          if (tabprintf[i]) then begin
            j = i;
            i = 370;
          end;
        end;
        headtab[20] = tab[k] + (tab[j]-tab[k])/2;
        headtab[70] = tab[k] + 3;
        headtab[80] = tab[j] - 3;
        if (RepSpec.Media==mtExcel) then begin
          j = 0;
          for (i=130;i<240;i=i+1) begin
            if (tabprintf[i]) then begin
              j = j + 1;
            end;
          end;
          for (i=0;i<Round((j-1)/2,rnd);i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
        OutStringCut(headtab[20]-13,headtab[20]+13,0,"Конвертация/банк",true,0);
        if (RepSpec.Media==mtExcel) then begin
          for (i=0;i<(j-1-Round((j-1)/2,rnd));i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
      end;
      j = 0;
      k = 0;
      f = false;
      for (i=250;i<360;i=i+1) begin
        if (tabprintf[i]) then begin
          f = true;
          i = 360;
        end;
      end;
      if (f) then begin
        for (i=250;i<360;i=i+1) begin
          if (tabprintf[i]) then begin
            k = i;
            i = 360;
          end;
        end;
        j = 360;
        headtab[30] = tab[k] + (tab[j]-tab[k])/2;
        headtab[90] = tab[k] + 3;
        headtab[100] = tab[j] - 3;
        if (RepSpec.Media==mtExcel) then begin
          j = 0;
          for (i=250;i<360;i=i+1) begin
            if (tabprintf[i]) then begin
              j = j + 1;
            end;
          end;
          for (i=0;i<(Round((j-1)/2,rnd)+1);i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
        OutStringCut(headtab[30]-12,headtab[30]+12,0,"Расходы",true,0);
        if (RepSpec.Media==mtExcel) then begin
          for (i=0;i<(j-1-Round((j-1)/2,rnd));i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
      end;
      headtab[40] = tab[360] + (480-tab[360])/2;
      OutStringCut(headtab[40]-12,headtab[40]+12,0,"Примечание",false,0);
    EndFormat;

    if (headtab[10]!=0) then begin Black_Divider(headtab[50],headtab[60]); end;
    if (headtab[20]!=0) then begin Black_Divider(headtab[70],headtab[80]); end;
    if (headtab[30]!=0) then begin Black_Divider(headtab[90],headtab[100]); end;
    if (headtab[40]!=0) then begin Black_Divider(tab[360]+3,480); end;
		StartFormat(15);
			if (tabprintf[10]) then begin
				OutString(tab[10],0,"",false);
			end;
      if (tabprintf[20]) then begin
      	OutString(tab[20],0,"AZN банк",false);
      end;
      if (tabprintf[30]) then begin
      	OutString(tab[30],0,"AZN банк",false);
      end;
      if (tabprintf[40]) then begin
      	OutString(tab[40],0,"EUR банк",false);
      end;
      if (tabprintf[50]) then begin
      	OutString(tab[50],0,"USD банк",false);
      end;
      if (tabprintf[51]) then begin
      	OutString(tab[51],0,"GBP банк",false);
      end;
      if (tabprintf[52]) then begin
      	OutString(tab[52],0,"CHF банк",false);
      end;
      if (tabprintf[60]) then begin
      	OutString(tab[60],0,"AZN",false); 
      end;
      if (tabprintf[70]) then begin
      	OutString(tab[70],0,"EUR",false);
      end;
      if (tabprintf[80]) then begin
      	OutString(tab[80],0,"USD",false);
      end;
      if (tabprintf[90]) then begin
      	OutString(tab[90],0,"AZN офис",false); 
      end;
      if (tabprintf[100]) then begin
      	OutString(tab[100],0,"EUR офис",false);
      end;
      if (tabprintf[110]) then begin
      	OutString(tab[110],0,"USD офис",false);
      end;
      if (tabprintf[111]) then begin
      	OutString(tab[111],0,"EUR ID",false);
      end;
      if (tabprintf[112]) then begin
      	OutString(tab[112],0,"USD ID",false);
      end;
      if (tabprintf[113]) then begin
      	OutString(tab[113],0,"CHF ID",false);
      end;
      if (tabprintf[120]) then begin
      	OutString(tab[120],0,"В осн. валюте",false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutString(tab[120]+25,0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
      end;
      if (tabprintf[130]) then begin
      	OutString(tab[130],0,"AZN банк",false);
      end;
      if (tabprintf[140]) then begin
      	OutString(tab[140],0,"AZN банк",false);
      end;
      if (tabprintf[150]) then begin
      	OutString(tab[150],0,"EUR банк",false);
      end;
      if (tabprintf[160]) then begin
      	OutString(tab[160],0,"USD банк",false);
      end;
      if (tabprintf[161]) then begin
      	OutString(tab[161],0,"GBP банк",false);
      end;
      if (tabprintf[162]) then begin
      	OutString(tab[162],0,"CHF банк",false);
      end;
      if (tabprintf[170]) then begin
      	OutString(tab[170],0,"AZN",false);
      end;
      if (tabprintf[180]) then begin
      	OutString(tab[180],0,"EUR",false);
      end;
      if (tabprintf[190]) then begin
      	OutString(tab[190],0,"USD",false);
      end;
      if (tabprintf[200]) then begin
      	OutString(tab[200],0,"AZN офис",false); 
      end;
      if (tabprintf[210]) then begin
      	OutString(tab[210],0,"EUR офис",false);
      end;
      if (tabprintf[220]) then begin
      	OutString(tab[220],0,"USD офис",false);
      end;
      if (tabprintf[221]) then begin
      	OutString(tab[221],0,"EUR ID",false);
      end;
      if (tabprintf[222]) then begin
      	OutString(tab[222],0,"USD ID",false);
      end;
      if (tabprintf[223]) then begin
      	OutString(tab[223],0,"CHF ID",false);
      end;
      if (tabprintf[230]) then begin
      	OutString(tab[230],0,"В осн. валюте",false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutString(tab[230]+25,0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
      end;
			if (tabprintf[240]) then begin
				OutString(tab[240],0,"Курсовая",false);
			end;
      if (tabprintf[250]) then begin
      	OutString(tab[250],0,"AZN банк",false);
      end;
      if (tabprintf[260]) then begin
      	OutString(tab[260],0,"AZN банк",false);
      end;
      if (tabprintf[270]) then begin
      	OutString(tab[270],0,"EUR банк",false);
      end;
      if (tabprintf[280]) then begin
      	OutString(tab[280],0,"USD банк",false);
      end;
      if (tabprintf[281]) then begin
      	OutString(tab[281],0,"GBP банк",false);
      end;
      if (tabprintf[282]) then begin
      	OutString(tab[282],0,"CHF банк",false);
      end;
      if (tabprintf[290]) then begin
      	OutString(tab[290],0,"AZN",false);
      end;
      if (tabprintf[300]) then begin
      	OutString(tab[300],0,"EUR",false);
      end;
      if (tabprintf[310]) then begin
      	OutString(tab[310],0,"USD",false);
      end;
      if (tabprintf[320]) then begin
      	OutString(tab[320],0,"AZN офис",false); 
      end;
      if (tabprintf[330]) then begin
      	OutString(tab[330],0,"EUR офис",false);
      end;
      if (tabprintf[340]) then begin
      	OutString(tab[340],0,"USD офис",false);
      end;
      if (tabprintf[341]) then begin
      	OutString(tab[341],0,"EUR ID",false);
      end;
      if (tabprintf[342]) then begin
      	OutString(tab[342],0,"USD ID",false);
      end;
      if (tabprintf[343]) then begin
      	OutString(tab[343],0,"CHF ID",false);
      end;
      if (tabprintf[350]) then begin
      	OutString(tab[350],0,"В осн. валюте",false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutString(tab[350]+25,0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
      end;
			if (tabprintf[360]) then begin
				OutString(tab[360],0,"Докум.",false);
			end;
			if (tabprintf[370]) then begin
				OutString(tab[370],0,"Коммент.",false);
			end;
		EndFormat;

		rwcnt = MatRowCnt(DWTRr);
		for (i=0;i<rwcnt;i=i+1) begin
			MatRowGet(DWTRr,i,DWTRrw);
			if (DWTRrw.ReconDate <> tempDate) then begin
				tempDate = DWTRrw.ReconDate;
				Black_Divider(0,1);
        StartFormat(15);
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,tempDate,false);
          end;
        if (!cretivef) then begin
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
          	OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
          	OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
          	OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
          	OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          if (tabprintf[112]) then begin
          	OutString(tab[112],0,"",false);
          end;
          tempStr = "EUR";
          GetFullCurncyRate(tempStr,tempDate,fr,to1EUR,to2,br1,br2);
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,"EUR: " & ValToMyString(to1EUR,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[120]+25,0,"",false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
          	OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
          	OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
          	OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
          	OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
          	OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,"",false);
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
          	OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,"EUR: " & ValToMyString(to1EUR,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[230]+25,0,"",false);
            end;
          end;
          if (tabprintf[240]) then begin
          	OutString(tab[240],0,"",false);
          end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
          	OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
          	OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
          	OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,"EUR: " & ValToMyString(to1EUR,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[350]+25,0,"",false);
            end;
          end;
          if (tabprintf[360]) then begin
          	OutString(tab[360],0,"",false);
          end;
          if (tabprintf[370]) then begin
          	OutString(tab[370],0,"Курс на " & tempDate,false);
          end;          
        EndFormat;
        Gray_Divider(0,1);
        StartFormat(15);
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
          	OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
          	OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
          	OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
          	OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          tempStr = "USD";
          GetFullCurncyRate(tempStr,tempDate,fr,to1USD,to2,br1,br2);
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,"USD: " & ValToMyString(to1USD,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[120]+25,0,"",false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
          	OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
          	OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
          	OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
          	OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
          	OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,"",false);
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
          	OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,"USD: " & ValToMyString(to1USD,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[230]+25,0,"",false);
            end;
          end;
          if (tabprintf[240]) then begin
          	OutString(tab[240],0,"",false);
          end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
          	OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
          	OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
          	OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,"USD: " & ValToMyString(to1USD,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[350]+25,0,"",false);
            end;
          end;
          if (tabprintf[360]) then begin
          	OutString(tab[360],0,"",false);
          end;
          if (tabprintf[370]) then begin
          	OutString(tab[370],0,"Курс на " & tempDate,false);
          end;
        EndFormat;
        Gray_Divider(0,1);
        StartFormat(15);
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
          	OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
          	OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
          	OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
          	OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          tempStr = "GBP";
          GetFullCurncyRate(tempStr,tempDate,fr,to1GBP,to2,br1,br2);
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,"GBP: " & ValToMyString(to1GBP,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[120]+25,0,"",false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
          	OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
          	OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
          	OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
          	OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
          	OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,"",false);
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
          	OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,"GBP: " & ValToMyString(to1GBP,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[230]+25,0,"",false);
            end;
          end;
          if (tabprintf[240]) then begin
          	OutString(tab[240],0,"",false);
          end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
          	OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
          	OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
          	OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,"GBP: " & ValToMyString(to1GBP,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[350]+25,0,"",false);
            end;
          end;
          if (tabprintf[360]) then begin
          	OutString(tab[360],0,"",false);
          end;
          if (tabprintf[370]) then begin
          	OutString(tab[370],0,"Курс на " & tempDate,false);
          end;
        EndFormat;
        Gray_Divider(0,1);
        StartFormat(15);
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
          	OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
          	OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
          	OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
          	OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          tempStr = "CHF";
          GetFullCurncyRate(tempStr,tempDate,fr,to1CHF,to2,br1,br2);
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,"CHF: " & ValToMyString(to1CHF,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[120]+25,0,"",false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
          	OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
          	OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
          	OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
          	OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
          	OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,"",false);
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
          	OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,"CHF: " & ValToMyString(to1CHF,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[230]+25,0,"",false);
            end;
          end;
          if (tabprintf[240]) then begin
          	OutString(tab[240],0,"",false);
          end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
          	OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
          	OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
          	OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,"CHF: " & ValToMyString(to1CHF,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[350]+25,0,"",false);
            end;
          end;
          if (tabprintf[360]) then begin
          	OutString(tab[360],0,"",false);
          end;
          if (tabprintf[370]) then begin
          	OutString(tab[370],0,"Курс на " & tempDate,false);
          end;
        EndFormat;
        Gray_Divider(0,1);
        StartFormat(15);
          if (tabprintf[10]) then begin
            OutString(tab[10],0,"",false);
          end;
        end;
			end else begin
				Gray_Divider(0,1);
				StartFormat(15);
					if (tabprintf[10]) then begin
						OutString(tab[10],0,"",false);
					end;
			end;
			switch (DWTRrw.Curncy) begin
				case "AZN":
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,DWTRrw.MyVal7,false);
            v["AZN52Deb"] = v["AZN52Deb"] + DWTRrw.MyVal7;
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[40]) then begin
          	OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
          	OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
          	OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
          	OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,DWTRrw.CurDebVal,false);
            v["AZNDeb"] = v["AZNDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,DWTRrw.MyVal16,false);
            v["AZN53Deb"] = v["AZN53Deb"] + DWTRrw.MyVal16;
            if (DWTRrw.MyVal16!=blankval) then begin
              v["Base53Deb"] = v["Base53Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          if (tabprintf[112]) then begin
          	OutString(tab[112],0,"",false);
          end;
          if (tabprintf[113]) then begin
          	OutString(tab[113],0,"",false);
          end;
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[120]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
          	OutString(tab[140],0,DWTRrw.MyVal8,false);
            v["AZN52Conv"] = v["AZN52Conv"] + DWTRrw.MyVal8;
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[150]) then begin
          	OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
          	OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
          	OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
          	OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,DWTRrw.MyVal1,false); 
            v["convtotal2"] = v["convtotal2"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,DWTRrw.MyVal18,false); 
            v["conv53AZN"] = v["conv53AZN"] + DWTRrw.MyVal18;
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
          	OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[230]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[240]) then begin
						OutString(tab[240],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
          	OutString(tab[260],0,DWTRrw.MyVal9,false);
            v["AZN52Cred"] = v["AZN52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[270]) then begin
          	OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
          	OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,DWTRrw.CurCredVal,false);
            v["AZNCred"] = v["AZNCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,DWTRrw.MyVal17,false);
            v["AZN53Cred"] = v["AZN53Cred"] + DWTRrw.MyVal17;
            if (DWTRrw.MyVal17!=blankval) then begin
              v["Base53Cred"] = v["Base53Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[350]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "EUR":
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
          	OutString(tab[40],0,DWTRrw.MyVal7,false);
            v["EUR52Deb"] = v["EUR52Deb"] + DWTRrw.MyVal7;
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[50]) then begin
          	OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
          	OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
          	OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,DWTRrw.CurDebVal,false);
            v["EURDeb"] = v["EURDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,DWTRrw.MyVal16,false);
            v["EUR53Deb"] = v["EUR53Deb"] + DWTRrw.MyVal16;
            if (DWTRrw.MyVal16!=blankval) then begin
              v["Base53Deb"] = v["Base53Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,DWTRrw.MyVal42,false);
            v["EUR59/2Deb"] = v["EUR59/2Deb"] + DWTRrw.MyVal42;
            if (DWTRrw.MyVal42!=blankval) then begin
              v["Base59/2Deb"] = v["Base59/2Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[112]) then begin
          	OutString(tab[112],0,"",false);
          end;
          if (tabprintf[113]) then begin
          	OutString(tab[113],0,"",false);
          end;
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[120]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
          	OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
          	OutString(tab[150],0,DWTRrw.MyVal8,false);
            v["EUR52Conv"] = v["EUR52Conv"] + DWTRrw.MyVal8;
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[160]) then begin
          	OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
          	OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
          	OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,DWTRrw.MyVal1,false);
            v["convtotal3"] = v["convtotal3"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,"",false); 
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,DWTRrw.MyVal18,false);
            v["conv53EUR"] = v["conv53EUR"] + DWTRrw.MyVal18;
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
          	OutString(tab[221],0,DWTRrw.MyVal43,false);
            v["conv59/2EUR"] = v["conv59/2EUR"] + DWTRrw.MyVal43;
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[230]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[240]) then begin
						OutString(tab[240],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
          	OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
          	OutString(tab[270],0,DWTRrw.MyVal9,false);
            v["EUR52Cred"] = v["EUR52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[280]) then begin
          	OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,DWTRrw.CurCredVal,false);
            v["EURCred"] = v["EURCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,DWTRrw.MyVal17,false);
            v["EUR53Cred"] = v["EUR53Cred"] + DWTRrw.MyVal17;
            if (DWTRrw.MyVal17!=blankval) then begin
              v["Base53Cred"] = v["Base53Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,DWTRrw.MyVal44,false);
            v["EUR59/2Cred"] = v["EUR59/2Cred"] + DWTRrw.MyVal44;
            if (DWTRrw.MyVal44!=blankval) then begin
              v["Base59/2Cred"] = v["Base59/2Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[350]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "USD":
          if (tabprintf[20]) then begin
            OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
            OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
            OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
            OutString(tab[50],0,DWTRrw.MyVal7,false);
            v["USD52Deb"] = v["USD52Deb"] + DWTRrw.MyVal7;
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[51]) then begin
            OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
            OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
            OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
            OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
            OutString(tab[80],0,DWTRrw.CurDebVal,false);
            v["USDDeb"] = v["USDDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[90]) then begin
            OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
            OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
            OutString(tab[110],0,DWTRrw.MyVal16,false);
            v["USD53Deb"] = v["USD53Deb"] + DWTRrw.MyVal16;
            if (DWTRrw.MyVal16!=blankval) then begin
              v["Base53Deb"] = v["Base53Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[111]) then begin
            OutString(tab[111],0,"",false);
          end;
          if (tabprintf[112]) then begin
            OutString(tab[112],0,DWTRrw.MyVal42,false);
            v["USD59/2Deb"] = v["USD59/2Deb"] + DWTRrw.MyVal42;
            if (DWTRrw.MyVal42!=blankval) then begin
              v["Base59/2Deb"] = v["Base59/2Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[113]) then begin
            OutString(tab[113],0,"",false);
          end;
          if (tabprintf[120]) then begin
            OutString(tab[120],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[120]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[130]) then begin
            OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
            OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
            OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
            OutString(tab[160],0,DWTRrw.MyVal8,false);
            v["USD52Conv"] = v["USD52Conv"] + DWTRrw.MyVal8;// Edit ************************** BPI Ukraine - KramarAlexandr - 02, 05 05 2020 y. at 2:56:45 PM
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[161]) then begin
          	OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
          	OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
            OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
            OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
            OutString(tab[190],0,DWTRrw.MyVal1,false);
            v["convtotal4"] = v["convtotal4"] + DWTRrw.MyVal1;	
          end;
          if (tabprintf[200]) then begin
            OutString(tab[200],0,"",false); 
          end;
          if (tabprintf[210]) then begin
            OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
            OutString(tab[220],0,DWTRrw.MyVal18,false);
            v["conv53USD"] = v["conv53USD"] + DWTRrw.MyVal18;
          end;
          if (tabprintf[221]) then begin
            OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
            OutString(tab[222],0,DWTRrw.MyVal43,false);
            v["conv59/2USD"] = v["conv59/2USD"] + DWTRrw.MyVal43;
          end;
          if (tabprintf[223]) then begin
            OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
            OutString(tab[230],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[230]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[240]) then begin
						OutString(tab[240],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[250]) then begin
            OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
            OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
            OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
            OutString(tab[280],0,DWTRrw.MyVal9,false);
            v["USD52Cred"] = v["USD52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
            OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
            OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
            OutString(tab[310],0,DWTRrw.CurCredVal,false);
            v["USDCred"] = v["USDCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[320]) then begin
            OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
            OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
            OutString(tab[340],0,DWTRrw.MyVal17,false);
            v["USD53Cred"] = v["USD53Cred"] + DWTRrw.MyVal17;
            if (DWTRrw.MyVal17!=blankval) then begin
              v["Base53Cred"] = v["Base53Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[341]) then begin
            OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
            OutString(tab[342],0,DWTRrw.MyVal44,false);
            v["USD59/2Cred"] = v["USD59/2Cred"] + DWTRrw.MyVal44;
            if (DWTRrw.MyVal44!=blankval) then begin
              v["Base59/2Cred"] = v["Base59/2Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[343]) then begin
            OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
            OutString(tab[350],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[350]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
        case "GBP":
          if (tabprintf[20]) then begin
            OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
            OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
            OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
            OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
            OutString(tab[51],0,DWTRrw.MyVal7,false);
            v["GBP52Deb"] = v["GBP52Deb"] + DWTRrw.MyVal7;
          end;
          if (tabprintf[52]) then begin
            OutString(tab[52],0,"",false);
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[60]) then begin
            OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
            OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
            OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
            OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
            OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
            OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
            OutString(tab[111],0,"",false);
          end;
          if (tabprintf[112]) then begin
            OutString(tab[112],0,"",false);
          end;
          if (tabprintf[113]) then begin
            OutString(tab[113],0,"",false);
          end;
          if (tabprintf[120]) then begin
            OutString(tab[120],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[120]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[130]) then begin
            OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
            OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
            OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
            OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
            OutString(tab[161],0,DWTRrw.MyVal8,false);
            v["GBP52Conv"] = v["GBP52Conv"] + DWTRrw.MyVal8;
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[162]) then begin
            OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
            OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
            OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
            OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
            OutString(tab[200],0,"",false); 
          end;
          if (tabprintf[210]) then begin
            OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
            OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
            OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
            OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
            OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
            OutString(tab[230],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[230]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[240]) then begin
						OutString(tab[240],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[250]) then begin
            OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
            OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
            OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
            OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
            OutString(tab[281],0,DWTRrw.MyVal9,false);
            v["GBP52Cred"] = v["GBP52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[282]) then begin
            OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
            OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
            OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
            OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
            OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
            OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
            OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
            OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
            OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
            OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
            OutString(tab[350],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[350]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
        case "CHF":
          if (tabprintf[20]) then begin
            OutString(tab[20],0,"",false);
          end;
          if (tabprintf[30]) then begin
            OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
            OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
            OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
            OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
            OutString(tab[52],0,DWTRrw.MyVal7,false);
            v["CHF52Deb"] = v["CHF52Deb"] + DWTRrw.MyVal7;
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[60]) then begin
            OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
            OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
            OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
            OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
            OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
            OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
            OutString(tab[111],0,"",false);
          end;
          if (tabprintf[112]) then begin
            OutString(tab[112],0,"",false);
          end;
          if (tabprintf[113]) then begin
            OutString(tab[113],0,DWTRrw.MyVal42,false);
            v["CHF59/2Deb"] = v["CHF59/2Deb"] + DWTRrw.MyVal42;
            if (DWTRrw.MyVal42!=blankval) then begin
              v["Base59/2Deb"] = v["Base59/2Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[120]) then begin
            OutString(tab[120],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[120]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[130]) then begin
            OutString(tab[130],0,"",false);
          end;
          if (tabprintf[140]) then begin
            OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
            OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
            OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
            OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
            OutString(tab[162],0,DWTRrw.MyVal8,false);
            v["CHF52Conv"] = v["CHF52Conv"] + DWTRrw.MyVal8;
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[170]) then begin
            OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
            OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
            OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
            OutString(tab[200],0,"",false); 
          end;
          if (tabprintf[210]) then begin
            OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
            OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
            OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
            OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
            OutString(tab[223],0,DWTRrw.MyVal43,false);
            v["conv59/2CHF"] = v["conv59/2CHF"] + DWTRrw.MyVal43;
          end;
          if (tabprintf[230]) then begin
            OutString(tab[230],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[230]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[240]) then begin
						OutString(tab[240],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[250]) then begin
            OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
            OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
            OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
            OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
            OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
            OutString(tab[282],0,DWTRrw.MyVal9,false);
            v["CHF52Cred"] = v["CHF52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[290]) then begin
            OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
            OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
            OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
            OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
            OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
            OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
            OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
            OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
            OutString(tab[343],0,DWTRrw.MyVal44,false);
            v["CHF59/2Cred"] = v["CHF59/2Cred"] + DWTRrw.MyVal44;
            if (DWTRrw.MyVal44!=blankval) then begin
              v["Base59/2Cred"] = v["Base59/2Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[350]) then begin
            OutString(tab[350],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[350]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "TER":
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,DWTRrw.CurDebVal,false);
            v["AZNTermDeb"] = v["AZNTermDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[30]) then begin
            OutString(tab[30],0,"",false);
          end;
          if (tabprintf[40]) then begin
            OutString(tab[40],0,"",false);
          end;
          if (tabprintf[50]) then begin
            OutString(tab[50],0,"",false);
          end;
          if (tabprintf[51]) then begin
            OutString(tab[51],0,"",false);
          end;
          if (tabprintf[52]) then begin
            OutString(tab[52],0,"",false);
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,"",false);
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,"",false);
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,"",false);
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          if (tabprintf[112]) then begin
          	OutString(tab[112],0,"",false);
          end;
          if (tabprintf[113]) then begin
          	OutString(tab[113],0,"",false);
          end;
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[120]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,DWTRrw.MyVal1,false);
            v["convtotal1"] = v["convtotal1"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[140]) then begin
            OutString(tab[140],0,"",false);
          end;
          if (tabprintf[150]) then begin
            OutString(tab[150],0,"",false);
          end;
          if (tabprintf[160]) then begin
            OutString(tab[160],0,"",false);
          end;
          if (tabprintf[161]) then begin
            OutString(tab[161],0,"",false);
          end;
          if (tabprintf[162]) then begin
            OutString(tab[162],0,"",false);
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,"",false); 
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,"",false);
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,"",false);
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,"",false); 
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
          if (tabprintf[221]) then begin
          	OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[230]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[240]) then begin
						OutString(tab[240],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,DWTRrw.CurCredVal,false);
            v["AZNTermCred"] = v["AZNTermCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[260]) then begin
            OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
            OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
            OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
            OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
            OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,"",false); 
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[350]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "IVV":
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,DWTRrw.NomVal,false);
          end;
          v["AZNTermDeb"] = v["AZNTermDeb"] + DWTRrw.NomVal;
          if (tabprintf[30]) then begin
            OutString(tab[30],0,DWTRrw.MyVal10,false);
            v["AZN52Deb"] = v["AZN52Deb"] + DWTRrw.MyVal10;
          end;
          if (tabprintf[40]) then begin
            OutString(tab[40],0,DWTRrw.MyVal11,false);
            v["EUR52Deb"] = v["EUR52Deb"] + DWTRrw.MyVal11;
          end;
          if (tabprintf[50]) then begin
            OutString(tab[50],0,DWTRrw.MyVal12,false);
            v["USD52Deb"] = v["USD52Deb"] + DWTRrw.MyVal12;
          end;
          if (tabprintf[60]) then begin
          	OutString(tab[60],0,DWTRrw.CredVal2,false);
            v["AZNDeb"] = v["AZNDeb"] + DWTRrw.CredVal2;
          end;
          if (tabprintf[70]) then begin
          	OutString(tab[70],0,DWTRrw.DebVal2,false);
            v["EURDeb"] = v["EURDeb"] + DWTRrw.DebVal2;
          end;
          if (tabprintf[80]) then begin
          	OutString(tab[80],0,DWTRrw.Qty,false);
            v["USDDeb"] = v["USDDeb"] + DWTRrw.Qty;
          end;
          if (tabprintf[90]) then begin
          	OutString(tab[90],0,"",false);
          end;
          if (tabprintf[100]) then begin
          	OutString(tab[100],0,"",false);
          end;
          if (tabprintf[110]) then begin
          	OutString(tab[110],0,"",false);
          end;
          if (tabprintf[111]) then begin
          	OutString(tab[111],0,"",false);
          end;
          if (tabprintf[112]) then begin
          	OutString(tab[112],0,"",false);
          end;
          if (tabprintf[113]) then begin
          	OutString(tab[113],0,"",false);
          end;
          if (tabprintf[120]) then begin
          	OutString(tab[120],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[120]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[130]) then begin
          	OutString(tab[130],0,DWTRrw.MyVal5,false);
            v["convtotal1"] = v["convtotal1"] + DWTRrw.MyVal5;
          end;
          if (tabprintf[140]) then begin
            OutString(tab[140],0,DWTRrw.MyVal13,false);
            v["AZN52Conv"] = v["AZN52Conv"] + DWTRrw.MyVal13;
          end;
          if (setinset("13",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          OutString(tab[150],0,"|",false);
          if (tabprintf[150]) then begin
            //OutString(tab[150],0,DWTRrw.MyVal14,false);
            OutString(tab[150],0,DWTRrw.MyVal14,false);
            v["EUR52Conv"] = v["EUR52Conv"] + DWTRrw.MyVal14;
          end;
          if (setinset("14",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[160]) then begin
            OutString(tab[160],0,DWTRrw.MyVal15,false);
            v["USD52Conv"] = v["USD52Conv"] + DWTRrw.MyVal15;
          end;
          if (tabprintf[161]) then begin
            OutString(tab[161],0,DWTRrw.MyVal15,false);
            v["GBP52Conv"] = v["GBP52Conv"] + DWTRrw.MyVal15;
          end;
          if (tabprintf[162]) then begin
            OutString(tab[162],0,DWTRrw.MyVal15,false);
            v["CHF52Conv"] = v["CHF52Conv"] + DWTRrw.MyVal15;
          end;
          if (setinset("15",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[170]) then begin
          	OutString(tab[170],0,DWTRrw.MyVal1,false); 
            v["convtotal2"] = v["convtotal2"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[180]) then begin
          	OutString(tab[180],0,DWTRrw.MyVal3,false);
            v["convtotal3"] = v["convtotal3"] + DWTRrw.MyVal3;
          end;
          if (tabprintf[190]) then begin
          	OutString(tab[190],0,DWTRrw.MyVal4,false);
            v["convtotal4"] = v["convtotal4"] + DWTRrw.MyVal4;
          end;
          if (tabprintf[200]) then begin
          	OutString(tab[200],0,"",false);
          end;
          if (tabprintf[210]) then begin
          	OutString(tab[210],0,"",false);
          end;
          if (tabprintf[220]) then begin
          	OutString(tab[220],0,"",false);
          end;
           if (tabprintf[221]) then begin
          	OutString(tab[221],0,"",false);
          end;
          if (tabprintf[222]) then begin
          	OutString(tab[222],0,"",false);
          end;
          if (tabprintf[223]) then begin
          	OutString(tab[223],0,"",false);
          end;
          if (tabprintf[230]) then begin
          	OutString(tab[230],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[230]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[240]) then begin
						OutString(tab[240],0,DWTRrw.MyVal6,false);
					end;
          if (tabprintf[250]) then begin
          	OutString(tab[250],0,"",false);
          end;
          if (tabprintf[260]) then begin
          	OutString(tab[260],0,"",false);
          end;
          if (tabprintf[270]) then begin
          	OutString(tab[270],0,"",false);
          end;
          if (tabprintf[280]) then begin
          	OutString(tab[280],0,"",false);
          end;
          if (tabprintf[281]) then begin
          	OutString(tab[281],0,"",false);
          end;
          if (tabprintf[282]) then begin
          	OutString(tab[282],0,"",false);
          end;
          if (tabprintf[290]) then begin
          	OutString(tab[290],0,"",false);
          end;
          if (tabprintf[300]) then begin
          	OutString(tab[300],0,"",false);
          end;
          if (tabprintf[310]) then begin
          	OutString(tab[310],0,"",false);
          end;
          if (tabprintf[320]) then begin
          	OutString(tab[320],0,"",false);
          end;
          if (tabprintf[330]) then begin
          	OutString(tab[330],0,"",false);
          end;
          if (tabprintf[340]) then begin
          	OutString(tab[340],0,"",false);
          end;
          if (tabprintf[341]) then begin
          	OutString(tab[341],0,"",false);
          end;
          if (tabprintf[342]) then begin
          	OutString(tab[342],0,"",false);
          end;
          if (tabprintf[343]) then begin
          	OutString(tab[343],0,"",false);
          end;
          if (tabprintf[350]) then begin
          	OutString(tab[350],0,"",false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[350]+25,0,"",false);
            end;
          end;
			end;
			v["BaseDeb"] = v["BaseDeb"] + DWTRrw.DebVal;
			v["BaseCred"] = v["BaseCred"] + DWTRrw.CredVal;
			v["convtotal5"] = v["convtotal5"] + DWTRrw.MyVal2;
			if (DWTRrw.TFromFileName=="53") then begin
				v["Base53Conv"] = v["Base53Conv"] + DWTRrw.MyVal2;
			end;
			if (DWTRrw.TFromFileName=="59/2") then begin
				v["Base59/2Conv"] = v["Base59/2Conv"] + DWTRrw.MyVal2;
				//v["convtotal5"] = v["convtotal5"] - DWTRrw.MyVal2;
			end;
			switch (FirstTransTypeInRange(DWTRrw.Comment)) begin
				case IVYc:
          if (RepSpec.ArtMode==1) then begin
            OutString(tab[360],0,DWTRrw.Comment,false);
          end else begin
            OutStringID(tab[360],"DblIVVc",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
          end;
					/*if(currentuser=="SA")then begin
						IVr.SerNr = FirstTransInRange(DWTRrw.Comment);
						if(readfirstmain(IVr,1,true))then begin
							outstring(tab[360],0,IVr.MachineName,false);
						end;
					end;*/
				case IPYc:
					OutStringID(tab[360],"DblIPVcID",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
				case CLInYc:
					OutStringID(tab[360],"DblCLInID",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
				case CLOutYc:
					OutStringID(tab[360],"DblCLOutID",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
        otherwise
          switch StringToInt(FirstInRange(DWTRrw.Comment,5)) begin
            case 300:
              OutStringID(tab[360],"DblTransServ300",FirstTransInRange(DWTRrw.Comment),false,CurrentCompany);
            otherwise
              OutStringID(tab[360],"DblTrans",DWTRrw.Comment,false,CurrentCompany);
          end;
			end;
				if (tabprintf[370]) then begin
					OutString(tab[370],0,DWTRrw.ExtraComment,false);
				end;
			EndFormat;
		end;
		//Итого
		Black_Divider(0,1)
		StartFormat(15);
			if (tabprintf[10]) then begin
				OutString(tab[10],0,"Итого",false);
			end;
      if (tabprintf[20]) then begin
      	OutString(tab[20],0,v["AZNTermDeb"],false);
      end;
      if (tabprintf[30]) then begin
      	OutString(tab[30],0,v["AZN52Deb"],false);
      end;
      if (tabprintf[40]) then begin
      	OutString(tab[40],0,v["EUR52Deb"],false);
      end;
      if (tabprintf[50]) then begin
      	OutString(tab[50],0,v["USD52Deb"],false);
      end;
      if (tabprintf[51]) then begin
      	OutString(tab[51],0,v["GBP52Deb"],false);
      end;
      if (tabprintf[52]) then begin
      	OutString(tab[52],0,v["CHF52Deb"],false);
      end;
      if (tabprintf[52]) then begin
      	OutString(tab[52],0,v["CHF52Deb"],false);
      end;
      if (tabprintf[60]) then begin
      	OutString(tab[60],0,v["AZNDeb"],false);
      end;
      if (tabprintf[70]) then begin
      	OutString(tab[70],0,v["EURDeb"],false);
      end;
      if (tabprintf[80]) then begin
      	OutString(tab[80],0,v["USDDeb"],false);
      end;
      if (tabprintf[90]) then begin
        OutString(tab[90],0,v["AZN53Deb"],false);
      end;
      if (tabprintf[100]) then begin
        OutString(tab[100],0,v["EUR53Deb"],false);
      end;
      if (tabprintf[110]) then begin
        OutString(tab[110],0,v["USD53Deb"],false);
      end;
      if (tabprintf[111]) then begin
        OutString(tab[111],0,v["EUR59/2Deb"],false);
      end;
      if (tabprintf[112]) then begin
        OutString(tab[112],0,v["USD59/2Deb"],false);
      end;
      if (tabprintf[113]) then begin
        OutString(tab[113],0,v["CHF59/2Deb"],false);
      end;
      if (tabprintf[120]) then begin
      	OutString(tab[120],0,v["BaseDeb"],false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutMyString(tab[120]+25,0,v["BaseDeb"]/RepSpec.vals0,false);
        end;
      end;
      if (tabprintf[130]) then begin
      	OutString(tab[130],0,v["convtotal1"],false); 
      end;
      if (tabprintf[140]) then begin
      	OutString(tab[140],0,v["AZN52Conv"],false);
      end;
      if (tabprintf[150]) then begin
      	OutString(tab[150],0,v["EUR52Conv"],false);
      end;
      if (tabprintf[160]) then begin
      	OutString(tab[160],0,v["USD52Conv"],false);
      end;
      if (tabprintf[161]) then begin
      	OutString(tab[161],0,v["GBP52Conv"],false);
      end;
      if (tabprintf[162]) then begin
      	OutString(tab[162],0,v["CHF52Conv"],false);
      end;
      if (tabprintf[162]) then begin
      	OutString(tab[162],0,v["CHF52Conv"],false);
      end;
      if (tabprintf[170]) then begin
      	OutString(tab[170],0,v["convtotal2"],false); 
      end;
      if (tabprintf[180]) then begin
      	OutString(tab[180],0,v["convtotal3"],false);
      end;
      if (tabprintf[190]) then begin
      	OutString(tab[190],0,v["convtotal4"],false);
      end;
      if (tabprintf[200]) then begin
      	OutString(tab[200],0,v["conv53AZN"],false);
      end;
      if (tabprintf[210]) then begin
      	OutString(tab[210],0,v["conv53EUR"],false);
      end;
      if (tabprintf[220]) then begin
      	OutString(tab[220],0,v["conv53USD"],false);
      end;
      if (tabprintf[221]) then begin
      	OutString(tab[221],0,v["conv59/2EUR"],false);
      end;
      if (tabprintf[222]) then begin
      	OutString(tab[222],0,v["conv59/2USD"],false);
      end;
      if (tabprintf[223]) then begin
      	OutString(tab[223],0,v["conv59/2CHF"],false);
      end;
      if (tabprintf[230]) then begin
      	OutString(tab[230],0,v["convtotal5"],false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutMyString(tab[230]+25,0,v["convtotal5"]/RepSpec.vals0,false);
        end;
      end;
			if (tabprintf[240]) then begin
				OutString(tab[240],0,v["kursovaya"] + v["kursovaya52"] + v["kursovaya53"],false);
			end;
      if (tabprintf[250]) then begin
      	OutString(tab[250],0,v["AZNTermCred"],false);
      end;
      if (tabprintf[260]) then begin
      	OutString(tab[260],0,v["AZN52Cred"],false);
      end;
      if (tabprintf[270]) then begin
      	OutString(tab[270],0,v["EUR52Cred"],false);
      end;
      if (tabprintf[280]) then begin
      	OutString(tab[280],0,v["USD52Cred"],false);
      end;
      if (tabprintf[281]) then begin
      	OutString(tab[281],0,v["GBP52Cred"],false);
      end;
      if (tabprintf[282]) then begin
      	OutString(tab[282],0,v["CHF52Cred"],false);
      end;
      if (tabprintf[290]) then begin
      	OutString(tab[290],0,v["AZNCred"],false);
      end;
      if (tabprintf[300]) then begin
      	OutString(tab[300],0,v["EURCred"],false);
      end;
      if (tabprintf[310]) then begin
      	OutString(tab[310],0,v["USDCred"],false);
      end;
      if (tabprintf[320]) then begin
      	OutString(tab[320],0,v["AZN53Cred"],false);
      end;
      if (tabprintf[330]) then begin
      	OutString(tab[330],0,v["EUR53Cred"],false);
      end;
      if (tabprintf[340]) then begin
      	OutString(tab[340],0,v["USD53Cred"],false);
      end;
      if (tabprintf[341]) then begin
      	OutString(tab[341],0,v["EUR59/2Cred"],false);
      end;
      if (tabprintf[342]) then begin
      	OutString(tab[342],0,v["USD59/2Cred"],false);
      end;
      if (tabprintf[343]) then begin
      	OutString(tab[343],0,v["CHF59/2Cred"],false);
      end;
      if (tabprintf[350]) then begin
      	OutString(tab[350],0,v["BaseCred"],false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutMyString(tab[350]+25,0,v["BaseCred"]/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(0,1)
		StartFormat(15);
		EndFormat;
		
    //Оборот\Расход AZN ...
    tab[10] = 0;
		tab[20] = tab[10] + 15;   // Касса
		tab[30] = tab[20] + 10;   // Сумма в осн. вал./Курсовая
		tab[40] = tab[30] + 19;   // Сумма
		tab[50] = tab[40] + 25;   // Валюта
		tab[60] = tab[50] + 22;   // В USD по курсу: /divider end
		
    tab[70] = tab[60] + 7;   // propusk
		tab[80] = tab[70] + 15;   // Терминал
		tab[90] = tab[80] + 25;   // Сумма
		tab[100] = tab[90] +13;   // Расход AZN: В USD по курсу: 
    tab[110] = tab[100] + 11; // Валюта
		tab[120] = tab[110] + 9;  // В USD по курсу: 
    tab[130] = tab[120] + 8; // divider end
		
		tab[140] = tab[130] + 7; // propusk
		tab[150] = tab[140] + 15; // Банк
		tab[160] = tab[150] + 25; // Сумма
		tab[170] = tab[160] + 24; // Валюта
		tab[180] = tab[170] + 9;  // В USD по курсу: 
		tab[190] = tab[180] + 8; // divider end
    
    tab[200] = tab[190] + 7; // propusk
    tab[210] = tab[200] + 15; // Офис
		tab[220] = tab[210] + 25; // Сумма
		tab[230] = tab[220] + 24; // Валюта
		tab[240] = tab[230] + 9;  // В USD по курсу: 
		tab[250] = tab[240] + 8; // divider end
    
    tab[260] = tab[250] + 7; // propusk
    tab[270] = tab[260] + 15; // ID счет
		tab[280] = tab[270] + 25; // Сумма
		tab[290] = tab[280] + 24; // Валюта
		tab[300] = tab[290] + 9;  // В USD по курсу: 
		tab[310] = tab[300] + 8; // divider end
    
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"Оборот AZN:",false);
      OutString(tab[40],0,v["BaseDeb"],false);
      if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
				OutString(tab[50],0,"В USD по курсу: " & RepSpec.vals0,false);
				OutMyString(tab[60],0,v["BaseDeb"]/RepSpec.vals0,false);
			end else begin
				OutString(tab[50],0,"",false);
				OutString(tab[60],0,"",false);
			end;
      OutString(tab[70],0,"",false);
			OutString(tab[80],0,"Расход AZN:",false);
			OutString(tab[90],0,v["BaseCred"],false);
      if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
				OutString(tab[100],0,"В USD по курсу: " & RepSpec.vals0,false);
				OutMyString(tab[120],0,v["BaseCred"]/RepSpec.vals0,false);
			end;
		EndFormat;
		StartFormat(15);
		EndFormat;
		// Табл. 2,3
    Black_Divider(tab[20],tab[60]);
		Black_Divider(tab[80],tab[130]);
    Black_Divider(tab[150],tab[190]);
    if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
      Black_Divider(tab[210],tab[250]);
      Black_Divider(tab[270],tab[310]);
    end;
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"Касса",false);
			OutString(tab[40],0,"Сумма",false);
			OutString(tab[50],0,"Валюта",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[60],0,"В USD по курсу: " & RepSpec.vals0,false);
			end;
			OutString(tab[70],0,"",false);
			OutString(tab[80],0,"Банк локальный",false);
			OutString(tab[90],0,"Сумма",false);
			OutString(tab[110],0,"Валюта",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[120],0,"В USD по курсу: " & RepSpec.vals0,false);
			end;
      OutString(tab[140],0,"",false);
			OutString(tab[150],0,"Банк локальный валютный",false);
			OutString(tab[160],0,"Сумма",false);
			OutString(tab[170],0,"Валюта",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[180],0,"В USD по курсу: " & RepSpec.vals0,false);
			end;
      if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
        OutString(tab[200],0,"",false);
        OutString(tab[210],0,"Офис",false);
        OutString(tab[220],0,"Сумма",false);
        OutString(tab[230],0,"Валюта",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[240],0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
        
        
        OutString(tab[260],0,"",false);
        OutString(tab[270],0,"ID счет",false);
        OutString(tab[280],0,"Сумма",false);
        OutString(tab[290],0,"Валюта",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[300],0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
        
      end;
		EndFormat;
		Black_Divider(tab[20],tab[60]);
		Black_Divider(tab[80],tab[130]);
    Black_Divider(tab[150],tab[190]);
    if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
      Black_Divider(tab[210],tab[250]);
      Black_Divider(tab[270],tab[310]);
    end;
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"Приход",false);// Касса - Приход
			OutString(tab[40],0,v["BaseDeb"] - v["AZNTermDeb"] - v["Base52Deb"] - v["Base53Deb"],false);
			OutString(tab[50],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[60],0,(v["BaseDeb"] - v["AZNTermDeb"] - v["Base52Deb"])/RepSpec.vals0,false);
			end;
			OutString(tab[70],0,"",false);
			OutString(tab[80],0,"Приход",false);
			OutString(tab[90],0,v["AZNTermDeb"],false);
			OutString(tab[110],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[120],0,(v["AZNTermDeb"])/RepSpec.vals0,false);
			end;
      OutString(tab[140],0,"",false);
			OutString(tab[150],0,"Приход",false);
			OutString(tab[160],0,v["Base52Deb"],false);
			OutString(tab[170],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[180],0,(v["Base52Deb"])/RepSpec.vals0,false);
			end;
      if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
        OutString(tab[200],0,"",false);
        OutString(tab[210],0,"Приход",false);
        OutString(tab[220],0,v["Base53Deb"],false);
        OutString(tab[230],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[240],0,(v["Base53Deb"])/RepSpec.vals0,false);
        end;
        
        OutString(tab[260],0,"",false);
        OutString(tab[270],0,"Приход",false);
        OutString(tab[280],0,v["Base59/2Deb"],false);
        OutString(tab[290],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[300],0,(v["Base53Deb"])/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(tab[20],tab[60]);
		Gray_Divider(tab[80],tab[130]);
    Gray_Divider(tab[150],tab[190]);
    if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
      Gray_Divider(tab[210],tab[250]);
    end;
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"Расход",false);// Касса - Расход
			OutString(tab[40],0,v["BaseCred"] - v["AZNTermCred"] - v["Base52Cred"] - v["Base53Cred"] - v["Base59/2Cred"],false);
			OutString(tab[50],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[60],0,(v["BaseCred"] - v["AZNTermCred"] - v["Base52Cred"])/RepSpec.vals0,false);
			end;
			OutString(tab[70],0,"",false);
			OutString(tab[80],0,"Расход",false);
			OutString(tab[90],0,v["AZNTermCred"],false);
			OutString(tab[110],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[120],0,(v["AZNTermCred"])/RepSpec.vals0,false);
			end;
      OutString(tab[140],0,"",false);
			OutString(tab[150],0,"Расход",false);
			OutString(tab[160],0,v["Base52Cred"],false);
			OutString(tab[170],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[180],0,(v["Base52Cred"])/RepSpec.vals0,false);
			end;
      if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
        OutString(tab[200],0,"",false);
        OutString(tab[210],0,"Расход",false);
        OutString(tab[220],0,v["Base53Cred"],false);
        OutString(tab[230],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[240],0,(v["Base53Cred"])/RepSpec.vals0,false);
        end;
        
        OutString(tab[260],0,"",false);
        OutString(tab[270],0,"Расход",false);
        OutString(tab[280],0,v["Base59/2Cred"],false);
        OutString(tab[290],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[300],0,(v["Base59/2Cred"])/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(tab[20],tab[60]);
		Gray_Divider(tab[80],tab[130]);
    Gray_Divider(tab[150],tab[190]);
    if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
      Gray_Divider(tab[210],tab[250]);
      Gray_Divider(tab[270],tab[310]);
    end;
		v["SaldoEndPeriod51"] = v["BeginBalance51"] + v["AZNTermDeb"] - v["AZNTermCred"] + v["convtotal1"];// Edit ************************** Thursday, 27 August 1515 15:22:19
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"Конв/банк",false);
			OutString(tab[40],0,v["convtotal5"] - v["convtotal1"] - v["Base52Conv"] - v["Base53Conv"] - v["Base59/2Conv"],false);
			OutString(tab[50],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[60],0,(v["convtotal5"] - v["convtotal1"] - v["Base52Conv"] - v["Base53Conv"])/RepSpec.vals0,false);
			end;
			OutString(tab[70],0,"",false);
			OutString(tab[80],0,"Конв/банк",false);
			OutString(tab[90],0,v["convtotal1"],false);
			OutString(tab[110],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[120],0,(v["convtotal1"])/RepSpec.vals0,false);
			end;
      OutString(tab[140],0,"",false);
			OutString(tab[150],0,"Конв/банк",false);
			OutString(tab[160],0,v["Base52Conv"],false);
			OutString(tab[170],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[180],0,(v["Base52Conv"])/RepSpec.vals0,false);
			end;
      if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
        OutString(tab[200],0,"",false);
        OutString(tab[210],0,"Конв/банк",false);
        OutString(tab[220],0,v["Base53Conv"],false);
        OutString(tab[230],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[240],0,(v["Base53Conv"])/RepSpec.vals0,false);
        end;
        
        OutString(tab[260],0,"",false);
        OutString(tab[270],0,"Конв/банк",false);
        OutString(tab[280],0,v["Base59/2Conv"],false);
        OutString(tab[290],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[300],0,(v["Base59/2Conv"])/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(tab[20],tab[60]);
    Black_Divider(tab[80],tab[130]);
    Black_Divider(tab[150],tab[190]);
    if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
      Black_Divider(tab[210],tab[250]);
      Black_Divider(tab[270],tab[310]);
    end;
    StartFormat(15);
      OutString(tab[10],0,"",false);
      OutString(tab[20],0,"Сдано",false);
      OutString(tab[40],0,v["handed53"],false);
      OutString(tab[50],0,"AZN",false);
      if(RepSpec.vals0!=0)then begin
        OutMyString(tab[60],0,(v["handed53"])/RepSpec.vals0,false);
      end;
    	OutString(tab[70],0,"",false);
			OutString(tab[80],0,"Остаток",false);
			OutString(tab[90],0,v["SaldoEndPeriod51"]-v["SaldoEndPeriod51/2"],false);
			OutString(tab[110],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[120],0,(v["SaldoEndPeriod51"])/RepSpec.vals0,false);
			end;
      OutString(tab[140],0,"",false);
			OutString(tab[150],0,"К сдаче",false);
      v["SaldoEndPeriod52"] = v["BeginBalance52"] + v["Base52Deb"] - v["Base52Cred"] + v["Base52Conv"];
			OutString(tab[160],0,v["SaldoEndPeriod52"] - v["kursovaya52"],false);
			OutString(tab[170],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[180],0,(v["SaldoEndPeriod52"] - v["kursovaya52"])/RepSpec.vals0,false);
			end;
      if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
        OutString(tab[200],0,"",false);
        OutString(tab[210],0,"К сдаче",false);
        v["SaldoEndPeriod53"] = v["BeginBalance53"] + v["Base53Deb"] - v["Base53Cred"] + v["Base53Conv"];
        OutString(tab[220],0,v["SaldoEndPeriod53"] - v["kursovaya53"],false);
        OutString(tab[230],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[240],0,(v["SaldoEndPeriod53"] - v["kursovaya53"])/RepSpec.vals0,false);
        end;
        
        OutString(tab[260],0,"",false);
        OutString(tab[270],0,"К сдаче",false);
        v["SaldoEndPeriod59/2"] = v["BeginBalance59/2"] + v["Base59/2Deb"] - v["Base59/2Cred"] + v["Base59/2Conv"];
        OutString(tab[280],0,v["SaldoEndPeriod59/2"] - v["kursovaya59/2"],false);
        OutString(tab[290],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[300],0,(v["SaldoEndPeriod59/2"] - v["kursovaya59/2"])/RepSpec.vals0,false);
        end;
        
      end;
		EndFormat;
		Black_Divider(tab[80],tab[130]);
		if (!cretivef) or (v["BalItem1"] != 0) then begin
			Gray_Divider(tab[20],tab[60]);
			StartFormat(15);
        OutString(tab[10],0,"",false);
				if (prihodprntdf) then begin
          rashodprntdf = true;
          OutString(tab[20],0,"Расход за товар",false);
          OutString(tab[40],0,v["BalItem2"],false);
          OutString(tab[50],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[60],0,(v["BalItem2"])/RepSpec.vals0,false);
          end;
        end else begin
          OutString(tab[20],0,"Приход за товар",false);
          OutString(tab[40],0,v["BalItem1"],false);
          OutString(tab[50],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[60],0,(v["BalItem1"])/RepSpec.vals0,false);
          end;
        end;
		end else begin
      StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[20],0,"",false);
				OutString(tab[40],0,"",false);
				OutString(tab[50],0,"",false);
				if(RepSpec.vals0!=0)then begin
					OutString(tab[60],0,"",false);
				end;
    end;
      OutString(tab[70],0,"",false);
      OutString(tab[80],0,"Ост. 51/2",false);
      OutString(tab[90],0,v["SaldoEndPeriod51/2"],false);
      OutString(tab[110],0,"AZN",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[120],0,"",false);
      end;
      OutString(tab[140],0,"",false);
      OutString(tab[150],0,"Курсовая",false);
      OutString(tab[160],0,v["kursovaya52"],false);
      OutString(tab[170],0,"AZN",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[180],0,(v["kursovaya52"])/RepSpec.vals0,false);
      end;
      if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
        OutString(tab[200],0,"",false);
        OutString(tab[210],0,"Курсовая",false);
        OutString(tab[220],0,v["kursovaya53"],false);
        OutString(tab[230],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[240],0,(v["kursovaya53"])/RepSpec.vals0,false);
        end;
        
        OutString(tab[260],0,"",false);
        OutString(tab[270],0,"Курсовая",false);
        OutString(tab[280],0,v["kursovaya59/2"],false);
        OutString(tab[290],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[300],0,(v["kursovaya59/2"])/RepSpec.vals0,false);
        end;
      end;
    EndFormat;
    Black_Divider(tab[150],tab[190]);
    v["SaldoEndPeriod50n51"] = v["BeginBalance50n51"] + (v["BaseDeb"] - v["Base52Deb"] - v["Base53Deb"]) - (v["BaseCred"] - v["Base52Cred"] - v["Base53Cred"]) + (v["convtotal5"] - v["Base52Conv"] - v["Base53Conv"] + v["Base59/2Cred"] - v["Base59/2Conv"]);// Edit ************************** Thursday, 27 August 2015 15:22:15
		if (!cretivef) or (v["BalItem2"] != 0) then begin
			Gray_Divider(tab[20],tab[60]);
			StartFormat(15);
				OutString(tab[10],0,"",false);
        if (rashodprntdf) then begin
          ksdacheprntdf = true;
          OutString(tab[20],0,"К сдаче",false);
          OutString(tab[40],0,v["SaldoEndPeriod50n51"] - v["kursovaya"],false);
          OutString(tab[50],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[60],0,(v["SaldoEndPeriod50n51"] - v["kursovaya"])/RepSpec.vals0,false);
          end;
        end else begin
          OutString(tab[20],0,"Расход за товар",false);
          OutString(tab[40],0,v["BalItem2"],false);
          OutString(tab[50],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[60],0,(v["BalItem2"])/RepSpec.vals0,false);
          end;
        end;
    end else begin
      StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[20],0,"",false);
				OutString(tab[40],0,"",false);
				OutString(tab[50],0,"",false);
				if(RepSpec.vals0!=0)then begin
					OutString(tab[60],0,"",false);
				end;
		end;
      OutString(tab[70],0,"",false);
      OutString(tab[80],0,"",false);
      OutString(tab[90],0,"",false);
      OutString(tab[110],0,"",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[120],0,"",false);
      end;
      OutString(tab[140],0,"",false);
      OutString(tab[150],0,"К сдаче",false);
      OutString(tab[160],0,v["SaldoEndPeriod52"],false);
      OutString(tab[170],0,"AZN",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[180],0,(v["SaldoEndPeriod52"])/RepSpec.vals0,false);
      end;
      if ((RepSpec.sStartDate>=StringToDate("1/1/2018")) and (!cretivef)) then begin
        OutString(tab[200],0,"",false);
        OutString(tab[210],0,"К сдаче",false);
        OutString(tab[220],0,v["SaldoEndPeriod53"],false);
        OutString(tab[230],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[240],0,(v["SaldoEndPeriod53"])/RepSpec.vals0,false);
        end;
        
        OutString(tab[260],0,"",false);
        OutString(tab[270],0,"К сдаче",false);
        OutString(tab[280],0,v["SaldoEndPeriod59/2"],false);
        OutString(tab[290],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[300],0,(v["SaldoEndPeriod59/2"])/RepSpec.vals0,false);
        end;
      end;
    EndFormat;
		Black_Divider(tab[20],tab[60]);
    
	// к сдаче
		v["SaldoEndPeriod50USD"] = v["BeginBalance50USD"] + v["USDDeb"] - v["USDCred"] + v["convtotal4"];// Edit ************************** Thursday, 27 August 2015 15:22:15
		v["SaldoEndPeriod50EUR"] = v["BeginBalance50EUR"] + v["EURDeb"] - v["EURCred"] + v["convtotal3"];// Edit ************************** Thursday, 27 August 2015 15:22:16
		v["SaldoEndPeriod50AZN"] = v["BeginBalance50AZN"] + v["AZNDeb"] - v["AZNCred"] + v["convtotal2"];// Edit ************************** Thursday, 27 August 2015 15:22:17
		if (!cretivef) or (v["kursovaya"] != 0) then begin
			if (!ksdacheprntdf) then begin
        StartFormat(15);
          OutString(tab[10],0,"",false);
          OutString(tab[20],0,"К сдаче",false);
          OutString(tab[40],0,v["SaldoEndPeriod50n51"] - v["kursovaya"] - v["SaldoEndPeriod51"],false);
          OutString(tab[50],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[60],0,(v["SaldoEndPeriod50n51"] - v["kursovaya"] - v["SaldoEndPeriod51"])/RepSpec.vals0,false);
          end;
        EndFormat;
      end;
			StartFormat(15);
				OutString(tab[10],0,"",false);
				OutString(tab[20],0,"Курсовая",false);
				OutString(tab[40],0,v["kursovaya"],false);
				OutString(tab[50],0,"AZN",false);
				if(RepSpec.vals0!=0)then begin
					OutMyString(tab[60],0,(v["kursovaya"])/RepSpec.vals0,false);
				end;
			EndFormat;
			Black_Divider(tab[20],tab[60]);
		end;
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"К сдаче",false);
			OutString(tab[40],0,v["SaldoEndPeriod50n51"]-v["SaldoEndPeriod51"],false);
			OutString(tab[50],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[60],0,(v["SaldoEndPeriod50n51"] - v["SaldoEndPeriod51"])/RepSpec.vals0,false);
			end;
		EndFormat;
		StartFormat(15);
			OutString(tab[10],0,"",false);
			OutString(tab[20],0,"Коммиссия ID Group",false);
			OutString(tab[40],0,v["kommissia"],false);
			OutString(tab[50],0,"AZN",false);
		EndFormat;
		
		
		
		if (!cretivef) then begin
			if(RepSpec.sEndDate>=stringtodate("01/01/2018") or CompanyIsJWLikeCompany1(currentcompany))then begin
				for (i=0;i<curi;i=i+1) begin
					if left(CurList[i],3)=="USD" then begin
						FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
						v["SaldoEndPeriod53USD"] = v["SaldoEndPeriod53USD"] + tempBal;
					end;
				end;
				tempBal = 0;
				for (i=0;i<curi;i=i+1) begin
					if left(CurList[i],3)=="EUR" then begin
						FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
						v["SaldoEndPeriod53EUR"] = v["SaldoEndPeriod53EUR"] + tempBal;
					end;
				end;
				tempBal = 0;
				for (i=0;i<curi;i=i+1) begin
					if left(CurList[i],3)=="AZN" then begin
						FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
						v["SaldoEndPeriod53AZN"] = v["SaldoEndPeriod53AZN"] + tempBal;
					end;
				end;
				tempBal = 0;
				FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,"",0,"","",tempBal);
				v["SaldoEndPeriod53"] = tempBal;   
      end;
       tempBal = 0;
			FindNLAccBal("50",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,"",0,"","",tempBal);
      v["SaldoEndPeriod50"] = tempBal;   
      
      v["SaldoEndPeriod50n53USD"] = v["SaldoEndPeriod50USD"];
			v["SaldoEndPeriod50n53EUR"] = v["SaldoEndPeriod50EUR"];
			v["SaldoEndPeriod50n53AZN"] = v["SaldoEndPeriod50AZN"];
      if (jewlf or (njewlf and RepSpec.sStartDate>=StringToDate("1/1/2018"))) then begin
        v["SaldoEndPeriod50n53USD"] = v["SaldoEndPeriod50n53USD"] + v["SaldoEndPeriod53USD"];
        v["SaldoEndPeriod50n53EUR"] = v["SaldoEndPeriod50n53EUR"] + v["SaldoEndPeriod53EUR"];
        v["SaldoEndPeriod50n53AZN"] = v["SaldoEndPeriod50n53AZN"] + v["SaldoEndPeriod53AZN"];
      end;
      
			v["Balance52USD"] = 0;
			v["Balance52GBP"] = 0;
			v["Balance52CHF"] = 0;
      v["Balance52EUR"] = 0;
      v["Balance52AZN"] = 0;
      v["BeginBalance52USD"] = 0;
			v["BeginBalance52GBP"] = 0;
			v["BeginBalance52CHF"] = 0;
      v["BeginBalance52EUR"] = 0;
      v["BeginBalance52AZN"] = 0;
      
      v["Balance59/2USD"] = 0;
      v["Balance59/2EUR"] = 0;
      v["Balance59/2CHF"] = 0;
      
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="USD" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52USD"] = v["Balance52USD"] + tempBal;
          FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52USD"] = v["Balance52USD"] + tempBal;
        end;
      end;
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="GBP" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52GBP"] = v["Balance52GBP"] + tempBal;
          FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52GBP"] = v["Balance52GBP"] + tempBal;
        end;
      end;
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="CHF" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52CHF"] = v["Balance52CHF"] + tempBal;
          FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52CHF"] = v["Balance52CHF"] + tempBal;
        end;
      end;
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="EUR" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52EUR"] = v["Balance52EUR"] + tempBal;
          FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52EUR"] = v["Balance52EUR"] + tempBal;
        end;
      end;
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="AZN" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52AZN"] = v["Balance52AZN"] + tempBal;
          FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52AZN"] = v["Balance52AZN"] + tempBal;
        end;
      end;
      
      
      v["SaldoEndPeriod50n51"] = v["SaldoEndPeriod50n51"] + v["SaldoEndPeriod52"];
      
      //********************************** ENDBAL Balance59/2USD
      if(RepSpec.sStartDate>=StringToDate("1/1/2018"))then begin
				tempBal = 0;
				for (i=0;i<curi;i=i+1) begin
					if left(CurList[i],3)=="USD" then begin
						FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
						v["Balance59/2USD"] = v["Balance59/2USD"] + tempBal;
					end;
				end;
				tempBal = 0;
				for (i=0;i<curi;i=i+1) begin
					if left(CurList[i],3)=="EUR" then begin
						FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
						v["Balance59/2EUR"] = v["Balance59/2EUR"] + tempBal;
					end;
				end;
				tempBal = 0;
				for (i=0;i<curi;i=i+1) begin
					if left(CurList[i],3)=="CHF" then begin
						FindNLAccBal("59/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
						v["Balance59/2CHF"] = v["Balance59/2CHF"] + tempBal;
					end;
				end;
			end;
			
			//********************************** ENDBAL SaldoEndPeriod51USD
      
      tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="USD" then begin
					FindNLAccBal("51",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51USD"] = v["SaldoEndPeriod51USD"] + tempBal;
					FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51USD"] = v["SaldoEndPeriod51USD"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="EUR" then begin
					FindNLAccBal("51",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51EUR"] = v["SaldoEndPeriod51EUR"] + tempBal;
					FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51EUR"] = v["SaldoEndPeriod51EUR"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="AZN" then begin
					FindNLAccBal("51",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51AZN"] = v["SaldoEndPeriod51AZN"] + tempBal;
					FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51AZN"] = v["SaldoEndPeriod51AZN"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="CHF" then begin
					FindNLAccBal("51",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51CHF"] = v["SaldoEndPeriod51CHF"] + tempBal;
					FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51CHF"] = v["SaldoEndPeriod51CHF"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="GBP" then begin
					FindNLAccBal("51",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51GBP"] = v["SaldoEndPeriod51GBP"] + tempBal;
					FindNLAccBal("51/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod51GBP"] = v["SaldoEndPeriod51GBP"] + tempBal;
				end;
			end;
			//********************************** ENDBAL SaldoEndPeriod52USD
      
      For(k=0;k<CurncyCount;k=k+1) begin
      
      end;
      
      tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="USD" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52USD"] = v["SaldoEndPeriod52USD"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52USD"] = v["SaldoEndPeriod52USD"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="EUR" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52EUR"] = v["SaldoEndPeriod52EUR"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52EUR"] = v["SaldoEndPeriod52EUR"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="AZN" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52AZN"] = v["SaldoEndPeriod52AZN"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52AZN"] = v["SaldoEndPeriod52AZN"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="CHF" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52CHF"] = v["SaldoEndPeriod52CHF"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52CHF"] = v["SaldoEndPeriod52CHF"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="GBP" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52GBP"] = v["SaldoEndPeriod52GBP"] + tempBal;
					FindNLAccBal("52/2",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod52GBP"] = v["SaldoEndPeriod52GBP"] + tempBal;
				end;
			end;
			
			//tempBal = 0;
			//FindNLAccBal("50",RepSpec.ObjStr,"",0,"",addday(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
			//v["SaldoEndPeriod50"] = tempBal;

      
       
      
      //PrintFooterEndPeriodMainCurByCurncy(v,RepSpec,cretivef,tab)//Остаток по расчетному счету в валюте:
      
      
      PrintFooterEndPeriodByCurncy(v,RepSpec,cretivef,tab);//														К сдаче по валютам     
      StartFormat(15);
				OutString(0,0,"Остаток на " & RepSpec.sEndDate & " по счетам:",false);
			EndFormat;
      PrintFooterEndPeriodKassa50(v,RepSpec,cretivef,tab);
      PrintFooterEndPeriodBank5152(v,RepSpec,cretivef,tab);
      if(RepSpec.sStartDate>=StringToDate("1/1/2018"))then begin
				PrintFooterEndPeriodEndOnIDAcc(v,RepSpec,cretivef,tab);//ID счет:
      end;
      if (jewlf or (njewlf and RepSpec.sStartDate>=StringToDate("1/1/2018"))) then begin
      	PrintFooterEndPeriodMoneyInOffice(v,RepSpec,cretivef,tab);//										Деньги в офисе
      end;
      PrintFooterEndPeriodEndMainAcc(v,RepSpec,cretivef,tab,jewlf,njewlf);//Остаток общего счета
      
      
      
      
      
      
		end;
	EndJob;
	
	LogProcTime("DirectorWeekRn",getcurtick() - curtick);
	return;
end;
    